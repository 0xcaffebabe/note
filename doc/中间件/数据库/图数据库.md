
# 图数据库

## 数据建模

- 节点：一般就是领域中的名词，RDBMS 中的实体
- 标签：代表节点或边的通用名词，也可以叫做类型
- 边：也叫做关系，节点之间的连接，边是有方向的
- 属性：节点或关系附带的信息

### 1.实体转节点

从设计的概念模型中找到所需的实体，后将实体转为节点，并为节点指定通用的标签，通用的标签使得关于相同的项的节点能分为一组，简化模型

### 2.关系转边

从设计的概念模型中找出实体之间的关系，并将关系转为边，并为边指定通用的标签，通用的标签使得关于相同的项的边能分为一组，简化模型

### 3.分配属性

在概念模型中，实体与关系自然而然地会拥有许多属性，因此，这些属性可以放入到节点或边中

### 4.反范式化

为了优化性能，可以采取一些反范式的设计，如利用预计算或添加重复的数据，来优化遍历时的性能


## 图的遍历

对于图，需要通过遍历，才能进行查询或者处理

通过指定一个初始点，再通过一系列的筛选

```java
g.V().
  has ('person','first_name','Ted'). // 标签为 person，有 first_name 属性为 Ted 的节点
  out ('friends'). // 有 friends 标签的出边的节点
  values('first_name') // 取出 first_name 属性
```

对于未知的结构，通过递归遍历来描述：

```java
g.V().has('person','first_name','Ted').
  repeat
    out()
  )until(has('person','first_name','Dave')). // 重复直到连接的节点有 Dave
  values(first_name')
```

添加节点或者边，也能遍历来描述

```java
josh = g.addV('person').property('first_name', 'Josh').next()
ted = g.addV('person').property('first_name', 'Ted').next()
hank = g.addV('person').property('first_name', 'Hank').next()

g.addE('friends').from(dave).to(ted)
```

遍历可以得到路径

```java
g.V().has('person', 'first_name', 'Ted').
  until(has('person', 'first_name', 'Denise')).
  repeat(
    both('friends').simplePath()
  ).path()
```
