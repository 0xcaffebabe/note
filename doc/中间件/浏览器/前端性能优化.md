---
tags: ['前端性能', '性能优化', '浏览器', '用户体验', '性能工程']
---

# 前端性能工程

## 一、前端性能的第一性原理

### 1. 性能的本质

**前端性能的本质是：**

> 在有限计算与网络资源下，最大化单位时间内用户的有效感知反馈。

性能不是“跑分”，而是**人类感知 × 系统调度 × 架构决策**的综合结果。

---

### 2. 三条不变的性能基本定律（稳定知识）

#### 2.1 主线程稀缺性定律

* 浏览器主线程同时承担：

  * JavaScript 执行
  * 样式计算
  * 布局
  * 绘制
* **一切卡顿，本质都是主线程被长期占用**

#### 2.2 人类感知阈值定律

| 时间尺度    | 用户感知 |
| ------- | ---- |
| ≤ 50ms  | 即时响应 |
| ≤ 100ms | 流畅   |
| ≤ 1s    | 可接受  |
| > 1s    | 明显延迟 |

性能优化的目标不是“无限快”，而是**跨越关键感知阈值**。

#### 2.3 延迟不可消除定律

* 延迟无法消失
* 只能在以下环节转移：

  * 网络
  * 计算
  * 渲染
  * 用户等待

架构的核心作用，就是**重新分配延迟的位置**。

---

## 二、统一的用户体验模型（RAIL 的原理化解读）

RAIL 不是指标集合，而是**人机交互节奏模型**。

| 阶段        | 本质目标     | 系统约束         |
| --------- | -------- | ------------ |
| Response  | 保持因果即时性  | 主线程占用 ≤ 50ms |
| Animation | 保持视觉连续性  | 帧预算 ≤ 16.6ms |
| Idle      | 预留不确定性   | 提高调度弹性       |
| Load      | 建立可用心智模型 | 首屏与可交互       |

---

## 三、浏览器性能因果链路模型（核心认知模型）

### 3.1 从用户到屏幕的完整链路

```
用户输入
↓
事件入队
↓
JavaScript 执行（可能产生长任务）
↓
样式计算
↓
布局（Reflow）
↓
绘制（Paint）
↓
合成（Composite）
↓
屏幕刷新
```

**任何性能问题，必然可以定位到这条链路的某一段。**

---

### 3.2 关键性能问题的归因方式

| 现象   | 本质原因     |
| ---- | -------- |
| 输入延迟 | 主线程被占用   |
| 掉帧   | 单帧预算被打破  |
| 白屏   | 首次可绘制被推迟 |
| 页面抖动 | 布局不稳定    |

---

## 四、性能指标体系（从指标到含义）

### 4.1 指标不是目的，而是观测窗口

| 指标        | 反映的系统问题  |
| --------- | -------- |
| TTFB      | 网络与服务端延迟 |
| FCP / FP  | 首次视觉反馈   |
| LCP       | 核心内容呈现   |
| CLS       | 布局稳定性    |
| TTI       | 可交互能力    |
| Long Task | 主线程阻塞    |

---

### 4.2 性能指标的层级归属

* 网络层：DNS、TCP、SSL、TTFB
* 执行层：Long Task、JS 执行时间
* 渲染层：FCP、LCP、CLS
* 交互层：TTI、FID

---

## 五、性能测量与可观测性体系

### 5.1 性能工程的三种视角

| 视角     | 目的     |
| ------ | ------ |
| 实验室    | 精确定位问题 |
| 线上真实用户 | 体验真实性  |
| 长期趋势   | 架构治理   |

---

### 5.2 浏览器原生可观测能力（机制层）

* Performance Timing API
* Performance Observer
* Long Task API
* Network Information API
* Page Visibility
* Intersection Observer

**原则：**

> 用事件驱动 + 被动观测，替代主动轮询。

---

## 六、主线程调度与长任务治理

### 6.1 长任务的本质

> 单次占用主线程超过 50ms 的 JavaScript 执行。

### 6.2 调度策略（稳定思想）

| 策略    | 本质作用    |
| ----- | ------- |
| 拆分任务  | 缩短连续占用  |
| 延迟执行  | 推迟非关键计算 |
| 优先级调度 | 保证交互优先  |
| 空闲执行  | 利用不确定时间 |

---

## 七、资源加载与网络性能的系统视角

### 7.1 网络优化的本质

> 减少 RTT × 减少关键资源体积 × 提前关键资源可达性

### 7.2 稳定的资源加载原则

* 关键资源优先
* 非关键资源延后
* 可缓存资源最大化复用

---

## 八、渲染性能的结构性认知

### 8.1 重排与重绘的本质区别

| 阶段 | 成本      |
| -- | ------- |
| 重排 | 高（几何计算） |
| 重绘 | 中（像素填充） |
| 合成 | 低（图层操作） |

**优化方向：从重排 → 重绘 → 合成迁移。**

---

## 九、架构方案如何改变性能瓶颈分布

| 架构方案      | 转移的瓶颈   | 性能收益来源 | 代价    |
| --------- | ------- | ------ | ----- |
| CSR / SPA | 网络 → 执行 | 状态复用   | 首屏慢   |
| SSR       | 执行 → 网络 | 首屏渲染   | 服务端压力 |
| 同构        | 综合平衡    | TTI 优化 | 架构复杂  |
| PWA       | 网络      | 离线能力   | 维护成本  |

---

## 十、终端差异的统一抽象

### 10.1 桌面与移动的本质差异

| 维度  | 桌面 | 移动 |
| --- | -- | -- |
| 网络  | 稳定 | 波动 |
| CPU | 强  | 弱  |
| 输入  | 精确 | 高频 |

**策略不是复制，而是权重调整。**

---

## 十一、从优化到治理：性能工程化

### 11.1 性能工程四阶段

1. 指标定义
2. 持续监控
3. 问题归因
4. 架构演进

### 11.2 组织协作视角

* 产品：体验目标
* 前端：交互与执行
* 后端：数据与延迟
* 运维：网络与稳定性

## 关联内容（自动生成）

- [/软件工程/性能工程/性能优化.md](/软件工程/性能工程/性能优化.md) 性能优化方法论与前端性能优化在系统性优化策略、性能测量与治理体系方面密切相关
- [/计算机系统/程序结构和执行/优化程序性能.md](/计算机系统/程序结构和执行/优化程序性能.md) 程序性能优化原理与前端性能优化在性能优化的底层模型、性能分析方法等方面相互补充
- [/中间件/浏览器/V8.md](/中间件/浏览器/V8.md) V8引擎的执行模型与性能优化机制直接影响前端JavaScript代码的执行效率
- [/软件工程/架构/Web前端/用户体验设计.md](/软件工程/架构/Web前端/用户体验设计.md) 用户体验设计与前端性能优化共同关注用户感知和交互体验，性能是实现良好用户体验的基础
- [/编程语言/JavaScript/React.md](/编程语言/JavaScript/React.md) React框架中的性能优化策略，如shouldComponentUpdate和虚拟DOM，是前端性能优化的具体实践
- [/软件工程/架构/Web前端/前端工程化.md](/软件工程/架构/Web前端/前端工程化.md) 前端工程化与性能优化是现代前端开发中相辅相成的两个重要方面
- [/软件工程/架构/Web前端/Web前端.md](/软件工程/架构/Web前端/Web前端.md) Web前端技术体系与前端性能优化在浏览器执行环境、渲染体系、网络协议等方面直接相关
- [/软件工程/架构/系统设计/缓存.md](/软件工程/架构/系统设计/缓存.md) 缓存策略是前端性能优化的重要手段，浏览器缓存机制与性能优化密切相关
- [/软件工程/架构/系统设计/前端监控.md](/软件工程/架构/系统设计/前端监控.md) 前端监控与性能优化共同构成前端可观测性体系，关注用户端体验和性能指标
- [/计算机网络/应用层.md](/计算机网络/应用层.md) 应用层协议（特别是HTTP）的优化是前端性能优化的重要组成部分
- [/操作系统/linux/Linux性能优化.md](/操作系统/linux/Linux性能优化.md) 系统层面的性能优化与前端性能优化在性能分析方法和优化思想上相通
- [/编程语言/JAVA/JVM/自动内存管理/调优.md](/编程语言/JAVA/JVM/自动内存管理/调优.md) JVM性能优化与前端性能优化在性能分析、优化策略等方面有共通之处
- [/软件工程/架构/系统设计/高并发.md](/软件工程/架构/系统设计/高并发.md) 高并发系统设计与前端性能优化都关注系统性能和用户体验
- [/软件工程/架构/系统设计/可观测性.md](/软件工程/架构/系统设计/可观测性.md) 可观测性体系与前端性能优化在性能监控、指标度量等方面相互关联
