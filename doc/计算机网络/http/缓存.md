# 缓存

实现方法：

- 代理服务器缓存
- 客户端缓存

## Cache-Control

- 禁止进行缓存

```html
Cache-Control: no-store
```

- 强制确认缓存

只有当缓存资源有效时，才能使用这个响应

```html
Cache-Control: no-cache
```

- 禁止修改

```http
Cache-Control: no-transform
```

禁止代理服务器修改HTTP响应头或者响应体

- 私有缓存

只能单独给用户使用，一般用在浏览器

```html
Cache-Control: private
```

- 公共缓存

可以被多个用户使用，一般存储在代理服务器中

```html
Cache-Control: public
```

- min-fresh和only-if-cached

仅用于客户端的请求Header。min-fresh后续跟随一个以秒为单位的数字，用于建议服务器能返回一个不少于该时间的缓存资源 only-if-cached表示要求客户端要求不发送网络请求，只使用缓存来进行响应

- must-revalidate和proxy-revalidate

must-revalidate表示在资源过期后，一定需要从服务器中进行获取 proxy-revalidate用于提示代理、CDN等设备资源过期后的缓存行为

- 缓存过期

出现在响应报文，超过这个时间 缓存就被认为过期

```html
Cache-Control: max-age=31536000
```

Expires 首部字段也可以用于告知缓存服务器该资源什么时候会过期

```html
Expires: Wed, 04 Jul 2012 08:26:05 GMT
```

但Expires有如下问题：

1. 受限于客户端的时间
2. 无法缓存客户私有资源
3. 无法描述“不缓存”，如js文件引用后面要加个版本号

## 缓存验证

ETag 是资源的唯一标识

```http
If-None-Match: "82e22293907ce725faf67773957acd12"
```

如果服务器接收到ETage后，判断资源没有发生改变，会返回一个304

Last-Modified 首部字段也可以用于缓存验证，如果响应首部字段里含有这个信息，客户端可以在后续的请求中带上 If-Modified-Since 来验证缓存。服务器只在所请求的资源在给定的日期时间之后对内容进行过修改的情况下才会将资源返回，状态码为 200 OK。如果请求的资源从那时起未经修改，那么返回一个不带有实体主体的 304 Not Modified 响应报文
