---
tags: ['计算机网络']
books: [
  {name: '计算机网络:自顶向下方法'}
]
---

# 密码学

密码学最基础的分支：

- 单向散列函数
- 对称密码技术
- 非对称密码技术

现代密码学加密数据的安全性依赖于加密算法的质量和密钥的保密性，只有加密算法是公开的，安全性才能经受得住考验

密码学能做什么？
  - 机密性：如何使得某个数据自己能看懂，别人看不懂
  - 认证：如何确保数据的正确来源，如何保证通信实体的真实性
  - 完整性：如何确保数据在传输过程中没有被删改
  - 不可否认性：如何确保用户行为的不可否认性

## 基本概念

- 明文 ——要处理的数据
- 密文 ——处理后的数据
- 密钥 ——秘密参数
- 加密函数
- 解密函数

## 密码算法分类

- 根据用途
  - 加密算法
  - 杂凑函数
  - 数字签名
- 根据密钥 密码系统的安全性应该依赖于密钥的复杂性，而非算法的保密性
  - 对称
  - 非对称

## 密码分析学

### 密码体制的攻击

- 唯密文攻击：通过统计分析针对部分密文进行分析
- 已知明文攻击：已知密文与明文的匹配关系得到已知密文与未知明文的匹配关系
- 选择明文攻击：对于静态的加密方案 如果能让对方发送一串固定的数据，可以破解这个映射关系，在二战中就有一些情况故意散播虚假消息从而破解密码 但在现代的的加密方案，这行不通

无条件安全与计算安全

### 安全强度

加密算法的安全强度通常使用“位”（字节位）来表述，N 位的安全强度表示破解一个算法需要 2^N(2 的 N 次方) 次的运算

随着安全分析的进步，几乎所有密码学算法的安全强度都会衰减

安全强度（位）|NIST建议|BSI建议|ECRYPT-CSA建议
-|-|-|-
80|仅遗留系统可以使用，不建议用于新系统|不推荐|仅遗留系统可以使用，不建议用于新系统
112|仅可用于2030年之前|不推荐|不推荐
128|可以用于2030年之后|可以用于2020年之后|可以用于2028年之前
256|可以用于2030年之后|可以用于2020年之后|可以用于2068年之前

### 算法性能

使用的度量单位是每字节周期数（CPB，Cycles Per Byte），表示的是处理一个字节处理需要执行的微处理器的时钟周期数

每字节花费的时钟周期数越小，表示这个算法运算得越快，性能越好

影响计算性能的因素：

- 算法实现的内存使用影响
- 算法实现有没有使用优化的步骤，比如并行计算或者预运算
- 算法实现有没有使用硬件加速，比如使用 CPU 关于算法的扩展指令

## 对称加密

### 流密码

明文消息按字符或比特逐位加密，主要是基于硬件实现

每次加密都通过密钥生成一个密钥流，解密也是使用同一个密钥流，明文与同样长度的密钥流进行异或运算得到密文，密文与同样的密钥流进行异或运算得到明文

流密码的安全性主要取决于密钥序列的推导算法，而不用考虑数据分组带来的种种陷阱

- 密钥流产生器

参数为k的有限状态自动机

**二元序列的伪随机性**

#### 反馈移位寄存器

![批注 2020-06-05 102940](/assets/批注%202020-06-05%20102940.png)

#### 非线性序列

#### A5流密码算法

用于蜂窝式移动电话系统语音和数字加密

#### 流加密攻击

有些加密算法是将流中的每个字节逐个进行异或

这导致只需要知道两个加密后的密文，便解密密文

### 分组密码

发件人和收件人使用其共同拥有的单个密钥 ,这种密钥既用于加密，也用于解密

常见的对称加密算法：DES、3DES、DESX、Blowfish、IDEA、RC4、RC5、RC6和AES

- 混淆原则
  - 敌手即使获得了密文和明文，也无法求出密钥的任何信息；即使获得了密文和明文的统计规律，也无法求出明文的新的信息
- 扩散原则
  - 明文中的每一位影响密文中的尽可能多的位

**优点**

只需记忆一个密钥，就可用于加密、解密； 与非对称加密方法相比，加密解密的计算量小，速度快，简单易用，适合于对海量数据进行加密处理

**缺点**

如果密钥交换不安全，密钥的安全性就会丧失

分组加密算法改变分组密文的顺序，也将改变解密后的明文顺序，这很有可能将导致数据传输过程中关键数据被伪造

#### SP网络

- 代换

![批注 2020-06-06 103221](/assets/批注%202020-06-06%20103221.png)

#### Feistel密码

乘积密码指顺序地执行两个或多个基本密码系统，使得最后结果的密码强度高于每个基本密码系统产生的结果

#### DES

- 分组长度为64 bits (8 bytes)
- 密文分组长度也是64 bits。
- 密钥长度为64 bits，有8 bits奇偶校验，有效密钥长度为56 bits。

**安全性**

DES的密钥长度可能会对安全性产生威胁

- 3DES
  - 多重DES就是使用多个密钥利用DES对明文进行多次加密。使用多重DES可以增加密钥量，从而大大提高抵抗穷举密钥搜索攻击的能力

#### 工作模式

根据不同的数据格式和安全性要求, 以一个具体的分组密码算法为基础构造一个分组密码系统的方法

#### AES

- 明文分组可变，128、192、256比特
- 密钥长度可变，各自可独立指定为128、192、256比特。

#### SM4

是一个分组密码算法，分组长度和密钥长度均为128比特。加密算法与密钥扩展算法都采用32轮非线性迭代结构

## 公钥密码

密钥依据性质划分，将其中的一个向外界公开，称为公钥；另一个则自己保留，称为私钥。公钥(Public key)常用于数据加密（用对方公钥加密）或签名验证（用对方公钥解密），私钥(Private key)常用于数据解密（发送方用接收方公钥加密）或数字签名（用自己私钥加密）

**优点**

难破解

**缺点**

加密速度慢

### RSA

- 密钥生成

选择两个大素数P，q。(例如:每个1024位)

计算n= Pq:，z=(p-1)(q- 1)。

随机选取e (其中e< n)，e与z没有公因数。(e,z互为质数”)

选取d.使得ed- 1能够被z完全整除。(换言之:ed mod z= 1)

- 加解密

![批注 2020-06-10 095616](/assets/批注%202020-06-10%20095616.png)

#### PGP

这种也是基于非对称加密，但与SSL不同的时，私钥与公钥需要你自己以可信的方式保管与传输

### ElGamal

![批注 2020-06-11 083326](/assets/批注%202020-06-11%20083326.png)

### 椭圆曲线密码

### 背包算法
### Rabin
#### D-H

## 哈希函数

将任意长的消息M映射为较短的、固定长度的一个值H(M)

### 单向散列函数

- 正向计算容易，逆向运算困难
- 运算结果均匀分布，构造碰撞困难
- 对于相同的单向散列函数， 给定数据的散列值是确定的，长度是固定的

雪崩效应（Avalanche Effect）是密码学算法一个常见的特点，指的是输入数据的微小变换，就会导致输出数据的巨大变化，这是单向散列函数所需要具备的。严格雪崩效应指的是如果输入数据的一位反转，输出数据的每一位都有 50% 的概率会发生变化

![单向散列函数处理过程](/assets/2023329104458.webp)

### 安全条件

- 单向性
- 抗弱碰撞性
- 抗强碰撞性

### 生日攻击

随机取一个值，该值的hash值与某个特定x的hash值相同的概率为50时，应该要取多少个值

### 长度延展攻击

假设有两段数据，S 和 M，以及一个单向散列函数 h。如果我们要把这两段数据合并起来，并且还要计算合并后的散列值，h(S|M)，这就叫做单向散列函数的长度延展

由于压缩函数是接收一个数据分组和上一个压缩函数的运算结果再得到新的结果，那么知道了上一个压缩函数的运算结果，就能够计算下一个分组数据的压缩函数运算结果

这个攻击把原来的散列值作为压缩函数的一个输入，我们再按照数据补齐规范，去补齐原来数据到数据分组的整数倍，然后加入新的数据（M），就可以计算原数据和扩展数据的散列值，这样即使不知道 S，也能利用 S 计算出 S+M的散列值

![长度延展攻击](/assets/2023329112924.webp)

只要使用了类似压缩函数和链接模式，都有长度延展攻击的风险

### SHA-1

- 算法的输入：小于264比特长的任意消息，分为512比特长的分组。
- 算法的输出：160比特长的消息摘要。

### SHA-256

- <https://blog.csdn.net/u011583927/article/details/80905740/>

## 数字签名

- 接收者能够核实发送者对文档的签名；
- 发送者事后不能否认对文档的签名；
- 不能伪造对文档的签名

### RSA签名

使用私钥签名，公钥进行验证

### ElGamal签名

### DSS签名

## 密钥协议

### Diffie-Hellman密钥交换协议

![批注 2020-06-17 090149](/assets/批注%202020-06-17%20090149.png)

### Shamir秘密共享

## 国密算法

- 国密SM1 算法保密 想要使用需要通过特定的安全设备
- 国密SM2 算法公开 基于椭圆曲线问题设计的，属于国家标准，算法公开，加密强度和国际标准的 ECC 相当
- 国密SM4 算法公开 对称加密
