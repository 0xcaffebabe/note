import{d as y,c as v,r as S,o as h,a as mn,b as fn,e as gn,f as wn,g as W,w as d,h as i,i as p,j as ae,k as O,l as g,F as D,m as I,n as _,t as C,v as ce,p as yn,u as T,q as de,s as _n,x as we,y as ee,K as le,T as Ht,z as at,A as kn}from"./vue-BlfM6YYb.js";import{E as jt,a as Vt,b as be,v as $n,c as vn,d as it,e as lt,f as ct,g as J,s as bn,m as Cn,h as Nt,i as Kt,j as z,k as x,l as Sn,r as Qt,n as Dn,o as Ln,p as Ie,q as Wt,t as ue,u as Z,w as St,x as Dt,y as Jt,z as dt,A as Fe,B as Oe,C as Mn,D as ut,F as In,G as Gt,H as xt,I as Yt,J as Xt,K as Zt,L as et,M as tt,N as Tn,O as En,P as eo,Q as to,R as ot,S as Pn,T as An,U as Ce,V as oo,W as no,X as so,Y as ro,Z as ht,_ as ao,$ as Fn,a0 as pt,a1 as On,a2 as mt,a3 as zn,a4 as Un,a5 as ft,a6 as Rn,a7 as qn,a8 as Bn,a9 as Hn,aa as io,ab as jn,ac as Vn,ad as Nn,ae as Kn,af as Qn,ag as Wn,ah as Jn,ai as Gn,aj as lo,ak as co,al as xn,am as uo,an as Yn,ao as Xn}from"./element-plus-iMq-xSli.js";import{a as A,p as Ke,j as Lt,N as $e,b as Zn,c as Mt,d as Qe,e as es,s as ts,V as os}from"./vendor-DzgCQJ0o.js";import{i as te,u as oe,a as gt,b as ns,c as ne,d as Se,e as ss,f as he,g as ze,h as rs,j as ho,k as po,l as as,m as mo,n as is,o as ls,p as cs,q as ds,r as us,s as hs,t as ps,v as ms,w as fs}from"./echarts-_aouptK0.js";import gs from"./katex-DKDShgR9.js";import{k as Me}from"./marked-4Gk_dWmY.js";import{m as Ue}from"./mermaid-Cu-VcSk7.js";import"./index-Cy9nu8go.js";import"./zrender-BuvQi3pX.js";import"./cytoscape-BfObkms8.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function o(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=o(s);fetch(s.href,a)}})();const ws="modulepreload",ys=function(e){return"/"+e},It={},X=function(t,o,n){let s=Promise.resolve();if(o&&o.length>0){let c=function(u){return Promise.all(u.map(m=>Promise.resolve(m).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),l=r?.nonce||r?.getAttribute("nonce");s=c(o.map(u=>{if(u=ys(u),u in It)return;It[u]=!0;const m=u.endsWith(".css"),f=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const w=document.createElement("link");if(w.rel=m?"stylesheet":ws,m||(w.as="script"),w.crossOrigin="",w.href=u,l&&w.setAttribute("nonce",l),document.head.appendChild(w),m)return new Promise((L,$)=>{w.addEventListener("load",L),w.addEventListener("error",()=>$(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(r){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=r,window.dispatchEvent(l),!l.defaultPrevented)throw r}return s.then(r=>{for(const l of r||[])l.status==="rejected"&&a(l.reason);return t().catch(a)})};var hd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function pd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function _s(){Ue.initialize({theme:"dark",startOnLoad:!1})}function ks(){Ue.initialize({theme:"default",startOnLoad:!1})}function $s(){document.querySelectorAll("[id^=mermaid-]").forEach(t=>{Ue.render(t.id+"-svg",t.textContent).then(o=>{t.innerHTML=o.svg})})}const nt={initWithDark:_s,initWithNormal:ks,initAllNode:$s},G={siteName:"知识体系",repositoryUrl:"https://github.com/0xcaffebabe/note",localUrl:"D:/learning/note/doc",linkList:[{title:"Github",url:"https://github.com/0xcaffebabe"},{title:"博客",url:"https://www.ismy.wang/"}]};let We;var N;(e=>{function t(){if(typeof We<"u")return We;let r=!1;return function(l){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(l)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(l.substr(0,4)))&&(r=!0)}(navigator.userAgent||navigator.vendor),We=r||window.innerWidth<=820,r}e.isMobile=t;function o(r){document.title=`${r} - ${G.siteName}`}e.setDocTitle=o;function n(){document.title=`${G.siteName}`}e.resetDocTitle=n;function s(r){r.$store.commit("setIsDarkMode",!0),document.body.setAttribute("theme","dark"),document.documentElement.classList.add("dark"),localStorage.setItem("system::theme","dark"),nt.initWithDark()}e.enterDarkMode=s;function a(r){r.$store.commit("setIsDarkMode",!1),document.body.setAttribute("theme","light"),document.documentElement.classList.remove("dark"),localStorage.setItem("system::theme","light"),nt.initWithNormal()}e.enterLightMode=a})(N||(N={}));function vs(){return N.isMobile()&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches}const bs=y({setup(){},created(){(localStorage.getItem("system::theme")=="dark"||vs())&&N.enterDarkMode(this),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",t=>{t.matches?N.enterDarkMode(this):N.enterLightMode(this)})}}),b=(e,t)=>{const o=e.__vccOpts||e;for(const[n,s]of t)o[n]=s;return o};function Cs(e,t,o,n,s,a){const r=S("router-view");return h(),v(r)}const Ss=b(bs,[["render",Cs]]);class De{static instance=new De;cacheMap=new Map;constructor(){}static getInstance(){return this.instance}set(t,o,n){this.ensureScopreCacheExists(t,o),this.cacheMap.get(t).set(o,n)}get(t,o){return this.ensureScopreCacheExists(t,o),this.cacheMap.get(t).get(o)}clear(){this.cacheMap.clear()}has(t,o){return this.ensureScopreCacheExists(t,o),this.cacheMap.get(t).has(o)}ensureScopreCacheExists(t,o){this.cacheMap.has(t)||this.cacheMap.set(t,new Map)}}const Je=De.getInstance();function ye(){return function(e,t,o){let n=o.value;const s=e.name()+"-"+t;return o.value=function(){const a=JSON.stringify(arguments);if(Je.has(s,a))return Je.get(s,a);const r=n.apply(this,arguments);return r instanceof Promise?r.then(l=>(Je.set(s,a,l),l)):r},o}}function st(e){return e?(e.startsWith("./doc")&&(e=e.replace("./doc","")),e.startsWith("/doc")&&(e=e.replace("/doc","")),e=decodeURI(e).replace(/-/g,"@@"),e.startsWith("./")||e.startsWith("/")||e.startsWith("doc")?e.split("/").splice(1).join("-").replace(".md","").split("#")[0]:e.split("/").join("-").replace(".md","").split("#")[0]):""}function Ds(e){if(e.indexOf("#")==-1)return{id:st(e)};const t=e.split("#")[1];return{id:st(e.split("#")[0]),headingId:t}}function Ls(e){return e?(e=e.split("?")[0],e.split("-").join("/").replace(/@@/g,"-")+".md"):""}const E={docId2Url:Ls,docUrl2Id:st,resloveDocUrl:Ds},Tt=[{id:"local",url:"/",desc:"与本文档同源"}];class ge{static listDatasourceList(){return Tt}static getCurrentDatasource(){const t=localStorage.getItem("datasource-servier::current"),o={id:"local",url:"/",desc:"与本文档同源"};if(!t)return o;const n=ge.listDatasourceList().filter(s=>s.id==t);return n?n[0]:o}static setCurrentDatasource(t){localStorage.setItem("datasource-servier::current",t.id)}static getDatasourceById(t){const o=ge.listDatasourceList().filter(n=>n.id==t);if(!o)throw new Error("指定ID的数据源不存在");return o[0]}static getDatasourcesByMatch(t){return Tt.filter(t)}static async testDelay(t){const o=new Date().getTime(),n=(await A.get(ge.getDatasourceById(t).url+"info.json")).data;return[new Date().getTime()-o,n.generateTime]}}function Ms(...e){if(e.length<=1)return e.join("");let t=e[0];for(let o=1;o<e.length;o++){const n=e[o];t.endsWith("/")&&n.startsWith("/")?t+=n.substring(1):!t.endsWith("/")&&!n.startsWith("/")?t+="/"+n:t+=n}return t}const H={concatUrl:Ms},j={statisticInfoUrl:"/info.json",yearCommitHeatmapUrl:"/commitHeatmap.json",hourCommitHeatmap:"/hourCommitHeatmap.json",potentialKnowledgeNetwork:"/potentialKnowledgeNetwork.json",category:"/category.json",descCommitTimeDocList:"/descCommitTimeDocList.json",knowledgeNetworkJson:"/knowledgeNetwork.json",commitTotalTrend:"/commitTotalTrend.json",summaryJson:"/SUMMARY.md.json",tagMappingJson:"/tagMapping.json",wordcloudJson:"/wordcloud.json",docClusterJson:"/docCluster.json",docTagPrediction:"/docTagPrediction.json",docQualityJson:"/docQuality.json",knowledgeRichnessJson:"/knowledgeRichness.json"};var Is=Object.defineProperty,Ts=Object.getOwnPropertyDescriptor,q=(e,t,o,n)=>{for(var s=Ts(t,o),a=e.length-1,r;a>=0;a--)(r=e[a])&&(s=r(t,o,s)||s);return s&&Is(t,o,s),s};const R=()=>ge.getCurrentDatasource().url,B=ye(),U=class fo{static instance;name(){return"api"}constructor(){}async getDocFileInfo(t){if(!t)throw Error("doc id不得为空");t=R()+E.docId2Url(t)+".json";const o=await A.get(t);if(!o.data)throw Error("无法获取文档 "+t);return o.data}async getCategory(){return(await A.get(H.concatUrl(R(),j.summaryJson))).data}async getCompiledCategory(){return(await A.get(H.concatUrl(R(),j.category))).data}async getWordCloud(){return(await A.get(H.concatUrl(R(),j.wordcloudJson))).data}async getDocCluster(){return(await A.get(H.concatUrl(R(),j.docClusterJson))).data}async getKnowledgeRichness(){return(await A.get(H.concatUrl(R(),j.knowledgeRichnessJson))).data}async getDocTagPrediction(){return(await A.get(H.concatUrl(R(),j.docTagPrediction))).data}async getStatisticInfo(){return(await A.get(H.concatUrl(R(),j.statisticInfoUrl))).data}async getCommitHeatmap(){return(await A.get(H.concatUrl(R(),j.yearCommitHeatmapUrl))).data}async getHourCommitHeatmap(){return(await A.get(H.concatUrl(R(),j.hourCommitHeatmap))).data}async getKnowledgeNetwork(){return(await A.get(H.concatUrl(R(),j.knowledgeNetworkJson))).data}async getPotentialKnowledgeNetwork(){return(await A.get(H.concatUrl(R(),j.potentialKnowledgeNetwork))).data}async getTagMapping(){return(await A.get(H.concatUrl(R(),j.tagMappingJson))).data}async getDescCommitDocList(){return(await A.get(H.concatUrl(R(),j.descCommitTimeDocList))).data}async getCommitTotalTrend(){return(await A.get(H.concatUrl(R(),j.commitTotalTrend))).data}async getDocQualityData(){return(await A.get(H.concatUrl(R(),j.docQualityJson))).data}static getInstance(){return this.instance||(this.instance=new fo),this.instance}};q([B],U.prototype,"getDocFileInfo");q([B],U.prototype,"getCategory");q([B],U.prototype,"getCompiledCategory");q([B],U.prototype,"getWordCloud");q([B],U.prototype,"getDocCluster");q([B],U.prototype,"getKnowledgeRichness");q([B],U.prototype,"getDocTagPrediction");q([B],U.prototype,"getStatisticInfo");q([B],U.prototype,"getCommitHeatmap");q([B],U.prototype,"getHourCommitHeatmap");q([B],U.prototype,"getKnowledgeNetwork");q([B],U.prototype,"getPotentialKnowledgeNetwork");q([B],U.prototype,"getTagMapping");q([B],U.prototype,"getDescCommitDocList");q([B],U.prototype,"getCommitTotalTrend");q([B],U.prototype,"getDocQualityData");let Es=U;const P=Es.getInstance();class Ps{name="";link="";chidren=[];level=-1}const _e={tags:[],books:[],name:"",level:3,links:[],standardName:"",alias:[]};function go(e){return e?(e=e.replace(/[’!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~]/g,""),e=e.replace(/\n/g,""),e=e.replace(/\t/g,""),e=e.replace(/\s/g,""),e=e.replace(/[\u0060|\u0021-\u002c|\u002e-\u002f|\u003a-\u003f|\u2200-\u22ff|\uFB00-\uFFFD|\u2E80-\u33FF]/g,""),e):""}var Te;(e=>{function t(n){let s=0;return n.map(a=>({id:a.link,topic:a.name,children:t(a.chidren),direction:s++%2==0?"right":"left"}))}function o(n){const s=t(n);return s.length>1?[{id:"root",topic:"root",expanded:!0,children:s,direction:"left"}]:s}e.mindConvert=o})(Te||(Te={}));function As(){let e=Math.random()*46656|0,t=Math.random()*46656|0,o=("000"+e.toString(36)).slice(-3),n=("000"+t.toString(36)).slice(-3);return o+n}const Fs={uuid:As};function Os(e={}){return{extensions:[zs(),Us()]}}function zs(e){return{name:"inlineKatex",level:"inline",start(t){return t.indexOf("$")},tokenizer(t,o){const n=t.match(/^\$+([^$\n]+?)\$+/);if(n)return{type:"inlineKatex",raw:n[0],text:n[1].trim()}},renderer(t){return`<span class="inline_tex tex" raw="${t.text}"></span>`}}}function Us(e){return{name:"blockKatex",level:"block",start(t){return t.indexOf("$$")},tokenizer(t,o){let n=t.match(/^\$\$+([^$]+?)\$\$/);if(n)return console.log(n[0]),{type:"blockKatex",raw:n[0],text:n[1].trim()};if(n=t.match(/^\$\$+\n([^$]+?)\n\$\$/),n)return{type:"blockKatex",raw:n[0],text:n[1].trim()}},renderer(t){return console.log(t.text),`<div class="line_tex tex" raw="${t.text}"></div>`}}}class Rs{occur=new Map;slug(t){const o=this.occur.get(t)||0;return this.occur.set(t,o+1),o===0?t:t+"-"+o}}const wo=()=>ge.getCurrentDatasource().url;function qs(e){return!e||e.startsWith("http")||e.startsWith("//")?e:(e.startsWith("/")?e=e.replace("/",""):e=e.replace("./",""),wo()+e)}function Bs(e,t){if(!e)return"";let o="/#/doc/"+e;return t&&(o+="?headingId="+t),o}class Hs{mdContent;docId;tagList;knowledgeLinkList;constructor(t,o,n,s){this.mdContent=t,this.docId=o,this.tagList=n,this.knowledgeLinkList=s}render(){Me.use(Os({}));const t=new Me.Renderer;t.link=s=>{const a=s.href;let r=s.text;if(a?.startsWith("http"))return`<a href='${a}' target="_blank">${r}</a>`;{const{id:l,headingId:c}=E.resloveDocUrl(a);return r=Array.from(new DOMParser().parseFromString(r,"text/html").body.childNodes).filter(u=>u.tagName!="SUP").map(u=>u.textContent).join(""),`<a href='${Bs(l,c)}' origin-link='${a}'>${r}</a>`}},t.code=s=>{const a=s.lang,r=s.text;return a=="mermaid"?`
          <div class="mermaid-wrapper" data-raw='${r}'>
            <div class="fullscreen">
              <button>全屏</button>
            </div>
            <div id='mermaid-${Fs.uuid()}'>${r}</div>
          </div>
        `:`<pre><code class="language-${a}">${this.hightlightCode(r,a)}</code></pre>`},t.image=s=>{let a=s.href;const r=s.text;return a?.startsWith("/")&&(a=wo()+a.replace("/","")),`<p class="img-wrapper"><img loading="lazy" src='${qs(a)}' width="480" height="240" crossorigin="anonymous"/><p class="img-title">${r}</p></p>`},new RegExp(this.knowledgeLinkList.map(s=>s.name).join("|")),t.text;const o=new Rs,n=t.table;return t.table=function(s){return`<div class="table-wrapper">${n.call(t,s)}</div>`},t.heading=function(s){const a=this.parser.parseInline(s.tokens),r=s.depth+1,l=s.raw.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,""),c=o.slug(l);return`<h${r} id="${c}">${a}</h${r}>
`},Me.parse(this.mdContent,{renderer:t})}hightlightCode(t,o){return o||(o="clike"),Ke.languages[o]||(o="clike"),Ke.highlight(t,Ke.languages[o],o)}}var js=Object.defineProperty,Vs=Object.getOwnPropertyDescriptor,Re=(e,t,o,n)=>{for(var s=Vs(t,o),a=e.length-1,r;a>=0;a--)(r=e[a])&&(s=r(t,o,s)||s);return s&&js(t,o,s),s};const qe=ye(),Le=class yo{static instance;tagSumList=[];tagList=[];docTagPredictions=[];constructor(){this.init()}async init(){this.tagList=await P.getTagMapping(),this.docTagPredictions=await P.getDocTagPrediction(),this.tagSumList=this.tagList.map(t=>({tag:t[0],count:t[1].length}))}name(){return"tag-service"}static getInstance(){return this.instance||(this.instance=new yo),this.instance}getTagSumList(){return JSON.parse(JSON.stringify(this.tagSumList))}getTagList(){return this.tagList.map(t=>t[0])}getPredictTag(t){return t?this.docTagPredictions.filter(o=>E.docUrl2Id(o[0])==t)[0][1]:[]}getListByTag(t){return this.tagList.filter(o=>o[0]==t).map(o=>o[1]).flatMap(o=>o)}};Re([qe],Le.prototype,"getTagSumList");Re([qe],Le.prototype,"getTagList");Re([qe],Le.prototype,"getPredictTag");Re([qe],Le.prototype,"getListByTag");let Ns=Le;const ke=Ns.getInstance();var Ks=Object.defineProperty,Qs=Object.getOwnPropertyDescriptor,Ws=(e,t,o,n)=>{for(var s=Qs(t,o),a=e.length-1,r;a>=0;a--)(r=e[a])&&(s=r(t,o,s)||s);return s&&Ks(t,o,s),s};const Js=ye(),_o=class ko{static instance;links=[];constructor(){this.init()}async init(){this.links=await this.fetchAllLinks()}static getInstance(){return this.instance||(this.instance=new ko),this.instance}name(){return"knowledge-network-service"}getAllLinks(){return JSON.parse(JSON.stringify(this.links))}async getDocStream(t){const o=await P.getKnowledgeNetwork(),n=new Set,s=[],a=[];function r(c){if(n.has(c))return;n.add(c);const u=o.filter(m=>m.links?.some(f=>f.id==c)).map(m=>m.id);u.length!=0&&(s.unshift(u),u.forEach(r))}function l(c){if(n.has(c))return;n.add(c);const u=o.filter(f=>f.id==c)[0];if(!u)return;const m=u.links?.map(f=>f.id)||[];m.length!=0&&(a.push(m),m.forEach(l))}return r(t),n.clear(),l(t),console.log([...s,[t],...a]),[...s,[t],...a]}async fetchAllLinks(){return(await P.getKnowledgeNetwork()).flatMap(o=>o.links||[])}};Ws([Js],_o.prototype,"fetchAllLinks");let Gs=_o;const $o=Gs.getInstance();var xs=Object.defineProperty,Ys=Object.getOwnPropertyDescriptor,K=(e,t,o,n)=>{for(var s=Ys(t,o),a=e.length-1,r;a>=0;a--)(r=e[a])&&(s=r(t,o,s)||s);return s&&xs(t,o,s),s};const Q=ye(),V=class vo{static instance;docQaulity=[];medianQuality=1;docQualityMap=new Map;docQualityOrderMap=new Map;constructor(){this.init()}async init(){this.docQaulity=await P.getDocQualityData();const t=this.docQaulity.map(n=>n.quality).sort((n,s)=>n-s),o=Math.floor(t.length/2);t.length%2==0?this.medianQuality=(t[o]+t[o-1])/2:this.medianQuality=t[o];for(let n=0;n<this.docQaulity.length;n++){const s=this.docQaulity[n];this.docQualityMap.set(s.id,s),this.docQualityOrderMap.set(s.id,n+1)}}name(){return"doc-service"}static getInstance(){return this.instance||(this.instance=new vo),this.instance}async getDocFileInfo(t){const o=await P.getDocFileInfo(t);return o.formattedMetadata=this.resolveMetadata(o),o}renderMdWithStructed(t){const o=this.renderMd(t),n=new DOMParser().parseFromString(o,"text/html").querySelector("body"),s=n.querySelectorAll("h1, h2, h3, h4, h5, h6"),a=["H1","H2","H3","H4","H5","H6"],r=new Map;let l=null,c="";for(const f of Array.from(n.children))a.some(w=>w==f.tagName)?(l?r.set(l,c):r.set(s[0].id,c),c="",l=f.id):c+=f.outerHTML;r.set(l,c);function u(f){const w=[];for(const L of f)w.push({id:L.link,title:L.name,level:L.level,content:r.get(L.link)||"",children:u(L.chidren)});return w}const m=this.getContent(o);return u(m)}renderMd(t){return t.content?this.renderMdFromText(t.content,t.id):""}renderMdFromText(t,o){return new Hs(t,o,ke.getTagSumList(),$o.getAllLinks()).render()}setDocReadRecrod(t,o){const n=this.getReadingRecords();n.set(t,o),this.setLastReadRecord(t),localStorage.setItem("doc-service::read-record",JSON.stringify([...n]))}setLastReadRecord(t){localStorage.setItem("doc-service:last-read",t);const o=localStorage.getItem("doc-service::read-history-list");let n=[];o&&(n=JSON.parse(o));const s=n.findIndex(a=>a.doc==t);s!=-1&&n.splice(s,1),n.push({doc:t,time:new Date().toISOString()}),n.length>20&&n.shift(),localStorage.setItem("doc-service::read-history-list",JSON.stringify(n))}getReadHistoryList(){const t=localStorage.getItem("doc-service::read-history-list");let o=[];return t&&(o=JSON.parse(t)),o=o.reverse(),o.forEach(n=>n.time=new Date(n.time).toLocaleString()),o}getLastReadRecord(){return localStorage.getItem("doc-service:last-read")||""}getDocReadRecord(t){return this.getReadingRecords().get(t)||0}getReadingRecords(){const t=localStorage.getItem("doc-service::read-record");let o;return t?o=new Map(JSON.parse(t)):o=new Map,o}buildSummaryDocInfo(t){return[`<p>${t.name}(${t.id})</p>`,`<div>创建时间: ${new Date(t.createTime).toLocaleString()}</div>`,`<div>最后更新: ${new Date(t.commitList[0].date).toLocaleString()}</div>`,`<div>⏰${Math.ceil((new Date().getTime()-new Date(t.commitList[0].date).getTime())/(3600*24*1e3))}天前更新, ✏️${go(t.content).length}字, ⚽${this.calcQuanlityStr(t.id)}</div>`,`<div>${this.resolveTagList(t)||""}</div>`].join(`
`)}docUrl2Id(t){return E.docUrl2Id(t)}docId2Url(t){return E.docId2Url(t)}async getContentByDocId(t){const o=await this.getDocFileInfo(t),n=this.renderMd(o);return this.getContent(n)}getContent(t){const n=new DOMParser().parseFromString(t,"text/html").querySelectorAll("h1, h2, h3, h4, h5, h6"),s=[],a=[];let r=-1;for(let l=0;l<n.length;l++){const c=n[l],u=parseInt(c.tagName.replace("H",""));r==-1&&(r=u);const m=new Ps;if(m.name=Array.from(c.childNodes).filter(f=>f.nodeName.toUpperCase()!="SUP").map(f=>f.textContent).join(""),m.link=c.getAttribute("id"),m.level=u,s[u]=m,u==r)a.push(m);else for(let f=u-1;f>=1;f--)if(s[f]){s[f].chidren.push(m);break}}return a}getImageUrlList(t){const n=new DOMParser().parseFromString(t,"text/html").querySelectorAll(".img-wrapper img"),s=[];for(const a of n)s.push(a.getAttribute("src")||"");return s}resolveLinkList(t){const n=new DOMParser().parseFromString(t,"text/html").querySelectorAll("a"),s=[];for(const a of n)s.push({text:a.innerText,link:a.getAttribute("href")||""});return s}resolveTagList(t){return Lt.load(t.metadata)?.tags}resolveMetadata(t){const o=Lt.load(t.metadata);if(o){for(const n in _e)o[n]||(o[n]=_e[n]);return o}return _e}getDocQuality(t){return this.docQualityMap.get(t)||null}calcQuanlityStr(t){const o=this.getDocQuality(t);if(!o)return"未知";const n=(o.quality/this.medianQuality*100).toFixed(0);return`${o.quality.toFixed(2)}(${this.docQualityOrderMap.get(t)||-1}/${this.docQaulity.length}, ${n}%)`}async generateMindData(t){const o=await this.getContentByDocId(t);return Te.mindConvert(o)[0]}async getSimliarDoc(t){const o=await P.getDocCluster();let n=null;function s(r,l){if(E.docUrl2Id(r.name)==t)return[r,!0];for(const c of r.children){const u=s(c,l);if(u[1]&&l[0]>0)return n=r,l[0]--,u}return[r,!1]}function a(r){return[r.name,...r.children.map(a).flatMap(l=>l)].filter(l=>l)}return s(o[0],[3]),n?a(n).filter(r=>this.docUrl2Id(r)!=t):[]}};K([Q],V.prototype,"getDocFileInfo");K([Q],V.prototype,"renderMdWithStructed");K([Q],V.prototype,"renderMd");K([Q],V.prototype,"renderMdFromText");K([Q],V.prototype,"buildSummaryDocInfo");K([Q],V.prototype,"getContentByDocId");K([Q],V.prototype,"getContent");K([Q],V.prototype,"resolveTagList");K([Q],V.prototype,"resolveMetadata");K([Q],V.prototype,"getDocQuality");K([Q],V.prototype,"calcQuanlityStr");K([Q],V.prototype,"generateMindData");K([Q],V.prototype,"getSimliarDoc");let Xs=V;const k=Xs.getInstance(),Et=k.getLastReadRecord()||"README";function Pt(e,t,o){N.isMobile()?o("/m"+e.fullPath):o()}function Ge(e,t,o){N.isMobile()?o():o(e.fullPath.replace("/m",""))}const Zs=[{path:"/",component:()=>X(()=>Promise.resolve().then(()=>qr),void 0),redirect:`/doc/${Et}`,beforeEnter:Pt,children:[{path:"/home",component:()=>X(()=>Promise.resolve().then(()=>va),void 0)},{path:"/doc/:doc",component:()=>X(()=>Promise.resolve().then(()=>lc),void 0),beforeEnter:Pt},{path:"/tag",component:()=>X(()=>Promise.resolve().then(()=>Bt),void 0)},{path:"/cluster",component:()=>X(()=>Promise.resolve().then(()=>_c),void 0)}]},{path:"/m",component:()=>X(()=>Promise.resolve().then(()=>Ic),void 0),redirect:`/m/doc/${Et}`,children:[{path:"/m/home",component:()=>X(()=>Promise.resolve().then(()=>Fc),void 0),beforeEnter:Ge},{path:"/m/doc/:doc",component:()=>X(()=>Promise.resolve().then(()=>td),void 0),beforeEnter:Ge},{path:"/m/tag",component:()=>X(()=>Promise.resolve().then(()=>Bt),void 0),beforeEnter:Ge}]}];function er(){return mn({history:fn(),routes:Zs})}class Ee{name="";link="";chidren=[];show=!1;parent;static childrenSize(t){if(t.chidren.length==0)return 0;let o=t.chidren.length;for(let n of t.chidren)o+=this.childrenSize(n);return o}}const xe="system::currentCategoryList";function tr(){return gn({state(){return{currentCategory:new Ee,currentCategoryList:[],isDarkMode:!1,currentHeading:"",currentSearchKw:"",showCategory:!1,currentOpenedMenu:new Set}},mutations:{addOpenedMenu(t,o){t.currentOpenedMenu.add(o)},setCurrentCategory(t,o){t.currentCategory=o;const n=t.currentCategoryList;n.indexOf(o.link)==-1&&(n.push(o.link),n.length>=10&&n.shift()),localStorage.setItem(xe,JSON.stringify(n))},removeFromCategoryList(t,o){const n=t.currentCategoryList,s=n.indexOf(o);s!=-1&&n.splice(s,1),localStorage.setItem(xe,JSON.stringify(n))},removeFromCategoryListExcept(t,o){const n=t.currentCategoryList,s=n.indexOf(o);s!=-1&&(t.currentCategoryList=n.splice(s,1)),localStorage.setItem(xe,JSON.stringify(n))},setSearchKw(t,o){t.currentSearchKw=o},setCurrentHeading(t,o){t.currentHeading=o},setCurrentCategoryList(t,o){t.currentCategoryList=o},setIsDarkMode(t,o){t.isDarkMode=o},setShowCategory(t,o){t.showCategory=o}}})}const Be=wn(Ss);Be.config.globalProperties.$isMobile=N.isMobile;Be.use(tr());const wt=er();wt.beforeEach((e,t,o)=>{$e.start(),o()});wt.afterEach(()=>{$e.done()});A.interceptors.request.use(e=>($e.start(),e));A.interceptors.response.use(e=>($e.done(),e),e=>($e.done(),Promise.resolve(e)));window.addEventListener("orientationchange",()=>location.reload());Be.use(wt);Be.mount("#app");const rt=new Map;rt.set("重",["ZHONG","CHONG"]);var fe;(e=>{function t(r){const l=[];for(const c of r)rt.has(c)?l.push(JSON.parse(JSON.stringify(rt.get(c)))):l.push([Zn.convertToPinyin(c)]);return l}function o(r,l="-"){const c=[];function u(m,f){if(!(m>=r.length)){m==r.length-1&&c.push(f.substring(0,f.length-1));for(const w of r[m]){const L=f+w+l;u(m+1,L)}}}return u(0,""),c}function n(r,l="-"){return o(t(r),l)}e.convertToPinyin=n;function s(r,l){const c=n(r);for(const u of c)if(u.replace(/-/gi,"").indexOf(l.toUpperCase())!=-1)return!0;return!1}e.fullPinyinContains=s;function a(r,l){const c=n(r);for(const u of c)if(u.split("-").map(m=>m.charAt(0)).join("").indexOf(l.toUpperCase())!=-1)return!0;return!1}e.firstLetterPinyinContains=a})(fe||(fe={}));var or=Object.defineProperty,nr=Object.getOwnPropertyDescriptor,yt=(e,t,o,n)=>{for(var s=nr(t,o),a=e.length-1,r;a>=0;a--)(r=e[a])&&(s=r(t,o,s)||s);return s&&or(t,o,s),s};const _t=ye(),Ye="category-service::search-record-list",He=class bo{static instance;cahedCategoryList=[];constructor(){}name(){return"category-service"}static getInstance(){return this.instance||(this.instance=new bo),this.instance}async getCategoryList(){const t=await P.getCategory(),o=Me(t.content),n=new Ee;return n.name="首页",n.link="./README.md",[n,...this.categoryParse(o)]}async getCompiledCategoryList(){const t=await P.getCompiledCategory(),o=[...t];for(;o.length!=0;){const n=o.pop();n?.chidren&&(n.chidren.forEach(s=>s.parent=n),o.push(...n.chidren))}return this.cahedCategoryList=t,t}async getFlatCategoryList(){const t=await this.getCompiledCategoryList(),o=[],n=[...t];for(;n.length!=0;){const s=n.pop();s?.link&&o.push(s),s?.chidren&&n.push(...s.chidren)}return o}getCategory(t){const o=[...this.cahedCategoryList],n=[];for(;o.length!=0;){const s=o.pop();t(s)&&n.push(s),o.push(...s.chidren)}return n}addCategorySearchRecord(t){const o=localStorage.getItem(Ye);let n=[];o&&(n=JSON.parse(o));const s=n.findIndex(a=>a.link==t.link);s!=-1&&n.splice(s,1),n.push(t),n.length>20&&n.shift(),localStorage.setItem(Ye,JSON.stringify(n))}getCategorySearchRecords(){const t=localStorage.getItem(Ye);let o=[];return t&&(o=JSON.parse(t)),o=o.reverse(),o}categoryIsMatch(t,o){const n=o.split(" ");let s=!0;for(const a of n)s&&=this.categoryNameIsMatch(t,a)||this.categoryLinkIsMatch(t,a);return s}categoryLinkIsMatch(t,o){const n=decodeURI(t.link).replace(/\//gi,"");return n.toLowerCase().indexOf(o.toLowerCase())!=-1||fe.fullPinyinContains(n,o)||fe.firstLetterPinyinContains(n,o)}categoryNameIsMatch(t,o){return t.name?.toLowerCase().indexOf(o.toLowerCase())!=-1||fe.fullPinyinContains(t.name,o)||fe.firstLetterPinyinContains(t.name,o)}categoryParse(t){const n=new DOMParser().parseFromString(t,"text/html").querySelectorAll("body > ul > li"),s=[];for(let a=0;a<n.length;a++)s.push(this.resolveCategory(n[a]));return s}resolveCategory(t){const o=new Ee;o.name=t.firstChild?.textContent||"",o.link=t.querySelector("a")?.getAttribute("href");const n=t.querySelector("ul")?.querySelectorAll(":scope > li");if(!n)return o;for(let s=0;s<n.length;s++){const a=this.resolveCategory(n[s]);a.parent=o,o.chidren.push(a)}return o}};yt([_t],He.prototype,"getCategoryList");yt([_t],He.prototype,"getCompiledCategoryList");yt([_t],He.prototype,"getFlatCategoryList");let sr=He;const re=sr.getInstance(),rr=y({setup(){const e=W();return{autoComplete:e,focusAutoComplete:()=>{e.value?.focus()}}},data(){return{showDialog:!1,categoryList:[],flatCategoryList:[],kw:""}},methods:{show(){this.showDialog=!0},docUrl2Id:E.docUrl2Id,flatMapCategoryList(e){let t=[];for(let o of e)t.push(o),t=t.concat(...this.flatMapCategoryList(o.chidren));return t},querySearch(e,t){if(!e)t(re.getCategorySearchRecords());else{const o=this.flatCategoryList.filter(n=>re.categoryIsMatch(n,e));t(o)}},renderHilighHTML(e){const t=(this.kw||"").trim().split(" ");let o=e;for(let n of t)o=o.replace(new RegExp(n,"gi"),s=>`<mark>${s}</mark>`);return o},handleSelect(e){re.addCategorySearchRecord({name:e.name,link:e.link,chidren:[]}),this.$router.push("/doc/"+this.docUrl2Id(e.link)),this.showDialog=!1}},async created(){this.categoryList=await re.getCategoryList(),this.flatCategoryList=this.flatMapCategoryList(this.categoryList).filter(e=>e.name)}}),ar=["innerHTML"],ir=["innerHTML"];function lr(e,t,o,n,s,a){const r=jt,l=Vt;return h(),v(l,{modelValue:e.showDialog,"onUpdate:modelValue":t[1]||(t[1]=c=>e.showDialog=c),width:e.$isMobile()?"90%":"40%",onOpened:e.focusAutoComplete},{default:d(()=>[i(r,{modelValue:e.kw,"onUpdate:modelValue":t[0]||(t[0]=c=>e.kw=c),"fetch-suggestions":e.querySearch,placeholder:"搜索目录","popper-class":"popper-list","popper-append-to-body":!1,ref:"autoComplete",onSelect:e.handleSelect,size:"default"},{default:d(({item:c})=>[p("div",{class:"value",innerHTML:e.renderHilighHTML(c.name)},null,8,ar),p("span",{class:"link",innerHTML:e.renderHilighHTML(e.docUrl2Id(c.link))},null,8,ir)]),_:1},8,["modelValue","fetch-suggestions","onSelect"])]),_:1},8,["modelValue","width","onOpened"])}const je=b(rr,[["render",lr],["__scopeId","data-v-3e8e1a03"]]);var cr=Object.defineProperty,dr=Object.getOwnPropertyDescriptor,Co=(e,t,o,n)=>{for(var s=dr(t,o),a=e.length-1,r;a>=0;a--)(r=e[a])&&(s=r(t,o,s)||s);return s&&cr(t,o,s),s};const pe="mark",So=ye(),Do=/,|，|\s+/;function me(e,t){if(!t)return!1;const o=e.trim().split(Do).filter(n=>n);for(let n of o)if(t.replace(/<[^>]+>/ig,"").toLowerCase().indexOf(n.toLowerCase())!=-1)return!0;return!1}function At(e,t){const o=t.trim().split(Do).filter(n=>n);for(let n of o)e.id.replace(/<[^>]+>/ig,"").toLowerCase().indexOf(n.toLowerCase())==-1&&e.txt.replace(/<[^>]+>/ig,"").toLowerCase().indexOf(n.toLowerCase())==-1&&(e.missingKeywords?e.missingKeywords.push(n):e.missingKeywords=[n]);return e}const kt=class Lo{static instance;constructor(){}static getInstance(){return this.instance||(this.instance=new Lo),this.instance}name(){return"search-service"}async search(t,o="es"){if(o=="es")return this.searchInSelfES(t);const a=await Mt("K9I7PAT3CY","8f3ec5043331dedbccce916154fc0162").initIndex("note").search(t,{hitsPerPage:200,highlightPreTag:`<${pe}>`,highlightPostTag:`</${pe}>`});if(a){let r=a.hits.map(l=>({url:l.url,hilighedUrl:l._highlightResult?.url?.value,createTime:l.createTime,hilighedSegement:l._highlightResult?.segments?.map(c=>({id:c?.id?.value,txt:c?.txt?.value})).filter(c=>c.id?.indexOf(`<${pe}>`)!=-1||c.txt?.indexOf(`<${pe}>`)!=-1).filter(c=>me(t,c.id||"")||me(t,c.txt||"")).map(c=>At(c,t))}));return r=r.filter(l=>l.hilighedSegement&&l.hilighedSegement.length!=0||me(t,l.url)),{took:a.processingTimeMS,list:r}}return{took:0,list:[]}}async searchInSelfES(t){const n=(await A.get(`https://search.ismy.wang/search?kw=${encodeURI(t)}`)).data,s=n.hits.hits;if(s){let r=s.map(l=>{const c=l.highlight["segments.id"]?.map(f=>f.replace(/<mark>/gi,"").replace(/<\/mark>/gi,""))||[],u=l.highlight["segments.txt"]?.map(f=>f.replace(/<mark>/gi,"").replace(/<\/mark>/gi,""))||[],m=l.highlight.url||[];return{url:l._source.url,score:l._score,hilighedUrl:m[0]||l._source.url,createTime:l._source.createTime,hilighedSegement:l._source.segments.map(f=>{if(l.highlight["segments.id"])for(let w=0;w<c.length;w++)f.id=f.id.replace(c[w],l.highlight["segments.id"][w]);if(l.highlight["segments.txt"])for(let w=0;w<u.length;w++)f.txt=f.txt.replace(u[w],l.highlight["segments.txt"][w]);return f}).filter(f=>f.id.indexOf(`<${pe}>`)!=-1||f.txt.indexOf(`<${pe}>`)!=-1).filter(f=>me(t,f.id||"")||me(t,f.txt||"")).map(f=>At(f,t))}}).filter(l=>l.hilighedSegement&&l.hilighedSegement.length!=0||me(t,l.url));return{took:n.took,list:r}}return{took:0,list:[]}}async getQuerySuggestions(t=""){const s=await Mt("K9I7PAT3CY","8f3ec5043331dedbccce916154fc0162").initIndex("note_query_suggestions").search(t,{hitsPerPage:100});return s?s.hits:[]}};Co([So],kt.prototype,"search");Co([So],kt.prototype,"getQuerySuggestions");let ur=kt;const Ft=ur.getInstance();let Ot;const hr=y({setup(){},data(){return{kw:"",showDrawer:!1,showEmpty:!0,showLoading:!1,resultList:[],searchTook:0,searchSuggestionList:[],searchEngineList:["es","algolia"],searchEngine:"algolia"}},computed:{outerKw(){return this.$store.state.currentSearchKw},loadingColor(){return this.$store.state.isDarkMode?"rgba(0, 0, 0, 0.8)":"rgba(0, 0, 0, 0.2)"}},watch:{outerKw(e){this.showDrawer=!0,this.kw=e,this.handleSearch()}},methods:{async show(){this.showDrawer=!0,setTimeout(()=>{this.$refs.input.focus()},200),this.searchSuggestionList=await Ft.getQuerySuggestions()},hide(){this.showDrawer=!1},handleSearch(){this.$refs.input.close(),this.showEmpty=!1,clearTimeout(Ot),Ot=setTimeout(async()=>{this.showLoading=!0;const e=await Ft.search(this.kw,this.searchEngine);this.resultList=e.list,this.searchTook=e.took,this.showEmpty=!0,this.showLoading=!1,document.querySelector(".search .el-drawer__body")?.scrollTo(0,0)},500)},handleDocClick(e,t){!e.startsWith("./")&&!e.startsWith("/")&&(e="/"+e);const o=k.docUrl2Id(e);t&&(t=t.replace(/<mark>/gi,"").replace(/<\/mark>/gi,"")),this.$router.push({path:"/doc/"+o,query:{headingId:t,kw:this.kw}})},handleSearchSelect(e){this.kw=e.query,this.handleSearch()},getSearchSuggestion(e,t){if(!e)return t([]);const o=this.searchSuggestionList.filter(n=>n.query.toLowerCase().indexOf(e.toLowerCase())!=-1);t(o)}}}),pr={class:"search-suggestion-item"},mr={style:{width:"48px"}},fr={key:0,class:"search-took"},gr=["element-loading-background"],wr={class:"result-item top-heading"},yr=["innerHTML","onClick"],_r={class:"index-time-wrapper"},kr=["onClick"],$r=["innerHTML"],vr=["innerHTML"],br={key:0};function Cr(e,t,o,n,s,a){const r=ct,l=lt,c=it,u=jt,m=be,f=vn,w=J,L=$n;return h(),v(w,{modelValue:e.showDrawer,"onUpdate:modelValue":t[2]||(t[2]=$=>e.showDrawer=$),size:e.$isMobile()?"90%":"600px","custom-class":"search"},{header:d(()=>[i(u,{modelValue:e.kw,"onUpdate:modelValue":t[1]||(t[1]=$=>e.kw=$),placeholder:"搜索","fetch-suggestions":e.getSearchSuggestion,onKeydown:yn(e.handleSearch,["enter"]),"popper-class":"popper-list",onSelect:e.handleSearchSelect,size:"default",ref:"input"},{default:d(({item:$})=>[p("div",pr,C($.query),1),i(r,{value:$.popularity},null,8,["value"])]),append:d(()=>[p("div",mr,[i(c,{style:{height:"100%"},modelValue:e.searchEngine,"onUpdate:modelValue":t[0]||(t[0]=$=>e.searchEngine=$),placeholder:"搜索引擎",size:"default","popper-class":"popper-list"},{default:d(()=>[(h(!0),g(D,null,I(e.searchEngineList,$=>(h(),v(l,{key:$,label:$,value:$},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),suffix:d(()=>[e.resultList.length>0?(h(),g("span",fr,"搜索耗时:"+C(e.searchTook),1)):O("",!0)]),_:1},8,["modelValue","fetch-suggestions","onKeydown","onSelect"])]),default:d(()=>[ae((h(),g("div",{class:"search-result","element-loading-background":e.loadingColor},[(h(!0),g(D,null,I(e.resultList,$=>(h(),g("div",{key:$.url},[p("div",wr,[p("h1",{class:"",innerHTML:$.hilighedUrl,onClick:M=>e.handleDocClick($.url)},null,8,yr),p("div",_r,[i(m,{class:"index-time",size:"small"},{default:d(()=>[_("⏰索引时间: "+C(new Date($.createTime).toLocaleString()),1)]),_:2},1024),$.score?(h(),v(m,{key:0,class:"index-time",style:{"margin-left":"10px"},size:"small"},{default:d(()=>[_("⚽分数: "+C($.score),1)]),_:2},1024)):O("",!0)])]),(h(!0),g(D,null,I($.hilighedSegement,M=>(h(),g("div",{key:M.id,class:"result-item",onClick:Y=>e.handleDocClick($.url,M.id)},[p("h3",{innerHTML:M.id},null,8,$r),p("p",{innerHTML:M.txt},null,8,vr),M.missingKeywords?(h(),g("p",br,[t[3]||(t[3]=p("span",{class:"font-size:12px;color:#666"},"缺少关键词:",-1)),(h(!0),g(D,null,I(M.missingKeywords,Y=>(h(),v(m,{key:Y,size:"small",type:"danger"},{default:d(()=>[p("del",null,C(Y),1)]),_:2},1024))),128))])):O("",!0)],8,kr))),128))]))),128))],8,gr)),[[L,e.showLoading]]),e.resultList.length==0?ae((h(),v(f,{key:0,description:e.kw?`按下回车以搜索 ${e.kw}`:"搜索结果将在这里展示"},null,8,["description"])),[[ce,e.showEmpty]]):O("",!0)]),_:1},8,["modelValue","size"])}const Ve=b(hr,[["render",Cr],["__scopeId","data-v-43aad77a"]]);class $t{static instance;events;static getInstance(){return this.instance||(this.instance=new $t),this.instance}constructor(){this.events=new Map}emit(t,o){this.events.has(t)&&this.events.get(t).forEach(function(n){n(o)})}on(t,o){this.events.set(t,this.events.get(t)||[]),this.events.get(t).push(o)}off(t,o){if(this.events.has(t)){const s=this.events.get(t);for(var n=0;n<s.length;n++)if(s[n]===o){s.splice(n,1);break}}}}const Pe=$t.getInstance(),Sr=y({setup(){},data(){return{showMode:!1}},watch:{isDark(){this.showMode=this.isDark}},computed:{isDark(){return this.$store.state.isDarkMode}},created(){this.showMode=this.isDark},methods:{toggleDarkMode(){document.body.getAttribute("theme")=="dark"?N.enterLightMode(this):N.enterDarkMode(this)}}}),Mo=y({...Sr,__name:"ThemeSwitcher",setup(e){return(t,o)=>{const n=Nt;return h(),v(n,{modelValue:t.showMode,"onUpdate:modelValue":o[0]||(o[0]=s=>t.showMode=s),"inline-prompt":!0,"active-icon":T(Cn),"inactive-icon":T(bn),onClick:t.toggleDarkMode,"active-color":"#000","inactive-color":"#409EFF"},null,8,["modelValue","active-icon","inactive-icon","onClick"])}}}),Dr={class:"optimized-header"},Lr={class:"header-wrapper"},Mr={class:"container"},Ir={class:"logo"},Tr={class:"content"},Er={class:"header-actions"},Pr={class:"header-links"},Ar=y({data(){return{name:"my-book",fullscreen:!1}},methods:{handleNavMenuClick(e){e.url?window.open(e.url):this.$router.push(e.router)},clearCache(){De.getInstance().clear(),Z.success("清除缓存完成")},handleToggleFullScreen(){this.fullscreen=!document.fullscreenElement,this.fullscreen?document.body.requestFullscreen():document.exitFullscreen()},enterZenMode(){Pe.emit("enter-zen-mode",null)},refresh(){location.reload()}},computed:{siteName(){return G.siteName},linkList(){return G.linkList}},created(){Pe.on("enter-zen-mode",()=>{document.body.requestFullscreen()})}}),Fr=y({...Ar,__name:"Header",setup(e){return(t,o)=>{const n=Kt,s=x,a=z,r=Dn,l=Wt,c=ue;return h(),g("div",Dr,[p("div",Lr,[p("div",Mr,[p("div",Ir,[p("a",{href:"#",onClick:o[0]||(o[0]=de(u=>t.$router.push("/home"),["prevent"]))},C(t.siteName),1)]),p("div",Tr,[p("div",Er,[i(Mo,{class:"action-item"}),i(n,{direction:"vertical",class:"divider"}),i(l,{class:"action-group"},{default:d(()=>[i(a,{size:"small",onClick:t.handleToggleFullScreen,title:"进入/退出全屏模式",class:"action-btn"},{default:d(()=>[i(s,null,{default:d(()=>[i(T(Sn))]),_:1})]),_:1},8,["onClick"]),i(a,{size:"small",onClick:t.refresh,class:"action-btn"},{default:d(()=>[i(s,null,{default:d(()=>[i(T(Qt))]),_:1})]),_:1},8,["onClick"]),i(r,{title:"确认清空缓存?",onConfirm:t.clearCache},{reference:d(()=>[i(a,{size:"small",title:"清空缓存",class:"action-btn"},{default:d(()=>[i(s,null,{default:d(()=>[i(T(Ln))]),_:1})]),_:1})]),_:1},8,["onConfirm"]),i(a,{size:"small",onClick:t.enterZenMode,title:"进入专注模式",class:"action-btn"},{default:d(()=>[i(s,null,{default:d(()=>[i(T(Ie))]),_:1})]),_:1},8,["onClick"])]),_:1}),i(n,{direction:"vertical",class:"divider"}),i(l,{class:"action-group"},{default:d(()=>[i(a,{class:"search-btn",onClick:o[1]||(o[1]=u=>t.$emit("search")),size:"small",round:""},{default:d(()=>[...o[3]||(o[3]=[_("全文搜索",-1)])]),_:1}),i(a,{class:"search-btn",onClick:o[2]||(o[2]=u=>t.$emit("category-search")),size:"small",round:""},{default:d(()=>[...o[4]||(o[4]=[_("目录搜索",-1)])]),_:1})]),_:1}),i(n,{direction:"vertical",class:"divider"}),p("div",Pr,[(h(!0),g(D,null,I(t.linkList,u=>(h(),v(c,{href:u.url,key:u.url,target:"_blank",class:"header-link"},{default:d(()=>[_(C(u.title),1)]),_:2},1032,["href"]))),128))])])])])])])}}}),Io=b(Fr,[["__scopeId","data-v-f85ee887"]]);class ve{static STORAGE_KEY="config-service::";static get(t){return ve.getConfigMap().get(t)}static set(t,o){const n=ve.getConfigMap();n.set(t,o),localStorage.setItem(this.STORAGE_KEY,JSON.stringify(Array.from(n)))}static getConfigMap(){const t=localStorage.getItem(this.STORAGE_KEY);return t?new Map(Array.from(JSON.parse(t))):new Map}}const Or="system::currentCategoryList",zr=y({components:{Header:Io,Search:Ve,CategorySearch:je,ArrowUpBold:Dt,ArrowDownBold:St},setup(){const e=W(),t=W();return{search:e,showSearch:()=>{e.value?.show()},categorySearch:t,showCategorySearch:()=>{t.value?.show()},ArrowUpBold:Dt,ArrowDownBold:St}},watch:{showHeader(e){ve.set("showHeader",e)}},provide(){return{showHeader:_n(()=>this.showHeader)}},methods:{clearCache(){De.getInstance().clear(),Z.success("清除缓存完成")}},data(){return{showHeader:!0,lastClickTime:0}},created(){const e=[{hotkey:"ctrl + q",action:()=>this.$refs.categorySearch.show()},{hotkey:"ctrl + k",action:()=>this.$refs.search.show()},{hotkey:"ctrl + l",action:()=>this.clearCache()},{hotkey:"db + shift",action:()=>this.$refs.categorySearch.show()},{hotkey:"db + s",action:()=>this.$refs.search.show()}],t=new Map;document.addEventListener("keydown",s=>{for(let a of e){const r=a.hotkey.split("+")[0].trim(),l=a.hotkey.split("+")[1].trim();let c=!1;if(r=="alt"&&(c=s.altKey),r=="ctrl"&&(c=s.ctrlKey),r=="shift"&&(c=s.shiftKey),r=="db"&&s.key.toLowerCase()==l){if(new Date().getTime()-(t.get(l)||0)<=300)return a.action(),s.preventDefault();t.set(l,new Date().getTime())}if(c&&s.key.toUpperCase()==l.toUpperCase())return a.action(),s.preventDefault()}});const o=localStorage.getItem(Or);o&&this.$store.commit("setCurrentCategoryList",JSON.parse(o)),Pe.on("enter-zen-mode",()=>{this.showHeader=!1});const n=ve.get("showHeader");typeof n<"u"&&(this.showHeader=n)}});function Ur(e,t,o,n,s,a){const r=Io,l=dt,c=Jt,u=z,m=S("router-view"),f=Fe,w=Oe,L=Ve,$=je;return h(),g(D,null,[i(w,{class:"main-layout"},{default:d(()=>[ae(i(c,null,{default:d(()=>[i(l,{offset:0},{default:d(()=>[i(r,{onSearch:e.showSearch,onCategorySearch:e.showCategorySearch},null,8,["onSearch","onCategorySearch"])]),_:1})]),_:1},512),[[ce,e.showHeader]]),p("div",{class:"header-toggle-button",style:we({"margin-top":e.showHeader?"60px":"10px"})},[i(u,{onClick:t[0]||(t[0]=M=>e.showHeader=!e.showHeader),size:"small",type:"default",icon:e.showHeader?e.ArrowUpBold:e.ArrowDownBold,circle:"",title:e.showHeader?"隐藏顶部栏":"显示顶部栏"},null,8,["icon","title"])],4),i(f,null,{default:d(()=>[i(m)]),_:1})]),_:1}),i(L,{ref:"search"},null,512),i($,{ref:"categorySearch"},null,512)],64)}const Rr=b(zr,[["render",Ur],["__scopeId","data-v-963984be"]]),qr=Object.freeze(Object.defineProperty({__proto__:null,default:Rr},Symbol.toStringTag,{value:"Module"}));oe([gt,ns,ne]);const Br=y({setup(){},computed:{isDark(){return this.$store.state.isDarkMode}},watch:{isDark(){this.init()}},methods:{async init(){const e=new Map(await P.getHourCommitHeatmap());let t=[];for(let a=0;a<24;a++)t.push([a,e.get(a.toString())||0]);var o=this.$refs.main,n=te(o);const s={title:{text:"各时段提交统计(GMT+8)",left:"center",textStyle:{color:this.isDark?"#bbb":"#666"}},xAxis:{type:"category",data:t.map(a=>a[0])},yAxis:{type:"value"},tooltip:{formatter:"{c}",backgroundColor:this.isDark?"#666":"#fff",textStyle:{color:this.isDark?"#bbb":"#666"}},series:[{data:t.map(a=>a[1]),type:"bar",showBackground:!0,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)"}}]};s&&n.setOption(s)}},mounted(){this.init()}}),Hr={ref:"main",class:"main"};function jr(e,t,o,n,s,a){return h(),g("div",Hr,null,512)}const Vr=b(Br,[["render",jr],["__scopeId","data-v-32b12a65"]]);function Nr(e){return JSON.parse(JSON.stringify(e))}oe([Se,ss,he,gt,ze,rs,ne,ho,po]);const Kr=y({setup(){},computed:{isDark(){return this.$store.state.isDarkMode}},watch:{isDark(){this.init()},type(){this.init()}},data(){return{type:"absolute",chart:null}},methods:{async init(){const e=Nr(await P.getCommitTotalTrend()),t=te(this.$refs.chartContainer);if(this.type==="relative")for(let s=e.length-1;s>0;s--)e[s][1]-=e[s-1][1],e[s][2]-=e[s-1][2],e[s][3]-=e[s-1][3];const o=this.type==="absolute",n={darkMode:this.isDark,dataZoom:[{start:0,end:100},{start:0,end:100}],title:{text:"提交趋势",textStyle:{color:this.isDark?"#bbb":""}},tooltip:{trigger:"axis",backgroundColor:this.isDark?"#666":"#fff",textStyle:{color:this.isDark?"#bbb":""}},legend:{data:o?["总字数","总行数","总提交"]:["相对字数","相对行数","相对提交"],textStyle:{color:this.isDark?"#bbb":"#666"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},toolbox:{feature:{saveAsImage:{show:!1}}},xAxis:{type:"category",boundaryGap:!1,data:e.map(s=>s[0])},yAxis:{type:"value",min:"dataMin"},series:[{name:o?"总字数":"相对字数",type:"line",data:e.map(s=>s[1])},{name:o?"总行数":"相对行数",type:"line",data:e.map(s=>s[2])},{name:o?"总提交":"相对提交",type:"line",data:e.map(s=>s[3])}]};t.setOption(n)}},async mounted(){this.init()}}),Qr={ref:"chartContainer",class:"chartContainer"};function Wr(e,t,o,n,s,a){const r=Mn,l=ut;return h(),g("div",null,[i(l,{size:"small",style:{"margin-bottom":"8px","margin-left":"60px"},modelValue:e.type,"onUpdate:modelValue":t[0]||(t[0]=c=>e.type=c)},{default:d(()=>[i(r,{label:"absolute"},{default:d(()=>[...t[1]||(t[1]=[_("绝对量",-1)])]),_:1}),i(r,{label:"relative"},{default:d(()=>[...t[2]||(t[2]=[_("相对量",-1)])]),_:1})]),_:1},8,["modelValue"]),p("div",Qr,null,512)])}const Jr=b(Kr,[["render",Wr],["__scopeId","data-v-d752299b"]]);class Gr{commitPerDay=0;linePerDay=0}class xr{total=0;wordPerDay=0}class Yr{generateTime="";repositorySize=0;commit=new Gr;word=new xr;chapterCount=0;imageCount=0;codeFrequency=[];firstCommitDate=""}const To={fillTimeRange(e){const t=new Map(e),o=[e[0][0],e[e.length-1][0]],n=+Qe(o[0]),s=+Qe(o[1]),a=3600*24*1e3,r=[];for(let l=n;l<s;l+=a){const c=Qe(l).format("YYYY-MM-DD");r.push([c,t.get(c)||0])}return r},generatePieces(e,t=!1){const o=[t?"#323233":"#fff",t?"#00452b":"#98E9A8",t?"#006f37":"#40C403",t?"#00a84b":"#30A14E",t?"#007534":"#216E39",t?"#00d65f":"#1A572D"],n=[],s=Math.ceil(e/2);let a={};a.lte=0,a.gte=0,a.label="0",a.color=o[0],n.push(a);for(let r=1;r<=5;r++)a={},r==1?a.gte=1:a.gte=s*(r-1),a.lte=s*r,a.color=o[r],n.push(a);return n}};oe([Se,as,he,mo,is,ne]);const Xr=To.fillTimeRange,Zr=To.generatePieces,ea=y({setup(){},computed:{isDark(){return this.$store.state.isDarkMode}},watch:{isDark(){this.init()}},methods:{async init(){const e=Xr(await P.getCommitHeatmap()),t=document.getElementById("heatmap"),o=te(t);let n;const s=e.map(r=>r[1]).sort().reverse()[0],a=[e[0][0],e[e.length-1][0]];n={title:{top:30,left:"center",text:"提交日历图",textStyle:{color:this.isDark?"#bbb":"#666"}},tooltip:{formatter(r){const l=r.data;return`${l[0]} ${l[1]}次`},backgroundColor:this.isDark?"#666":"#fff",textStyle:{color:this.isDark?"#bbb":"#666"}},visualMap:{min:0,max:s,type:"piecewise",orient:"horizontal",left:"center",top:65,pieces:Zr(s,this.isDark),textStyle:{color:this.isDark?"#bbb":"#666"}},calendar:{top:120,left:30,right:30,cellSize:["auto",20],range:a,itemStyle:{borderWidth:.5},yearLabel:{show:!0},dayLabel:{show:!0,nameMap:"ZH",firstDay:1,color:this.isDark?"#bbb":""},monthLabel:{show:!0,nameMap:"ZH",color:this.isDark?"#bbb":""}},series:{type:"heatmap",coordinateSystem:"calendar",data:e}},n&&o.setOption(n)}},mounted(){this.init()}}),ta={id:"heatmap"};function oa(e,t,o,n,s,a){return h(),g("div",ta)}const Eo=b(ea,[["render",oa],["__scopeId","data-v-219a789f"]]);oe([Se,he,mo,ne]);const na=y({setup(){},data(){return{chart:null}},computed:{isDark(){return this.$store.state.isDarkMode}},watch:{isDark(){this.init()}},methods:{async init(){let e=await P.getWordCloud();const t=te(document.getElementById("wordcloud")),o={tooltip:{backgroundColor:this.isDark?"#666":"#fff",textStyle:{color:this.isDark?"#bbb":""}},series:[{type:"wordCloud",gridSize:2,sizeRange:[12,108],rotationRange:[0,0],shape:"diamond",width:"100%",height:"85%",textStyle:{color:function(){return"rgb("+[Math.round(Math.random()*160),Math.round(Math.random()*160),Math.round(Math.random()*160)].join(",")+")"},emphasis:{textStyle:{shadowBlur:10,shadowColor:"#333",color:"#409EFF"}}},data:e.map(n=>({name:n[0],value:n[1]}))}]};t.setOption(o),t.on("click",n=>{const s=n.data.name;this.$store.commit("setSearchKw",s)})}},async mounted(){this.init()}}),sa={class:"wordcloud-wrapper"};function ra(e,t,o,n,s,a){return h(),g("div",sa,[...t[0]||(t[0]=[p("div",{id:"wordcloud"},null,-1)])])}const Po=b(na,[["render",ra],["__scopeId","data-v-5584e6ce"]]),zt={"onec-enterprise":"#814CCC",abap:"#E8274B","abap-cds":"#555e25","ags-script":"#B9D9FF",aidl:"#34EB6B",al:"#3AA2B5",ampl:"#E6EFBB",antlr:"#9DC3FF","api-blueprint":"#2ACCA8",apl:"#5A8164",aspdotnet:"#9400ff",ats:"#1ac620",actionscript:"#882B0F",ada:"#02f88c",agda:"#315665",alloy:"#64C800",angelscript:"#C7D7DC",apex:"#1797c0","apollo-guidance-computer":"#0B3D91",applescript:"#101F1F",arc:"#aa2afe",aspectj:"#a957b0",assembly:"#6E4C13",asymptote:"#ff0000",autohotkey:"#6594b9",autoit:"#1C3552",awk:"#c30e9b",basic:"#ff0000",ballerina:"#FF5000",batchfile:"#C1F12E",beef:"#a52f4e",bicep:"#519aba",bison:"#6A463F",blade:"#f7523f",blitzmax:"#cd6400",boo:"#d4bec1",boogie:"#c80fa0",brainfuck:"#2F2530",browserslist:"#ffd539",c:"#555555",csharp:"#178600",cpp:"#f34b7d",cson:"#244776",css:"#563d7c",cue:"#5886E1",ceylon:"#dfa535",chapel:"#8dc63f",cirru:"#ccccff",clarion:"#db901e","classic-asp":"#6a40fd",clean:"#3F85AF",click:"#E4E6F3",clojure:"#db5855","closure-templates":"#0d948f",coffeescript:"#244776",coldfusion:"#ed2cd6","coldfusion-cfc":"#ed2cd6","common-lisp":"#3fb68b","common-workflow-language":"#B5314C","component-pascal":"#B0CE4E",crystal:"#000100",cuda:"#3A4E3A",d:"#ba595e",dm:"#447265",dafny:"#FFEC25",dart:"#00B4AB",dataweave:"#003a52",dhall:"#dfafff",dockerfile:"#384d54",dogescript:"#cca760",dylan:"#6c616e",e:"#ccce35",ecl:"#8a1267",ejs:"#a91e50",eq:"#a78649",eiffel:"#4d6977",elixir:"#6e4a7e",elm:"#60B5CC","emacs-lisp":"#c065db",emberscript:"#FFF4F3",erlang:"#B83998",fsharp:"#b845fc",fstar:"#572e30",flux:"#88ccff",factor:"#636746",fancy:"#7b9db4",fantom:"#14253c",faust:"#c37240",fluent:"#ffcc33",forth:"#341708",fortran:"#4d41b1",freebasic:"#867db1",freemarker:"#0050b2",frege:"#00cafe",futhark:"#5f021f","g-code":"#D08CF2",gaml:"#FFC766",gdscript:"#355570","game-maker-language":"#71b417",gemfiledotlock:"#701516",genie:"#fb855d",gherkin:"#5B2063",glyph:"#c1ac7f",gnuplot:"#f0a9f0",go:"#00ADD8",golo:"#88562A",gosu:"#82937f","grammatical-framework":"#ff0000",graphql:"#e10098",groovy:"#e69f56",html:"#e34c26",hack:"#878787",haml:"#ece2a9",handlebars:"#f7931e",harbour:"#0e60e3",haskell:"#5e5086",haxe:"#df7900",hiveql:"#dce200",holyc:"#ffefaf",hy:"#7790B2",idl:"#a3522f","igor-pro":"#0000cc",idris:"#b30000","imagej-macro":"#99AAFF",io:"#a9188d",ioke:"#078193",isabelle:"#FEFE00",j:"#9EEDFF",jflex:"#DBCA00",jsoniq:"#40d47e",java:"#b07219",javascript:"#f1e05a",jinja:"#a52a22",jolie:"#843179",jsonnet:"#0064bd",julia:"#a270ba","jupyter-notebook":"#DA5B0B",krl:"#28430A","kaitai-struct":"#773b37",kotlin:"#A97BFF",lfe:"#4C3023",llvm:"#185619",lolcode:"#cc9900",lsl:"#3d9970",lark:"#2980B9",lasso:"#999999",latte:"#f2a542",less:"#1d365d",lex:"#DBCA00",lilypond:"#9ccc7c",liquid:"#67b8de",livescript:"#499886",lookml:"#652B81",lua:"#000080",matlab:"#e16737",maxscript:"#00a6a6",mlir:"#5EC8DB",mql4:"#62A8D6",mql5:"#4A76B8",mtml:"#b7e1f4",macaulay2:"#d8ffff",makefile:"#427819",markdown:"#083fa1",marko:"#42bff2",mask:"#f97732",max:"#c4a79c",mercury:"#ff2b2b",meson:"#007800",metal:"#8f14e9",mirah:"#c7a938","modula-3":"#223388",mustache:"#724b3b",ncl:"#28431f",nwscript:"#111522",nearley:"#990000",nemerle:"#3d3c6e",netlinx:"#0aa0ff",netlinxperb:"#747faa",netlogo:"#ff6375",newlisp:"#87AED7",nextflow:"#3ac486",nim:"#ffc200",nit:"#009917",nix:"#7e7eff",nu:"#c9df40",numpy:"#9C8AF9",nunjucks:"#3d8137",ocaml:"#3be133",objectscript:"#424893","objective-c":"#438eff","objective-cpp":"#6866fb","objective-j":"#ff0c5a",odin:"#60AFFE",omgrofl:"#cabbff",opal:"#f7ede0",openqasm:"#AA70FF",org:"#77aa99",oxygene:"#cdd0e3",oz:"#fab738",p4:"#7055b5",pegdotjs:"#234d6b",php:"#4F5D95",plsql:"#dad8d8",pan:"#cc0000",papyrus:"#6600cc",parrot:"#f3ca0a",pascal:"#E3F171",pawn:"#dbb284",pep8:"#C76F5B",perl:"#0298c3",piglatin:"#fcd7de",pike:"#005390",pogoscript:"#d80074",postscript:"#da291c",powerbuilder:"#8f0f8d",powershell:"#012456",prisma:"#0c344b",processing:"#0096D8",prolog:"#74283c","propeller-spin":"#7fa2a7",pug:"#a86454",puppet:"#302B6D",purebasic:"#5a6986",purescript:"#1D222D",python:"#3572A5",qsharp:"#fed659",qml:"#44a51c","qt-script":"#00b841",quake:"#882233",r:"#198CE7",raml:"#77d9fb",runoff:"#665a4e",racket:"#3c5caa",ragel:"#9d5200",raku:"#0000fb",rascal:"#fffaa0",rescript:"#ed5051",reason:"#ff5847",rebol:"#358a5b","record-jar":"#0673ba",red:"#f50000","regular-expression":"#009a00",renpy:"#ff7f7f",ring:"#2D54CB",riot:"#A71E49",roff:"#ecdebe",rouge:"#cc0088",ruby:"#701516",rust:"#dea584",sas:"#B34936",scss:"#c6538c",sqf:"#3F3F3F","srecode-template":"#348a34",svg:"#ff9900",saltstack:"#646464",sass:"#a53b70",scala:"#c22d40",scaml:"#bd181a",scheme:"#1e4aec",self:"#0579aa",shell:"#89e051",shen:"#120F14",singularity:"#64E6AD",slash:"#007eff",slice:"#003fa2",slim:"#2b2b2b",smpl:"#c94949",smalltalk:"#596706",solidity:"#AA6746",sourcepawn:"#f69e1d",squirrel:"#800000",stan:"#b2011d","standard-ml":"#dc566d",starlark:"#76d275",stringtemplate:"#3fb34f",stylus:"#ff6347",supercollider:"#46390b",svelte:"#ff3e00",swift:"#ffac45",systemverilog:"#DAE1C2","ti-program":"#A0AA87",tcl:"#e4cc98",tex:"#3D6117",terra:"#00004c","textmate-properties":"#df66e4",turing:"#cf142b",twig:"#c1d026",typescript:"#2b7489","unified-parallel-c":"#4e3617",uno:"#9933cc",unrealscript:"#a54c4d",v:"#4f87c4",vba:"#867db1",vbscript:"#15dcdc",vcl:"#148AA8",vhdl:"#adb2cb",vala:"#fbe5cd","valve-data-format":"#f26025",verilog:"#b2b7f8","vim-script":"#199f4b","visual-basic-dotnet":"#945db7",volt:"#1F1F1F",vue:"#41b883",webassembly:"#04133b",wollok:"#a23738",x10:"#4B6BEF",xc:"#99DA07",xquery:"#5232e7",xslt:"#EB8CEB",xonsh:"#285EEF",yaml:"#cb171e",yml:"#cb171e",yara:"#220000",yasnippet:"#32AB90",yacc:"#4B6C4B",zap:"#0d665e",zil:"#dc75e5",zenscript:"#00BCD1",zephir:"#118f9e",zig:"#ec915c",ec:"#913960",jq:"#c7254e","mirc-script":"#3d57c3",mcfunction:"#E22837",nesc:"#94B0C7",ooc:"#b0b77e",q:"#0040cd",sed:"#64b970",wdl:"#42f1f4",wisp:"#7582D1",xml:"#0060ac",mermaid:"#ececff"};oe([he,ze,ls,ne,cs]);const aa=y({props:{codeFrequency:{type:Array,required:!0}},data(){return{chart:null}},computed:{isDark(){return this.$store.state.isDarkMode}},watch:{codeFrequency(){this.updateChart()},isDark(){this.updateChart()}},methods:{updateChart(){const e={tooltip:{trigger:"item",backgroundColor:this.isDark?"#666":"#fff",textStyle:{color:this.isDark?"#bbb":""}},legend:{top:"5%",left:"center",textStyle:{color:this.isDark?"#bbb":"#666"},itemStyle:{borderColor:this.isDark?"#bbb":""}},height:500,series:[{name:"代码频率",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"40",fontWeight:"bold"}},labelLine:{show:!1},data:this.codeFrequency.map(t=>({name:t.lang,value:t.frequency,itemStyle:{color:zt[t.lang]?zt[t.lang]:"#ccc",borderColor:this.isDark?"#323233":"#fff"}})).splice(0,10)}]};e&&this.chart.setOption(e)}},setup(){},mounted(){const e=document.getElementById("codeFrequencyChart");this.chart||(this.chart=te(e)),this.updateChart()}}),ia={class:"frequency-wrapper"};function la(e,t,o,n,s,a){return h(),g("div",ia,[...t[0]||(t[0]=[p("div",{id:"codeFrequencyChart"},null,-1)])])}const Ao=b(aa,[["render",la],["__scopeId","data-v-c7699847"]]);class Xe{name="";link="";size=0;chidren=[];static childrenSize(t){if(t.chidren.length==0)return t.size;let o=t.size;for(const n of t.chidren)o+=this.childrenSize(n);return o}}oe([Se,ze,ds,ne]);const ca=y({data(){return{origin:[],current:[],chart:null}},computed:{showBack(){return this.origin.length<1||this.current.length<1?!1:this.current[0].link!=this.origin[0].link}},watch:{current(){this.init()}},methods:{async getData(){this.origin=await P.getKnowledgeRichness()},back(e,t){t||(t=this.origin);for(let o of t){for(let n of o.chidren)n.link==this.current[0].link&&(this.current=t);this.back(null,o.chidren)}},async prepareCurrentData(e){if(!e){this.current=this.origin;return}for(let t of this.current)if(t.name==e){if(t.chidren.length==0){Z.warning("没有更多了");return}this.current=t.chidren;return}this.current=[]},async init(){const e=this.current.map(n=>Xe.childrenSize(n)).sort((n,s)=>s-n)[0],t=this.current.map(n=>Xe.childrenSize(n)).reduce((n,s)=>n+s,0);if(!this.chart){const n=this.$refs.container;this.chart=te(n),this.chart.on("click",s=>{this.prepareCurrentData(s.name),this.init()})}var o;o={title:{},legend:{data:["知识丰富度"]},radar:{indicator:this.current.map(n=>({name:n.name,max:Math.min(t,e)})),triggerEvent:!0},series:[{name:"知识丰富度",type:"radar",data:[{value:this.current.map(n=>Xe.childrenSize(n)),name:"知识丰富度"}]}]},this.chart.setOption(o)}},async mounted(){await this.getData(),this.prepareCurrentData()}}),da={style:{"text-align":"center"}},ua={ref:"container",class:"container"};function ha(e,t,o,n,s,a){const r=z;return h(),g("div",da,[p("div",ua,null,512),ae(i(r,{onClick:e.back,class:"back-btn"},{default:d(()=>[...t[0]||(t[0]=[_("返回",-1)])]),_:1},8,["onClick"]),[[ce,e.showBack]])])}const Fo=b(ca,[["render",ha],["__scopeId","data-v-456081f5"]]),pa=y({components:{Coin:Gt,Check:xt,Document:Yt,Notebook:Xt,PictureFilled:Zt,Aim:Ie,Clock:et,Calendar:tt,HeatMap:Eo,WordCloud:Po,CodeFrequency:Ao,KnowledgeRadar:Fo},data(){return{info:new Yr,codeFrequency:[]}},methods:{repositoryPercentage(){return Math.ceil(this.info.repositorySize/(1024*1024*1024)*100)},repositorySizeReadable(){return Math.ceil(this.info.repositorySize/(1024*1024))},calcCodeFrequency(){const e=this.info.codeFrequency.map(t=>t.frequency).reduce((t,o)=>t+o,0);return this.info.codeFrequency.map(t=>({lang:t.lang,frequency:Math.ceil(t.frequency/e*100)})).splice(0,10)}},async created(){this.info=await P.getStatisticInfo(),this.codeFrequency=this.calcCodeFrequency()}}),ma=y({...pa,__name:"Statistic",setup(e){return(t,o)=>{const n=x,s=In,a=Tn;return h(),g("div",{class:ee({"statistic-wrapper":!t.$isMobile(),"mobile-statistic-wrapper":t.$isMobile()})},[i(a,{class:"margin-top",title:"统计",column:t.$isMobile()?1:12,border:""},{default:d(()=>[i(s,null,{label:d(()=>[i(n,null,{default:d(()=>[i(T(Gt))]),_:1}),o[0]||(o[0]=_(" 仓库尺寸 ",-1))]),default:d(()=>[_(" "+C(t.repositorySizeReadable())+" MB ",1)]),_:1}),i(s,{span:3},{label:d(()=>[i(n,null,{default:d(()=>[i(T(xt))]),_:1}),o[1]||(o[1]=_(" 提交统计 ",-1))]),default:d(()=>[_(" "+C(t.info.commit.commitPerDay)+"次/天, "+C(t.info.commit.linePerDay.toLocaleString("en-US"))+"行/天 ",1)]),_:1}),i(s,{span:3},{label:d(()=>[i(n,null,{default:d(()=>[i(T(Yt))]),_:1}),o[2]||(o[2]=_(" 字数统计 ",-1))]),default:d(()=>[_(" "+C(t.info.word.total.toLocaleString("en-US"))+"字, "+C(t.info.word.wordPerDay.toLocaleString("en-US"))+"字/天 ",1)]),_:1}),i(s,null,{label:d(()=>[i(n,null,{default:d(()=>[i(T(Xt))]),_:1}),o[3]||(o[3]=_(" 章节数 ",-1))]),default:d(()=>[_(" "+C(t.info.chapterCount),1)]),_:1}),i(s,null,{label:d(()=>[i(n,null,{default:d(()=>[i(T(Zt))]),_:1}),o[4]||(o[4]=_(" 图片数 ",-1))]),default:d(()=>[_(" "+C(t.info.imageCount),1)]),_:1}),i(s,null,{label:d(()=>[i(n,null,{default:d(()=>[i(T(et))]),_:1}),o[5]||(o[5]=_(" 首次提交 ",-1))]),default:d(()=>[_(" "+C(new Date(t.info.firstCommitDate).toLocaleString()),1)]),_:1}),i(s,null,{label:d(()=>[i(n,null,{default:d(()=>[i(T(et))]),_:1}),o[6]||(o[6]=_(" 最后更新 ",-1))]),default:d(()=>[_(" "+C(new Date(t.info.generateTime).toLocaleString()),1)]),_:1}),(h(),g(D,null,I(1,r=>i(s,{span:1,key:r})),64)),i(s,{span:12},{label:d(()=>[i(n,null,{default:d(()=>[i(T(Ie))]),_:1}),o[7]||(o[7]=_(" 代码统计 ",-1))]),default:d(()=>[i(Ao,{codeFrequency:t.info.codeFrequency},null,8,["codeFrequency"])]),_:1}),i(s,{span:12},{label:d(()=>[i(n,null,{default:d(()=>[i(T(tt))]),_:1}),o[8]||(o[8]=_(" 提交分布 ",-1))]),default:d(()=>[i(Eo),i(Vr),i(Jr)]),_:1}),i(s,{span:12},{label:d(()=>[i(n,null,{default:d(()=>[i(T(Ie))]),_:1}),o[9]||(o[9]=_(" 知识雷达 ",-1))]),default:d(()=>[i(Fo)]),_:1}),i(s,{span:12},{label:d(()=>[i(n,null,{default:d(()=>[i(T(tt))]),_:1}),o[10]||(o[10]=_(" 词云统计 ",-1))]),default:d(()=>[i(Po)]),_:1})]),_:1},8,["column"])],2)}}}),Oo=b(ma,[["__scopeId","data-v-527ada83"]]),fa=y({setup(){},data(){return{name:G.siteName}},methods:{handleContinueRead(){const e=k.getLastReadRecord();e?this.$router.push("/doc/"+e):this.$router.push("/doc/README")}}}),ga={class:"container"},wa={class:"banner"};function ya(e,t,o,n,s,a){const r=z;return h(),g("div",ga,[p("div",wa,[p("p",null,C(e.name),1),t[3]||(t[3]=p("p",null,"点击以开始",-1)),i(r,{type:"primary",round:"",size:"medium",onClick:t[0]||(t[0]=l=>e.$router.push("/doc/README"))},{default:d(()=>[...t[1]||(t[1]=[_("开始",-1)])]),_:1}),i(r,{type:"success",round:"",size:"medium",onClick:e.handleContinueRead},{default:d(()=>[...t[2]||(t[2]=[_("继续阅读",-1)])]),_:1},8,["onClick"])])])}const zo=b(fa,[["render",ya],["__scopeId","data-v-46c079b4"]]),_a=y({components:{Statistic:Oo,Banner:zo},setup(){}});function ka(e,t,o,n,s,a){const r=S("banner"),l=S("statistic");return h(),g(D,null,[i(r),(h(),v(le,null,[i(l)],1024))],64)}const $a=b(_a,[["render",ka]]),va=Object.freeze(Object.defineProperty({__proto__:null,default:$a},Symbol.toStringTag,{value:"Module"})),ba=y({data(){return{showImageViewer:!1,imageUrlList:[],imgIndex:0}},methods:{show(e,t){t<0||t>e.length||(this.imgIndex=t,this.imageUrlList=[...e],this.showImageViewer=!0,document.body.classList.add("image-viewer-stop-scroll"))},close(){this.showImageViewer=!1,document.body.classList.remove("image-viewer-stop-scroll")}}});function Ca(e,t,o,n,s,a){const r=En;return e.showImageViewer?(h(),v(r,{key:0,onClose:e.close,"initial-index":e.imgIndex,"url-list":e.imageUrlList,"hide-on-click-modal":!0,infinite:!1},null,8,["onClose","initial-index","url-list"])):O("",!0)}const Uo=b(ba,[["render",Ca]]),Sa=y({props:{contentsList:{type:Array,required:!0}},emits:["item-click"],methods:{handleTocItemClick(e){this.$emit("item-click",e)}},setup(){}}),Da=["href","onClick","title"],La={key:0,class:"toc-sublist"};function Ma(e,t,o,n,s,a){const r=S("contents-tree",!0);return h(),v(Ht,{name:"list"},{default:d(()=>[(h(!0),g(D,null,I(e.contentsList,l=>(h(),g("li",{key:l.link,class:"toc-item"},[p("a",{href:"#"+l.link,onClick:de(c=>e.handleTocItemClick(l.link),["prevent"]),title:l.name,class:"toc-link"},C(l.name),9,Da),l.chidren.length!=0?(h(),g("ul",La,[i(r,{contentsList:l.chidren,onItemClick:e.handleTocItemClick},null,8,["contentsList","onItemClick"])])):O("",!0)]))),128))]),_:1})}const Ia=b(Sa,[["render",Ma],["__scopeId","data-v-fc910d01"]]);function Ta(e){const t=document.querySelectorAll(".main.markdown-section h1, .main.markdown-section h2, .main.markdown-section h3, .main.markdown-section h4, .main.markdown-section h5, .main.markdown-section h6");let o=null;if(window.scrollY==0)o=t[0];else for(let n=0;n<t.length;n++){const s=t[n];s instanceof HTMLElement&&window.scrollY>s.offsetTop-160&&(o=s)}if(o!=null){const n=document.querySelector(".toc .active");n!==null&&n.classList.remove("active");const s=o.id.replace(/<mark>/gi,"").replace(/<\/mark>/gi,"");document.querySelector(`.toc a[href='#${s}']`)?.classList.add("active"),e.$store.commit("setCurrentHeading",s)}}function Ut(e){const t=document.querySelector(".toc"),o=document.querySelector(".toc .active");if(o&&t){const n=t.scrollTop,s=t.scrollTop+t.offsetHeight,a=o.offsetTop;a>s&&t.scrollTo(0,a/2),a<n&&t.scrollTo(0,a/2-n)}}const Ea=y({props:{doc:{type:String,required:!0},withEvent:{type:Boolean,default:!0}},emits:["item-click"],components:{ContentsTree:Ia},data(){return{contentList:[],currentId:""}},watch:{doc:{immediate:!0,async handler(){this.doc&&(this.contentList=await k.getContentByDocId(this.doc),this.$nextTick(()=>{this.currentId&&this.hilight(this.currentId)}))}}},methods:{registerWindowScrollListener(){let e=new Date().getTime();document.addEventListener("scroll",t=>{new Date().getTime()<e+50||(Ta(this),Ut(),e=new Date().getTime())})},handleTocItemClick(e){this.$emit("item-click",e)},hilight(e){this.currentId=e;const t=this.$refs.toc,o=t.querySelector(".toc .active");o!==null&&o.classList.remove("active"),t.querySelector(`.toc a[href='#${e}']`)?.classList.add("active"),Ut()}},created(){this.withEvent&&this.registerWindowScrollListener()},unmounted(){document.onscroll=null}}),Pa={class:"toc-container"},Aa={class:"toc",ref:"toc"};function Fa(e,t,o,n,s,a){const r=S("contents-tree");return h(),g("div",Pa,[t[0]||(t[0]=p("div",{class:"toc-header"},[p("h3",{class:"toc-title"},"文档目录")],-1)),p("ul",Aa,[i(r,{contentsList:e.contentList,onItemClick:e.handleTocItemClick},null,8,["contentsList","onItemClick"])],512)])}const Oa=b(Ea,[["render",Fa],["__scopeId","data-v-3dc00106"]]),za=y({props:{file:{type:Object,required:!0},doc:{type:String,required:!0}},setup(){},methods:{docId2Url:E.docId2Url},data(){return{config:G}}}),Ua={class:"block"},Ra={class:"history-message"},qa=["href"],Ba={class:"history-message"},Ha=["href"];function ja(e,t,o,n,s,a){const r=eo,l=to;return h(),g("div",Ua,[t[0]||(t[0]=p("p",{style:{"text-align":"left"}},"更新历史",-1)),i(l,null,{default:d(()=>[(h(!0),g(D,null,I(e.file.commitList,(c,u)=>(h(),v(r,{key:u,timestamp:new Date(c.date).toLocaleString()},{default:d(()=>[p("p",Ra,[p("a",{href:e.config.repositoryUrl+"/commit/"+c.hash,target:"_blank"},C(c.message),9,qa)])]),_:2},1032,["timestamp"]))),128)),e.file.hasMoreCommit?(h(),v(r,{key:0},{default:d(()=>[p("p",Ba,[p("a",{target:"_blank",href:e.config.repositoryUrl+"/tree/master/doc/"+e.docId2Url(e.doc),class:"all"},"全部历史("+C(e.file.totalCommits)+"条)",9,Ha)])]),_:1})):O("",!0)]),_:1})])}const Va=b(za,[["render",ja],["__scopeId","data-v-cfea861c"]]),Na=y({components:{FullScreen:ot},props:{id:{type:String,required:!0},mindData:{type:Object,required:!0}},emits:["onFullScreen"],data(){return{jm:null}},computed:{Minus(){return An},Plus(){return Pn},FullScreen(){return ot}},watch:{mindData(e){this.init()}},methods:{mousewheel(e){e.preventDefault(),e.wheelDelta<0||e.detail<0?this.jm.view.zoomOut():(e.wheelDelta>0||e.detail>0)&&this.jm.view.zoomIn()},zoomIn(){this.jm.view.zoomIn()},zoomOut(){this.jm.view.zoomOut()},reigseterMindClickEvent(){document.getElementById(this.id)?.addEventListener("click",e=>{const o=e.target.getAttribute("nodeid");if(o){const n=document.getElementById(o);window.scrollTo(0,n.offsetTop-80)}})},select(e){if(!this.jm)throw new Error("思维导图还未初始化");this.jm.select_node([e])},init(){if(!this.mindData)throw new Error("思维导图数据不能为空!");const e={meta:{name:"思维导图",author:"ISMY",version:"0.01"},format:"node_tree",data:this.mindData},t={container:this.id,theme:"clean",editable:!1,mode:"full",view:{draggable:!0,engine:"svg",hmargin:100,vmargin:100,line_width:2,line_color:"#409eff"},layout:{hspace:30,vspace:20,pspace:10},shortcut:{enable:!0,handles:{},mapping:{add_node:45,edit_node:113,del_node:46,toggle:32,left:37,up:38,right:39,down:40}}};this.jm||(this.jm=new es(t),document.getElementById(this.id)?.addEventListener("mousewheel",this.mousewheel),this.reigseterMindClickEvent()),this.jm.show(e)}}}),Ka=["id"];function Qa(e,t,o,n,s,a){const r=z,l=Wt;return h(),g(D,null,[i(l,{class:"control-group"},{default:d(()=>[i(r,{size:"small",onClick:e.zoomOut,icon:e.Minus,circle:"",title:"缩小"},null,8,["onClick","icon"]),i(r,{size:"small",onClick:e.zoomIn,icon:e.Plus,circle:"",title:"放大"},null,8,["onClick","icon"]),i(r,{size:"small",onClick:t[0]||(t[0]=c=>e.$emit("onFullScreen")),icon:e.FullScreen,circle:"",title:"全屏"},null,8,["icon"])]),_:1}),p("div",{id:e.id,class:"mind-container"},null,8,Ka)],64)}const Ne=b(Na,[["render",Qa],["__scopeId","data-v-0343d48a"]]),Wa=y({components:{Mind:Ne,CloseBold:Ce},setup(){},data(){return{showDrawer:!1,mindData:null}},computed:{currentHeading(){return this.$store.state.currentHeading}},watch:{currentHeading(e){this.$nextTick(()=>{this.$refs.mind&&this.$refs.mind.select(e)})},$route(e,t){this.showDrawer&&this.showMind()}},methods:{show(){this.showDrawer=!0,this.showMind()},hide(){this.showDrawer=!1},async showMind(){const e=this.$route.params.doc.toString(),t=await k.getContentByDocId(e),o=Te.mindConvert(t);this.mindData=o[0],this.$nextTick(()=>{this.$refs.mind.init();const n=this.$store.state.currentHeading;n&&this.$refs.mind.select(n)})}}});function Ja(e,t,o,n,s,a){const r=S("close-bold"),l=x,c=z,u=Ne,m=J;return h(),v(m,{modelValue:e.showDrawer,"onUpdate:modelValue":t[1]||(t[1]=f=>e.showDrawer=f),size:"44%",direction:e.$isMobile()?"btt":"rtl","with-header":!1,title:"思维导图","lock-scroll":!1,"append-to-body":!1,modal:!1,onClose:t[2]||(t[2]=f=>e.$emit("close")),"modal-class":"operational-drawer-modal",class:"operational-drawer"},{default:d(()=>[i(c,{text:"",class:"close-btn",onClick:t[0]||(t[0]=f=>e.showDrawer=!1)},{default:d(()=>[i(l,null,{default:d(()=>[i(r)]),_:1})]),_:1}),i(u,{ref:"mind",id:"mindGraphMind","mind-data":e.mindData},null,8,["mind-data"])]),_:1},8,["modelValue","direction"])}const Ro=b(Wa,[["render",Ja],["__scopeId","data-v-2b4bf422"]]),Ga={id:"",topic:"",children:[],expanded:!1,direction:"left"},xa=y({components:{Mind:Ne},data(){return{mindData:Ga,fullScreen:!1}},computed:{currentCategory(){return this.$store.state.currentCategory},currentHeading(){return this.$store.state.currentHeading}},watch:{currentCategory(){this.refresh(E.docUrl2Id(this.currentCategory.link))},currentHeading(e){this.$nextTick(()=>{this.$refs.mind&&this.$refs.mind.select(e)})}},methods:{async refresh(e){const t=e||this.$route.params.doc.toString();this.mindData=await k.generateMindData(t);for(let o=0;o<3;o++)this.$nextTick(()=>{this.$refs.mind&&this.$refs.mind.zoomOut()})},test(){}},async mounted(){this.refresh()}});function Ya(e,t,o,n,s,a){const r=Ne;return h(),g("div",{class:ee(["mind-note",{"full-screen":e.fullScreen}])},[i(r,{ref:"mind",id:"mindNoteMind","mind-data":e.mindData,onOnFullScreen:t[0]||(t[0]=l=>e.fullScreen=!e.fullScreen)},null,8,["mind-data"])],2)}const Xa=b(xa,[["render",Ya],["__scopeId","data-v-9b2274ef"]]),Za=y({props:{html:{type:String,required:!0}},setup(){},data(){return{showDrawer:!1,linkList:[],effecientMap:{}}},methods:{show(){this.showDrawer=!0,this.linkList=k.resolveLinkList(this.html).filter(e=>e.link.startsWith("/#/doc")),this.linkList.forEach(async e=>{try{await k.getDocFileInfo(e.link.replace("/#/doc/","")),this.effecientMap[e.link]=!0}catch{this.effecientMap[e.link]=!1}})}}}),ei=["title"];function ti(e,t,o,n,s,a){const r=ue,l=J;return h(),v(l,{modelValue:e.showDrawer,"onUpdate:modelValue":t[0]||(t[0]=c=>e.showDrawer=c),size:"20%",title:"链接列表"},{default:d(()=>[p("ul",null,[(h(!0),g(D,null,I(e.linkList,c=>(h(),g("li",{key:c.link,title:c.link},[i(r,{type:"primary",disabled:!e.effecientMap[c.link],onClick:de(u=>{e.$router.push(c.link.replace("/#","")),e.showDrawer=!1},["prevent"])},{default:d(()=>[_(C(c.text),1)]),_:2},1032,["disabled","onClick"])],8,ei))),128))])]),_:1},8,["modelValue"])}const oi=b(Za,[["render",ti],["__scopeId","data-v-1b47345f"]]);function ni(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}const si=y({inject:["showHeader"],watch:{showHeader:{handler(e){this.parentShowHeader=e},immediate:!0}},emits:["showReadingHistory","showMindGraph","showKnowledgeNetwork","copyDocPath","showLinkList","goToDoc","goToPpt","showKnowledgeReviewer","openInEditor","showLlm"],data(){return{showDrawer:!1,fontSize:16,parentShowHeader:!0,flatCategoryList:[],actionList:[{name:"思维导图",type:"success",action:"showMindGraph",hotkey:"alt + l"},{name:"知识网络",type:"warning",action:"showKnowledgeNetwork",hotkey:"alt + k"},{name:"知识回顾",type:"primary",action:"showKnowledgeReviewer",hotkey:"alt + r"},{name:"知识助手",type:"warning",action:"showLlm",hotkey:"alt + i"},{name:"路径复制",type:"success",action:"copyDocPath",hotkey:"alt + c",divided:!0},{name:"在VSC打开",type:"danger",action:"openInEditor",hotkey:"alt + v"},{name:"链接列表",type:"primary",action:"showLinkList"},{name:"随机复习",type:"primary",action:"randomReview",local:!0,hotkey:"alt + n"},{name:"更多设置",type:"info",action:"showMoreSetting",local:!0,divided:!0}]}},methods:{localActionDispatch(e){switch(e){case"showMoreSetting":this.showDrawer=!0;break;case"randomReview":this.handleRandomReview();break}},handleRandomReview(){const e=this.flatCategoryList[ni(0,this.flatCategoryList.length-1)];this.$router.push("/doc/"+E.docUrl2Id(e.link))},handleKeyDown(e){const t=this.actionList.filter(o=>o.hotkey);for(let o of t){const n=o.hotkey.split("+")[0].trim(),s=o.hotkey.split("+")[1].trim();let a=!1;n=="alt"&&(a=e.altKey),n=="ctrl"&&(a=e.ctrlKey),n=="shift"&&(a=e.shiftKey);const r=e.key.toLowerCase(),l=e.code.toLowerCase().replace("key","");if(a&&[r,l].some(c=>c==s.toLowerCase()))return o.local?this.localActionDispatch(o.action):this.$emit(o.action),e.preventDefault()}},handleFontSizeChange(e){const t=document.querySelector(".main.markdown-section");t.style.fontSize=e+"px"}},setup(){return{Tools:oo}},async created(){document.addEventListener("keydown",this.handleKeyDown),this.flatCategoryList=await re.getFlatCategoryList()},unmounted(){document.removeEventListener("keydown",this.handleKeyDown)}}),ri={key:0,class:"hotkey"},ai={class:"more-setting-container"},ii={class:"setting-item"},li={class:"setting-value"};function ci(e,t,o,n,s,a){const r=z,l=so,c=no,u=ro,m=ht,f=J;return h(),g(D,null,[p("div",{class:"tool-box",style:we({top:e.parentShowHeader?"66px":"6px"})},[i(u,{trigger:"click",placement:"bottom-end"},{dropdown:d(()=>[i(c,{class:"dropdown-menu"},{default:d(()=>[(h(!0),g(D,null,I(e.actionList,w=>(h(),v(l,{key:w.name,divided:w.divided||!1,class:"dropdown-item"},{default:d(()=>[i(r,{class:"action-btn",onClick:L=>w.local?e.localActionDispatch(w.action):e.$emit(w.action),type:w.type,size:"default"},{default:d(()=>[_(C(w.name)+" ",1),w.hotkey?(h(),g("span",ri,C(w.hotkey),1)):O("",!0)]),_:2},1032,["onClick","type"])]),_:2},1032,["divided"]))),128))]),_:1})]),default:d(()=>[i(r,{type:"default",size:"small",class:"tool-button",icon:e.Tools,circle:"",title:"工具栏"},null,8,["icon"])]),_:1})],4),i(f,{modelValue:e.showDrawer,"onUpdate:modelValue":t[1]||(t[1]=w=>e.showDrawer=w),title:"更多设置","lock-scroll":!1,size:"300px",class:"setting-drawer"},{default:d(()=>[p("div",ai,[p("div",ii,[t[2]||(t[2]=p("span",{class:"setting-label"},"字体大小",-1)),i(m,{modelValue:e.fontSize,"onUpdate:modelValue":t[0]||(t[0]=w=>e.fontSize=w),min:14,max:24,step:1,onInput:e.handleFontSizeChange,class:"setting-slider"},null,8,["modelValue","onInput"]),p("span",li,C(e.fontSize)+"px",1)])])]),_:1},8,["modelValue"])],64)}const di=b(si,[["render",ci],["__scopeId","data-v-782a2cb3"]]);oe([Se,he,us,ne,ze]);function Rt(e){return e<=20?"#84c0ff":e>20&&e<=40?"#409eff":"#1D8CFF"}function qt(e){return k.buildSummaryDocInfo(e)}const ui=y({components:{CloseBold:Ce},props:{doc:{type:String,required:!0}},data(){return{showDrawer:!1,chart:null,mode:"force",displayMode:["force","circular"],onlySelfRelated:!0,isPotential:!1,degree:3}},watch:{mode(){this.init(!1)},onlySelfRelated(){this.onlySelfRelated?this.mode="circular":this.mode="force",this.init()},displayMode(){this.init()},degree(){this.init()}},computed:{isDark(){return this.$store.state.isDarkMode}},setup(){},methods:{show(){this.showDrawer=!0,this.$nextTick(()=>{this.init()})},async init(e=!0){const t=(await $o.getDocStream(this.doc)).flatMap(l=>l);if(!this.showDrawer)return;this.isPotential&&e&&(this.mode="circular");let o=this.isPotential?await P.getPotentialKnowledgeNetwork():await P.getKnowledgeNetwork();if(this.onlySelfRelated)if(this.isPotential)o=o.filter(l=>l.id==this.doc||l.links?.find(c=>c.id==this.doc)).map(l=>(l.id!=this.doc&&(l.links=l.links?.filter(c=>c.id==this.doc)),l));else{const l=o.filter(c=>c.id==this.doc||c.links?.find(u=>this.doc==u.id));for(let c=0;c<this.degree;c++){const u=o.filter(m=>l.some(f=>f.id==m.id)||m.links?.find(f=>l.some(w=>w.id==f.id)));l.push(...u),l.push(...u.flatMap(m=>m.links||[]).filter(m=>l.some(f=>f.id==m.id)))}o=l}let n=Array.from(new Set(o.flatMap(l=>[l.id,...l.links?.map(c=>c.id)||[]]))).map(l=>{const c=o.filter(u=>u.id==l);return c.length==0?{name:l,category:l==this.doc?1:t.some(u=>l==u)?2:0,symbolSize:20,draggable:!0,itemStyle:{color:l==this.doc?"#F56C6C":t.some(u=>l==u)?"#95d475":Rt(20)}}:{name:l,category:l==this.doc?1:t.some(u=>l==u)?2:0,symbolSize:20*(1+(c[0].links?.length||0)/3),draggable:!0,itemStyle:{color:l==this.doc?"#F56C6C":t.some(u=>l==u)?"#95d475":Rt(20*(1+(c[0].links?.length||0)/3))}}});const s=new Map(n.map((l,c)=>[l.name,c])),a=[];for(let l of o)if(l.links)for(let c of l.links)a.push({target:l.id,source:c.id,value:decodeURI(c.headingId?"#"+c.headingId:"-")});if(!this.chart){const l=document.getElementById("knowledgeNetwork");this.chart=te(l),this.chart.on("click",c=>{console.log(c);const u=c.data.name||c.data.target,m=c.data.value?.replace("#","");!m||m==""?this.$router.push("/doc/"+u).then(f=>this.init()):this.$router.push({path:"/doc/"+u,query:{headingId:m=="-"?"":m}}).then(f=>this.init())})}const r={title:{text:"知识网络",top:"bottom",left:"right"},darkMode:this.isDark,tooltip:{backgroundColor:this.isDark?"var(--main-dark-bg-color)":"#fff",textStyle:{color:this.isDark?"var(--main-dark-text-color)":""},formatter(l,c,u){const m=l.data.name;if(!m)return`${l.data.source}->${l.data.target} ${l.data.value}`;if(!m)return"none";const f=k.getDocFileInfo(m);if(f instanceof Promise)f.then(w=>{u(c,qt(w))}).catch(w=>{u(c,`${w}`)});else return qt(f);return"loading"}},animationDurationUpdate:1500,animationEasingUpdate:"quinticInOut",label:{normal:{show:!0,textStyle:{fontSize:12}}},legend:{x:"center",show:!0,data:["联系","当前","上下游"],textStyle:{color:this.isDark?"#eee":"#555"}},series:[{type:"graph",layout:this.mode,symbolSize:45,focusNodeAdjacency:!0,roam:!0,categories:[{name:"联系",itemStyle:{color:"#409EFF",opacity:this.isDark?.9:1}},{name:"当前",itemStyle:{color:"#F56C6C",opacity:this.isDark?.9:1}},{name:"上下游",itemStyle:{color:"#95d475",opacity:this.isDark?.9:1}}],label:{show:!0,position:"top",fontSize:14,color:this.isDark?"#eee":"#555",textBorderWidth:1,formatter(l){const c=l.data.name,u=c.split("-");return[`{title|${u[u.length-1]}}`,`{category|『${c.replaceAll(/-/g,"/")}』}`].join(`
`)},rich:{title:{align:"center",fontSize:"15px",color:this.isDark?"#eee":"#4C4C49"},category:{align:"center",color:"#46adff",textBorderColor:this.isDark?"":"#fff"}}},force:{repulsion:[s.size*4,s.size*6],gravity:s.size/800,edgeLength:[s.size*1.2,s.size*2]},edgeSymbolSize:6,edgeSymbol:["arrow"],edgeLabel:{show:!1,fontSize:10,formatter:"{c}"},data:n,links:a,lineStyle:{opacity:.9,curveness:0,width:2,color:"#38B3FF"},emphasis:{focus:"adjacency",lineStyle:{width:10}}}]};this.chart.setOption(r)}}}),hi={class:"tool-zone"};function pi(e,t,o,n,s,a){const r=S("close-bold"),l=x,c=z,u=ao,m=ut,f=Fn,w=Nt,L=pt,$=J;return h(),v($,{modelValue:e.showDrawer,"onUpdate:modelValue":t[5]||(t[5]=M=>e.showDrawer=M),size:e.$isMobile()?"50%":"44%",direction:e.$isMobile()?"btt":"rtl","with-header":!1,modal:!1,title:"知识网络",onClose:t[6]||(t[6]=M=>e.$emit("close")),"lock-scroll":!1,"modal-class":"operational-drawer-modal",class:"operational-drawer"},{default:d(()=>[p("div",hi,[p("div",null,[i(c,{text:"",class:"close-btn",onClick:t[0]||(t[0]=M=>e.showDrawer=!1)},{default:d(()=>[i(l,null,{default:d(()=>[i(r)]),_:1})]),_:1})]),p("div",null,[i(m,{modelValue:e.mode,"onUpdate:modelValue":t[1]||(t[1]=M=>e.mode=M),placeholder:"显示模式",size:"small","popper-class":"popper-list"},{default:d(()=>[(h(!0),g(D,null,I(e.displayMode,M=>(h(),v(u,{key:M,label:M,value:M},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),p("div",null,[i(f,{modelValue:e.onlySelfRelated,"onUpdate:modelValue":t[2]||(t[2]=M=>e.onlySelfRelated=M),label:"只看跟本节点关联的",size:"large"},null,8,["modelValue"])]),p("div",null,[i(w,{modelValue:e.isPotential,"onUpdate:modelValue":t[3]||(t[3]=M=>e.isPotential=M),"active-color":"#409EFF","inactive-color":"#409EFF","inactive-text":"显式知识网络","active-text":"隐式知识网络",onChange:e.init},null,8,["modelValue","onChange"])]),p("div",null,[t[7]||(t[7]=_(" 度数: ",-1)),i(L,{type:"number",size:"small",modelValue:e.degree,"onUpdate:modelValue":t[4]||(t[4]=M=>e.degree=M),disabled:!e.onlySelfRelated||e.isPotential},null,8,["modelValue","disabled"])])]),t[8]||(t[8]=p("div",{id:"knowledgeNetwork"},null,-1))]),_:1},8,["modelValue","size","direction"])}const qo=b(ui,[["render",pi],["__scopeId","data-v-4461d438"]]);class Ae{static instance=new Ae;constructor(){}static newInstance(){return Ae.instance}async openBook(t){return(await A.get(`http://127.0.0.1:12945/openPDF?name=${t}`)).data.success}}const mi=Ae.newInstance(),fi={key:0,class:"chapter-zone"},gi={style:{"margin-left":"10px"}},wi=y({components:{Timer:On},props:{chapters:{required:!0,type:Object}},methods:{extractDocName(e){const t=E.docUrl2Id(e).split("-");return t[t.length-1]},docUrl2Id(e){return E.docUrl2Id(e)},handleDocLinkContextMenu(e,t){return this.$refs.linkPopover.show(e,t.clientX,t.clientY),t.preventDefault(),t.stopPropagation(),!1}}}),yi=y({...wi,__name:"TagChapterZone",setup(e){return(t,o)=>{const n=ue;return t.chapters&&t.chapters.length!=0?(h(),g("div",fi,[p("div",null,[o[0]||(o[0]=p("p",null,"匹配文章",-1)),(h(!0),g(D,null,I(t.chapters,s=>(h(),g("div",{key:s,class:"item"},[p("span",gi,[i(n,{type:"primary",onClick:a=>t.$router.push("/doc/"+t.docUrl2Id(s)),onContextmenu:a=>t.handleDocLinkContextMenu(s,a)},{default:d(()=>[_(C(t.extractDocName(s)),1)]),_:2},1032,["onClick","onContextmenu"])])]))),128))])])):O("",!0)}}}),Bo=b(yi,[["__scopeId","data-v-6e89ca92"]]);function Ho(e){let t=0,o,n;if(e.length===0)return t;for(o=0;o<e.length;o++)n=e.charCodeAt(o),t=(t<<5)-t+n,t|=0;return t}const _i=["primary","info","warning","success","danger"],ki=["#409EFF","#909399","#E6A23C","#67C23A","#F56C6C"];function $i(e){const t=Ho(e)%5;return _i[t]}function vi(e){return ki[Ho(e)%5]}const jo={calcTagType:$i,calcTagColor:vi},bi={key:0},Ci={style:{height:"220px","overflow-y":"scroll"}},Ze="相关文档",Si=y({props:{tags:{required:!0,type:Object},doc:{required:!0,type:String}},watch:{async doc(){this.simliaryDoc=await k.getSimliarDoc(this.doc),this.predictTags=await ke.getPredictTag(this.doc)}},data(){return{tag:"",simliaryDoc:[],predictTags:[]}},computed:{tagList(){return this.tags?[Ze,...this.tags,...this.predictTags.filter(e=>this.tags.indexOf(e)==-1)]:[Ze,...this.predictTags]},chapters(){return this.tag?this.tag==Ze?this.simliaryDoc:ke.getListByTag(this.tag):[]}},async mounted(){this.simliaryDoc=(await k.getSimliarDoc(this.doc)).reverse(),this.predictTags=await ke.getPredictTag(this.doc)},methods:{calcTagType(e){return jo.calcTagType(e)},handleChpaterShow(e){this.tag=e}}}),Di=y({...Si,__name:"TagList",setup(e){return(t,o)=>{const n=be,s=mt;return h(),g("div",null,[(h(!0),g(D,null,I(t.tagList,a=>(h(),v(s,{"popper-class":"tag-popover",width:400,key:a,trigger:"hover",onShow:r=>t.handleChpaterShow(a)},{reference:d(()=>[i(n,{size:"small",type:t.calcTagType(a),onClick:r=>t.$router.push("/tag?tag="+a),effect:"dark"},{default:d(()=>[_(C(a)+" ",1),t.predictTags.indexOf(a)!=-1&&t.tags.indexOf(a)==-1?(h(),g("span",bi,"(预测)")):O("",!0)]),_:2},1032,["type","onClick"])]),default:d(()=>[p("div",Ci,[i(Bo,{chapters:t.chapters},null,8,["chapters"])])]),_:2},1032,["onShow"]))),128))])}}}),Vo=b(Di,[["__scopeId","data-v-8bc89057"]]),Li=y({components:{TagList:Vo},props:{categoryLink:{type:String,required:!0}},emits:["pastdays-change"],data(){return{loading:!0,file:null,tags:[],lastPastDays:0,docMetadata:_e}},computed:{wordCount(){return go(this.file?.content).length},filename(){return this.file?.name},docId(){return E.docUrl2Id(this.categoryLink)},quality(){return k.calcQuanlityStr(this.docId)}},methods:{async init(e){this.loading=!0,e?this.file=await k.getDocFileInfo(E.docUrl2Id(e)):this.file=await k.getDocFileInfo(E.docUrl2Id(this.categoryLink)),this.docMetadata=this.file.formattedMetadata,this.tags=this.file.formattedMetadata.tags,this.lastPastDays=this.calcLastUpdate(),this.loading=!1},destroy(){},calcLastUpdate(){if(!this.file)return-1;const e=this.file.commitList.map(t=>t.date).map(Date.parse).sort((t,o)=>t-o).reverse()[0];return Math.ceil((new Date().getTime()-e)/(3600*24*1e3))},calcUpdateType(e){return e<=10?"danger":e>10&&e<=30?"warning":e>30&&e<=100?"success":e>100&&e<=300?"info":"primary"},async openBook(e){try{await mi.openBook(e)||Z.error("打开书籍失败")}catch(t){Z.error(`打开书籍失败: ${t}`)}}}}),Mi={class:"container"},Ii=["title"];function Ti(e,t,o,n,s,a){const r=ue,l=ct,c=S("tag-list"),u=Un,m=mt,f=be,w=zn,L=ft;return h(),g("div",Mi,[i(L,{rows:1,animated:"",loading:e.loading,throttle:500},{default:d(()=>[p("p",null,C(e.filename),1),p("p",{class:"full-id",title:e.docId},[i(r,{href:"/doc/"+e.docId,onClick:t[0]||(t[0]=de($=>e.$router.push("/doc/"+e.docId),["prevent"])),type:"primary"},{default:d(()=>[_(C(e.docId),1)]),_:1},8,["href"])],8,Ii),i(l,{value:"⏰"+e.lastPastDays+"天前更新",class:"item",type:e.calcUpdateType(e.lastPastDays)},null,8,["value","type"]),i(l,{value:"✏️"+e.wordCount+"字",class:"item",type:"primary"},null,8,["value"]),i(l,{value:"⚽"+e.quality,class:"item",type:"warning"},null,8,["value"]),i(c,{tags:e.tags,doc:e.docId},null,8,["tags","doc"]),e.docMetadata.books&&e.docMetadata.books.length>0?(h(),v(w,{key:0,closable:!1},{default:d(()=>[t[1]||(t[1]=p("p",null,"相关书籍",-1)),(h(!0),g(D,null,I(e.docMetadata.books,$=>(h(),g("p",{key:$.name},[i(m,{ref_for:!0,ref:"popover",placement:"right",title:$.name,trigger:"hover"},{reference:d(()=>[i(r,{onClick:M=>e.openBook($.name)},{default:d(()=>[_(C($.name),1)]),_:2},1032,["onClick"])]),default:d(()=>[$.name?(h(),v(u,{key:0,src:"https://search.ismy.wang/book/img?name=书 "+$.name,alt:"",style:{width:"100px",height:"150px"},fit:"cover"},null,8,["src"])):O("",!0)]),_:2},1032,["title"]),(h(!0),g(D,null,I($.chapters,M=>(h(),v(f,{size:"small",key:M},{default:d(()=>[_(C(M),1)]),_:2},1024))),128))]))),128))]),_:1})):O("",!0)]),_:1},8,["loading"])])}const No=b(Li,[["render",Ti],["__scopeId","data-v-c5b776a7"]]);class vt{name="";id="";content="";commitList=[];hasMoreCommit=!1;totalCommits=0;metadata="";formattedMetadata=_e;createTime=""}const Ei=y({components:{CloseBold:Ce,Place:Rn,CategoryItemContent:No},data(){return{docLink:"",visible:!1,file:new vt,pin:!1}},computed:{contentHtml(){return k.renderMd(this.file)}},methods:{show(e,t,o){this.docLink=e,this.pin=!1,this.initDoc(),this.$refs.categoryItemContent.init(e);const n=this.$refs.popover;this.visible=!0,n.style.top=o+"px",n.style.left=t+"px";const s=this.$refs.popover;let a=!1,r=t,l=o;s.onmousedown=c=>{c.button==1&&(r=c.clientX,l=c.clientY,a=!0,c.preventDefault())},s.onmousemove=c=>{if(a){const u=c.clientX-r,m=c.clientY-l;n.style.top=o+m+"px",n.style.left=t+u+"px",c.preventDefault()}},s.onmouseup=()=>{a=!1,o=parseInt(n.style.top.replace("px","")),t=parseInt(n.style.left.replace("px",""))}},async initDoc(){this.file=await k.getDocFileInfo(E.docUrl2Id(this.docLink))},hide(){this.pin||this.hide0()},hide0(){this.visible=!1,this.$refs.categoryItemContent.destroy()}},mounted(){document.addEventListener("scroll",this.hide)},unmounted(){document.removeEventListener("scroll",this.hide)}}),Pi={ref:"popover",class:"popover"},Ai={class:"drag-bar",ref:"bar"},Fi=["innerHTML"];function Oi(e,t,o,n,s,a){const r=S("close-bold"),l=x,c=z,u=S("place"),m=S("category-item-content");return h(),v(at,{name:"fade"},{default:d(()=>[ae(p("div",Pi,[p("div",Ai,null,512),i(c,{class:"close-button",size:"small",circle:"",onClick:e.hide0},{default:d(()=>[i(l,null,{default:d(()=>[i(r)]),_:1})]),_:1},8,["onClick"]),i(c,{size:"small",circle:"",onClick:t[0]||(t[0]=f=>e.pin=!0),style:{float:"right","margin-right":"10px"}},{default:d(()=>[i(l,null,{default:d(()=>[i(u)]),_:1})]),_:1}),i(m,{"category-link":e.docLink,"category-name":"test",ref:"categoryItemContent"},null,8,["category-link"]),p("div",{class:"markdown-section preview-markdown",innerHTML:e.contentHtml,draggable:"false"},null,8,Fi)],512),[[ce,e.visible]])]),_:1})}const bt=b(Ei,[["render",Oi],["__scopeId","data-v-13075c2a"]]),zi=y({components:{CategoryItemContent:No},props:{value:{type:Object,required:!0},isParent:{type:Boolean,deault:!1}},data(){return{pastDays:999}},methods:{convert(e){return k.docUrl2Id(e)},async handlePopoverShow(){this.$refs.categoryItemContent.init()},handlePopoverHide(){this.$refs.categoryItemContent.destroy()},handleMenuItemClick(e){this.$store.commit("setCurrentCategory",e)}}});function Ui(e,t,o,n,s,a){const r=qn;return h(),v(r,{index:e.convert(e.value.link),onClick:t[0]||(t[0]=l=>e.handleMenuItemClick(e.value)),class:ee({hilight:e.isParent}),disabled:!e.value.link},{title:d(()=>[p("div",null,[p("span",null,C(e.value.name),1)])]),_:1},8,["index","class","disabled"])}const Ri=b(zi,[["render",Ui],["__scopeId","data-v-16378d3a"]]);function qi(e){for(var t=0,o=0;o<e.length;o++){var n=e.charCodeAt(o);t=(t<<5)-t+n,t=t&t}return t}const Bi=y({components:{CategoryItem:Ri},props:{menuList:{type:Array,required:!0}},emits:["contextmenu"],data(){return{currentOpenedMenu:this.$store.state.currentOpenedMenu}},methods:{uuid(){return Math.random().toString()},convert(e){return e.link?k.docUrl2Id(e.link):e.name+"-"+qi(e.name)},handleContextMenu(e,t){this.$emit("contextmenu",e,t)},handleChildrenContextMenu(e,t){},childrenSize(e){return Ee.childrenSize(e)}},setup(){}});function Hi(e,t,o,n,s,a){const r=ct,l=S("category-item"),c=S("category-tree",!0),u=Bn;return h(!0),g(D,null,I(e.menuList,m=>(h(),g(D,null,[m.chidren.length!=0?(h(),v(u,{index:e.convert(m)+"p",key:e.convert(m)+"p"},{title:d(()=>[p("div",null,[p("span",null,C(m.name),1),i(r,{max:500,value:e.childrenSize(m),class:"item",type:"primary",style:{"margin-left":"8px"}},null,8,["value"])])]),default:d(()=>[m.link?(h(),v(l,{key:0,value:m,isParent:!0,onContextmenu:f=>e.handleContextMenu(f,m.link),title:m.link},null,8,["value","onContextmenu","title"])):O("",!0),m.show||e.currentOpenedMenu.has(e.convert(m)+"p")?(h(),v(c,{key:1,menuList:m.chidren,onContextmenu:e.handleContextMenu},null,8,["menuList","onContextmenu"])):O("",!0)]),_:2},1032,["index"])):(h(),v(l,{value:m,key:e.convert(m),onContextmenu:f=>e.handleContextMenu(f,m.link)},null,8,["value","onContextmenu"]))],64))),256)}const ji=b(Bi,[["render",Hi],["__scopeId","data-v-4d95434f"]]),Vi=y({props:{doc:String},components:{CategoryTree:ji,LinkPopover:bt},emits:["firstLoad"],setup(){},data(){return{cateList:[],activeMenu:"",loading:!0,loaded:!1}},watch:{doc(){this.markShowCateChain()}},computed:{isDark(){return this.$store.state.isDarkMode}},methods:{handleOpen(e){this.$store.commit("addOpenedMenu",e),console.log(e),this.loaded||(this.loaded=!0,this.$emit("firstLoad"))},handleContextMenu(e,t){this.$refs.linkPopover.show(t,e.clientX,e.clientY),e.preventDefault()},showDoc(e){this.updateCurrentCategory(e),this.$router.push("/doc/"+e)},findCategoryById(e){e.split("-");const t=[...this.cateList];for(;t.length>0;){const o=t.pop();if(k.docUrl2Id(o.link)==e)return o;t.push(...o.chidren)}return null},updateCurrentCategory(e){const t=this.findCategoryById(e);t?this.$store.commit("setCurrentCategory",t):console.warn(`${this.doc} 无法找寻到相关目录!`)},markShowCateChain(){let e=this.findCategoryById(this.doc);for(console.log(e);e;)e.show=!0,e=e.parent}},async created(){this.loading=!0,this.cateList=await re.getCompiledCategoryList(),this.markShowCateChain(),this.updateCurrentCategory(this.doc),this.$nextTick(()=>{this.loading=!1}),this.loading=!1}});function Ni(e,t,o,n,s,a){const r=S("CategoryTree"),l=Hn,c=ft,u=S("link-popover");return h(),g(D,null,[i(c,{rows:24,animated:"",loading:e.loading,throttle:50,style:{"max-width":"80%",padding:"20px"}},{default:d(()=>[i(l,{"unique-opened":!1,"default-active":e.doc,router:!0,"background-color":e.isDark?"var(--second-dark-bg-color)":"","text-color":e.isDark?"var(--main-dark-text-color)":"",onOpen:e.handleOpen},{default:d(()=>[i(r,{menuList:e.cateList,onContextmenu:e.handleContextMenu},null,8,["menuList","onContextmenu"])]),_:1},8,["default-active","background-color","text-color","onOpen"])]),_:1},8,["loading"]),i(u,{ref:"linkPopover"},null,512)],64)}const Ko=b(Vi,[["render",Ni],["__scopeId","data-v-39831ac5"]]),Ki=y({components:{CategoryList:Ko},emits:["toggleAside"],inject:["showHeader"],props:{showAside:Boolean,doc:String},data(){return{parentShowHeader:!0}},methods:{syncCategoryListScrollBar(){const t=this.$refs.root.querySelector(".el-menu-item.is-active");t&&t.scrollIntoView({behavior:"smooth"})},updateCurrentCategory(e){this.$refs.categoryList.updateCurrentCategory(e)}},watch:{showHeader:{handler(e){this.parentShowHeader=e},immediate:!0}},setup(){return{ArrowLeftBold:jn,ArrowRightBold:io}}}),Qi={ref:"root"},Wi={class:"category-content"};function Ji(e,t,o,n,s,a){const r=S("category-list"),l=Vn,c=z,u=dt;return h(),g(D,null,[ae(p("div",Qi,[i(l,{width:"280px","lock-scroll":!1,class:"doc-aside"},{default:d(()=>[p("div",{class:"category-wrapper",style:we({height:e.parentShowHeader?"calc(100vh - 60px)":"100vh"})},[t[1]||(t[1]=p("div",{class:"category-header"},[p("h3",{class:"category-title"},"文档")],-1)),p("div",Wi,[(h(),v(le,null,[i(r,{ref:"categoryList",doc:e.doc},null,8,["doc"])],1024))])],4)]),_:1})],512),[[ce,e.showAside]]),i(u,{offset:384,class:"toggle-affix"},{default:d(()=>[i(c,{class:ee(["aside-toggle-btn",{active:e.showAside}]),type:"default",size:"small",onClick:t[0]||(t[0]=m=>e.$emit("toggleAside")),icon:e.showAside?e.ArrowLeftBold:e.ArrowRightBold,circle:"",title:e.showAside?"隐藏侧边栏":"显示侧边栏"},null,8,["class","icon","title"])]),_:1})],64)}const Gi=b(Ki,[["render",Ji],["__scopeId","data-v-f09c7fbe"]]),xi=y({setup(){},methods:{docUrl2Id(e){return k.docUrl2Id(e)},getCategoryChain(e){const t=[e];for(;e.parent;)t.push(e.parent),e=e.parent;return t.reverse()}},computed:{currentCategory(){return this.$store.state.currentCategory},categoryChainList(){return this.currentCategory?this.getCategoryChain(this.currentCategory):[]}}});function Yi(e,t,o,n,s,a){const r=Nn,l=Kn;return h(),v(l,{separator:"/"},{default:d(()=>[(h(!0),g(D,null,I(e.categoryChainList,(c,u)=>(h(),v(r,{to:{path:"/doc/"+e.docUrl2Id(c.link)},key:c.name},{default:d(()=>[p("span",{class:ee(["chain-name",{last:u==e.categoryChainList.length-1}])},C(c.name),3)]),_:2},1032,["to"]))),128))]),_:1})}const Xi=b(xi,[["render",Yi],["__scopeId","data-v-de68cfcf"]]),Zi=y({props:{fixed:{type:Boolean,required:!0}},components:{CloseBold:Ce},emits:["toggleFixed"],data(){return{docLink:"",visible:!1,cateLink:""}},computed:{cateList(){return this.$store.state.currentCategoryList},currentCate(){return this.$store.state.currentCategory}},methods:{show(e,t,o){this.cateLink=e;const n=this.$refs.root;this.visible=!0,n.style.top=o+"px",n.style.left=t+"px"},hide(){this.visible=!1},closeCurrent(){let e=this.cateList.indexOf(this.cateLink);this.$store.commit("removeFromCategoryList",this.cateLink),e>0&&e--;const t=E.docUrl2Id(this.cateList[e]);this.currentCate.link==this.cateLink&&this.$router.push("/doc/"+t),this.hide()},close(e){this.cateLink=e,this.closeCurrent()},closeOthers(){this.$store.commit("removeFromCategoryListExcept",this.cateLink),this.$router.push("/doc/"+E.docUrl2Id(this.cateList[0])),this.hide()}},mounted(){},setup(){}}),el={ref:"root",class:"context-menu"},tl={class:"menu-items"};function ol(e,t,o,n,s,a){const r=z;return h(),v(at,{name:"fade"},{default:d(()=>[ae(p("div",el,[i(r,{class:"close-btn",size:"small",circle:"",onClick:e.hide,icon:e.CloseBold},null,8,["onClick","icon"]),p("div",tl,[e.fixed?(h(),v(r,{key:0,size:"small",class:"menu-item",onClick:t[0]||(t[0]=l=>{e.$emit("toggleFixed"),e.hide()})},{default:d(()=>[...t[2]||(t[2]=[_(" 取消固定 ",-1)])]),_:1})):(h(),v(r,{key:1,size:"small",class:"menu-item",onClick:t[1]||(t[1]=l=>{e.$emit("toggleFixed"),e.hide()})},{default:d(()=>[...t[3]||(t[3]=[_(" 固定菜单 ",-1)])]),_:1})),i(r,{size:"small",class:"menu-item",disabled:e.cateList.length<=1,onClick:e.closeCurrent},{default:d(()=>[...t[4]||(t[4]=[_(" 关闭 ",-1)])]),_:1},8,["disabled","onClick"]),i(r,{size:"small",class:"menu-item",disabled:e.cateList.length<=1,onClick:e.closeOthers},{default:d(()=>[...t[5]||(t[5]=[_(" 关闭其他 ",-1)])]),_:1},8,["disabled","onClick"])])],512),[[ce,e.visible]])]),_:1})}const Qo=b(Zi,[["render",ol],["__scopeId","data-v-bdb2203f"]]),nl={class:"tab-content"},sl={class:"tab-name"},rl={class:"tab-category"},al=y({inject:["showHeader"],emits:["dbclick"],components:{TabNavContextMenu:Qo},data(){return{parentShowHeader:!0,fixed:!0,allCateList:[]}},watch:{showHeader:{handler(e){this.parentShowHeader=e},immediate:!0},currentCate(){this.$nextTick(()=>{const e=document.querySelector(`.tab-container-wrapper [url="${this.currentCate.link}"]`);e&&e.scrollIntoView()})}},mounted(){const e=document.querySelector(".tab-container-wrapper");e.addEventListener("wheel",t=>(e.scrollTo(e.scrollLeft+t.deltaY,0),t.stopPropagation(),t.preventDefault()))},async created(){this.allCateList=await re.getCategoryList()},methods:{docUrl2Id:E.docUrl2Id,cateName(e){const t=this.docUrl2Id(e).split("-");return t[t.length-1]},handleContextMenuEvent(e,t){this.$refs.contextMenu.show(e,t.clientX,t.clientY),t.preventDefault(),t.stopPropagation()},close(e){this.$refs.contextMenu.close(e)},findRootCategoryFirstLetter(e){function t(n){if(!n)return null;for(let s of n){if(s.link==e)return s;const a=t(s.chidren);if(a)return a}return null}let o=t(this.allCateList);if(!o)return"📋";for(;o.parent;)o=o?.parent;for(let n of o.name)return n;return o.name.substring(0,1)}},computed:{cateList(){return this.$store.state.currentCategoryList},currentCate(){return this.$store.state.currentCategory}}}),il=y({...al,__name:"DocTabNav",setup(e){return(t,o)=>{const n=x,s=z;return h(),g(D,null,[i(T(Qn),{"wrap-class":"tab-container-wrapper",class:"tab-container",ref:"tabContainer",style:we({top:t.parentShowHeader?"66px":"6px",position:t.fixed?"fixed":"absolute"})},{default:d(()=>[(h(!0),g(D,null,I(t.cateList,a=>(h(),v(s,{class:ee(["nav-tab-item",{active:t.docUrl2Id(t.currentCate.link)==t.docUrl2Id(a)}]),size:"default",key:a,url:a,onContextmenu:r=>t.handleContextMenuEvent(a,r),onClick:r=>t.$router.push("/doc/"+t.docUrl2Id(a)),onDblclick:o[0]||(o[0]=r=>t.$emit("dbclick"))},{default:d(()=>[p("div",nl,[p("span",sl,C(t.cateName(a)),1),p("span",rl,C(t.findRootCategoryFirstLetter(a)),1),t.cateList.length>1?(h(),v(n,{key:0,class:"close-btn",onClick:de(r=>t.close(a),["prevent","stop"])},{default:d(()=>[i(T(Ce))]),_:1},8,["onClick"])):O("",!0)])]),_:2},1032,["url","onContextmenu","class","onClick"]))),128))]),_:1},8,["style"]),i(Qo,{ref:"contextMenu",onToggleFixed:o[1]||(o[1]=a=>t.fixed=!t.fixed),fixed:t.fixed},null,8,["fixed"])],64)}}}),ll=b(il,[["__scopeId","data-v-1be3bfd3"]]);class Wo{docPageInstance;isMobile;constructor(t,o=!1){this.docPageInstance=t,this.isMobile=o}getRef(t){return this.docPageInstance.$refs[t]}listenEventBus(){Pe.on("enter-zen-mode",()=>{this.docPageInstance.showAside=!1})}registerLinkRouter(t){const o=t,n=o.querySelectorAll("a[origin-link]"),s=o.querySelectorAll("a:not([origin-link])");for(let a=0;a<n.length;a++){const r=n[a];r.onclick=l=>{const c=r.getAttribute("href");if(c?.startsWith("doc")||c?.startsWith("/doc"))return l.altKey?(this.getRef("instantPreviewer").preview("/#"+c),console.log(c)):this.docPageInstance.$router.push(c),l.preventDefault(),l.stopPropagation(),!1}}for(let a=0;a<s.length;a++){const r=s[a];r.onclick=l=>{const c=r.getAttribute("href");this.openOutterLink(c),l.preventDefault(),l.stopPropagation()}}}openOutterLink(t){this.getRef("resourceBrower").show(t)}registerImageClick(t){const n=t.querySelectorAll(".img-wrapper"),s=Array.from(n).map(a=>a.querySelector("img")?.getAttribute("src")||"");for(let a=0;a<n.length;a++){const r=n[a];r.onclick=l=>{this.getRef("imageViewer").show(s,a)}}}registerHeadingClick(t){const n=t.querySelectorAll("h1,h2,h3,h4,h5,h6");for(let s=0;s<n.length;s++){const a=n[s];a.onclick=async r=>{const l=a.innerText,c="/"+E.docId2Url(this.docPageInstance.doc)+"#"+l;await navigator.clipboard.writeText(c),Z.success("复制成功: "+c)}}}renderLatex(t){t.querySelectorAll(".tex").forEach(o=>{const n=o;try{gs.render(n.getAttribute("raw").replace(/[^\\](%)/g,s=>s[0]+"\\%"),n,{strict:!1,throwOnError:!0})}catch(s){n.innerHTML=`<span style='color:red'>${s.message}</span>`}})}registerDocTagSupClick(t){const n=t.querySelectorAll(".markdown-section [tag]");for(let s=0;s<n.length;s++){const a=n[s];a.onclick=r=>{const l=a.getAttribute("tag");this.docPageInstance.$router.push("/tag?tag="+l),r.preventDefault(),r.stopPropagation()}}}registerScrollListener(){let t;document.addEventListener("scroll",o=>{clearTimeout(t),t=setTimeout(()=>{k.setDocReadRecrod(this.docPageInstance.doc,window.scrollY)},1e3),this.getRef("linkPopover")&&this.getRef("linkPopover").hide()})}registerTextSelected(t){t.addEventListener("mouseup",o=>{const n=document.getSelection()?.toString();n?this.getRef("selectionPopover")&&this.getRef("selectionPopover").show(n,o.clientX-50,o.clientY+20):this.getRef("selectionPopover")&&this.getRef("selectionPopover").hide()}),t.addEventListener("touchend",o=>{const n=document.getSelection()?.toString();n?this.getRef("selectionPopover")&&this.getRef("selectionPopover").show(n,o.changedTouches[0].clientX-50,o.changedTouches[0].clientY+20):this.getRef("selectionPopover")&&this.getRef("selectionPopover").hide()})}registerMermaidFullScreenClick(t){t.querySelectorAll(".mermaid-wrapper .fullscreen button").forEach(n=>n.addEventListener("click",s=>{this.getRef("mermaidShower")&&this.getRef("mermaidShower").show(n.parentElement?.parentElement?.getAttribute("data-raw"))}))}renderMermaid(){nt.initAllNode()}removeAllScrollListener(){document.onscroll=null}syncHeading(t){if(t){const o=document.querySelector("#"+t);o&&window.scrollTo(0,o.offsetTop-80)}}}const cl=y({setup(){},methods:{show(e){this.src=e,this.showDrawer=!0}},data(){return{showDrawer:!1,src:""}}}),dl=["src"],ul=["src"],hl=["src"];function pl(e,t,o,n,s,a){const r=Jn,l=Wn,c=J;return h(),v(c,{modelValue:e.showDrawer,"onUpdate:modelValue":t[0]||(t[0]=u=>e.showDrawer=u),size:"80%","with-header":!1,title:"资源浏览器","append-to-body":!1,"modal-class":"drawer-modal-class"},{default:d(()=>[i(l,{type:"card"},{default:d(()=>[i(r,{label:"时光机最新存档"},{default:d(()=>[p("iframe",{src:"https://web.archive.org/web/"+e.src,sandbox:"allow-scripts allow-same-origin",name:"main",target:"main",frameborder:"0"},null,8,dl)]),_:1}),i(r,{label:"原始"},{default:d(()=>[p("iframe",{src:e.src,sandbox:"allow-scripts allow-same-origin",frameborder:"0"},null,8,ul)]),_:1}),i(r,{label:"时光机历史"},{default:d(()=>[p("iframe",{src:"https://web.archive.org/web/*/"+e.src,sandbox:"allow-scripts allow-same-origin",name:"main",target:"main",frameborder:"0"},null,8,hl)]),_:1})]),_:1})]),_:1},8,["modelValue"])}const ml=b(cl,[["render",pl],["__scopeId","data-v-e6be459b"]]);oe([gt,po,hs,ne,ho,he,ps,ms]);function fl(e){const t=e.sort((n,s)=>s[1]-n[1])[0][1],o=e.sort((n,s)=>s[0]-n[0])[0][0];return{animation:!1,label:{formatter:"{b}",align:"right"},lineStyle:{type:"solid"},tooltip:{formatter:"{b}"},data:[{name:"0.75 基准线",yAxis:t*.75},{name:"0.5 基准线",yAxis:t*.5},{name:"0.25 基准线",yAxis:t*.25},{name:"0.75 基准线",xAxis:o*.75},{name:"0.5 基准线",xAxis:o*.5},{name:"0.25 基准线",xAxis:o*.25}]}}const gl=y({props:{doc:{type:String,required:!0}},setup(){},mounted(){this.init()},data(){return{selectedData:[]}},watch:{doc(){this.init()}},methods:{async generateScatterData(){const e=await P.getDescCommitDocList(),t=e.map(s=>new Date(s[1].date).getTime()).sort((s,a)=>s-a)[0],o=await P.getDocQualityData(),n=new Map;for(let s of e)n.has(s[0])||n.set(s[0],[0,0]),n.get(s[0])[0]=(new Date(s[1].date).getTime()-t)/(1e3*3600*24);for(let s of o)n.get(s.id)[1]=s.quality;return Array.from(n.entries()).map(s=>[...s[1],s[0]])},async init(){const t=(await this.generateScatterData()).map(r=>({name:r[2],value:r,symbolSize:this.doc==r[2]?20:12,itemStyle:{color:this.doc==r[2]?"#F56C6C":"#409EFF"}}));var o=this.$refs.container;const n=te(o);n.on("click",r=>{const l=r.data.name;this.$router.push("/doc/"+l)}),n.on("brushselected",r=>{this.selectedData=r.batch[0].selected[0].dataIndex.map(l=>t[l].name)});let s=null;n.on("brushEnd",r=>{this.selectedData.length!=0&&(s&&s.close(),this.selectedData.sort(),s=Gn({title:"所选文档",dangerouslyUseHTMLString:!0,message:this.selectedData.join("</br>"),duration:0}))});var a;a={xAxis:{name:"时间新鲜度"},yAxis:{name:"质量"},brush:{},dataZoom:[{type:"inside"},{type:"slider"}],tooltip:{formatter(r,l,c){const u=r.data.name,m=k.getDocFileInfo(u);if(m instanceof Promise)m.then(f=>{c(l,k.buildSummaryDocInfo(f))}).catch(f=>{c(l,`${f}`)});else return k.buildSummaryDocInfo(m);return"loading"}},series:[{symbolSize:12,data:t,type:"scatter",markLine:fl(t.map(r=>r.value))}]},a&&n.setOption(a)}}});function wl(e,t,o,n,s,a){return h(),g("div",{ref:"container",class:ee(["container",{"mobile-container":e.$isMobile()}])},null,2)}const yl=b(gl,[["render",wl],["__scopeId","data-v-f6659f06"]]),_l=y({props:{doc:{type:String,required:!0}},components:{KnowledgeScatter:yl},data(){return{displayMode:"倒序",sort:"时间",showDrawer:!1,repoUrl:G.repositoryUrl,rangeValue:[0,20],docList:[],marks:{0:"现在",1:{style:{"margin-top":"-24px"},label:"1天内"},3:"1周内",6:{style:{"margin-top":"-24px"},label:"1月内"},10:{style:{},label:"6月内"},20:"最远"}}},computed:{filterDocList(){const e=new Date().getTime();let t=this.rangeMapping(this.rangeValue[0]),o=this.rangeMapping(this.rangeValue[1]);const n=e-t*3600*1e3*24,s=e-o*3600*1e3*24;return this.docList.filter(a=>{const r=new Date(a[1].date).getTime();return r>=s&&r<=n})}},methods:{docId2Url:E.docId2Url,docUrl2Id:E.docUrl2Id,rangeMapping(e){return e==0?0:e>=1&&e<3?1:e>=3&&e<6?7:e>=6&&e<10?30:e>=10&&e<20?180:2147483647},quality(e){return k.calcQuanlityStr(e)},show(){this.showDrawer=!0},hide(){this.showDrawer=!1},sortByQuantity(){this.displayMode=="倒序"?this.docList=this.docList.sort((e,t)=>(k.getDocQuality(t[0])?.quality||0)-(k.getDocQuality(e[0])?.quality||0)):this.docList=this.docList.sort((e,t)=>(k.getDocQuality(e[0])?.quality||0)-(k.getDocQuality(t[0])?.quality||0))},sortByTime(){this.displayMode=="倒序"?this.docList=this.docList.sort((e,t)=>new Date(e[1].date).getTime()-new Date(t[1].date).getTime()):this.docList=this.docList.sort((e,t)=>new Date(t[1].date).getTime()-new Date(e[1].date).getTime())},handleDisplayModeChange(){this.sort=="时间"?this.sortByTime():this.sortByQuantity(),document.querySelector(".knowledge-review .el-drawer__body")?.scrollTo(0,0)}},async created(){this.docList=await P.getDescCommitDocList(),this.sort=="时间"?this.sortByTime():this.sortByQuantity()}}),kl={class:"review-range"},$l={class:"sort"},vl={class:"history-list"},bl=["onClick"],Cl={class:"timestamp"},Sl=["href"],Dl={class:"timestamp"};function Ll(e,t,o,n,s,a){const r=S("knowledge-scatter"),l=co,c=ht,u=lt,m=it,f=ao,w=ut,L=eo,$=to,M=lo,Y=J;return h(),v(Y,{modelValue:e.showDrawer,"onUpdate:modelValue":t[3]||(t[3]=F=>e.showDrawer=F),size:e.$isMobile()?"90%":"84%",title:"知识回顾","lock-scroll":!0,"custom-class":"knowledge-review"},{default:d(()=>[i(M,{style:{height:"100%"}},{default:d(()=>[i(l,{md:18,xs:24},{default:d(()=>[i(r,{ref:"knowledgeScatter",doc:e.doc},null,8,["doc"])]),_:1}),i(l,{md:6,xs:24,style:{height:"100%"}},{default:d(()=>[p("div",kl,[i(c,{modelValue:e.rangeValue,"onUpdate:modelValue":t[0]||(t[0]=F=>e.rangeValue=F),range:"",max:20,"show-tooltip":!1,marks:e.marks},null,8,["modelValue","marks"])]),i(m,{modelValue:e.displayMode,"onUpdate:modelValue":t[1]||(t[1]=F=>e.displayMode=F),placeholder:"选择",size:"small",class:"display-mode",onChange:e.handleDisplayModeChange},{default:d(()=>[i(u,{label:"倒序",value:"倒序"}),i(u,{label:"正序",value:"正序"})]),_:1},8,["modelValue","onChange"]),p("div",$l,[t[4]||(t[4]=p("span",null,"排序依据: ",-1)),i(w,{modelValue:e.sort,"onUpdate:modelValue":t[2]||(t[2]=F=>e.sort=F),onChange:e.handleDisplayModeChange},{default:d(()=>[i(f,{label:"时间"}),i(f,{label:"质量"})]),_:1},8,["modelValue","onChange"])]),p("div",vl,[i($,null,{default:d(()=>[(h(!0),g(D,null,I(e.filterDocList,F=>(h(),v(L,{key:F[0]},{default:d(()=>[p("a",{href:"#",onClick:de(Ct=>e.$router.push("/doc/"+F[0]),["prevent"])},C(e.docId2Url(F[0])),9,bl),p("p",Cl,[_(C(new Date(F[1].date).toLocaleString())+" ",1),p("a",{href:e.repoUrl+"/commit/"+F[1].hash,target:"_blank"},C(F[1].message),9,Sl)]),p("p",Dl,[p("span",null,"⚽质量分数: "+C(e.quality(F[0])),1)])]),_:2},1024))),128))]),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue","size"])}const Jo=b(_l,[["render",Ll],["__scopeId","data-v-2daf63bc"]]),Ml=y({props:{file:{required:!0,type:Object}},data(){return{showDrawer:!1}},setup(){}}),Il={key:0,class:"books"},Tl={class:"book-container"},El={class:"book-title"};function Pl(e,t,o,n,s,a){const r=ue,l=be,c=J;return h(),g(D,null,[e.file.formattedMetadata.books&&e.file.formattedMetadata.books.length!=0?(h(),g("p",Il,[t[2]||(t[2]=_(" 📕",-1)),t[3]||(t[3]=p("span",null,"相关书籍: ",-1)),(h(!0),g(D,null,I(e.file.formattedMetadata.books,u=>(h(),v(r,{onClick:t[0]||(t[0]=m=>e.showDrawer=!0),key:u.name},{default:d(()=>[_(C(u.name),1)]),_:2},1024))),128))])):O("",!0),i(c,{direction:"ttb",modelValue:e.showDrawer,"onUpdate:modelValue":t[1]||(t[1]=u=>e.showDrawer=u),"with-header":!1},{default:d(()=>[p("div",Tl,[(h(!0),g(D,null,I(e.file.formattedMetadata.books,u=>(h(),g("div",{class:"book-item",key:u.name},[p("div",null,[p("p",El,C(u.name),1),(h(!0),g(D,null,I(u.chapters,m=>(h(),v(l,{key:m},{default:d(()=>[_(C(m),1)]),_:2},1024))),128))])]))),128))])]),_:1},8,["modelValue"])],64)}const Al=b(Ml,[["render",Pl],["__scopeId","data-v-d0f3806a"]]),Fl=y({props:{links:{required:!0,type:Object}},emits:["linkClick"],methods:{trimLink(e){return e.length<40?e:e.substring(0,40)+"..."}}}),Ol={style:{cursor:"pointer","font-size":"14px"}};function zl(e,t,o,n,s,a){const r=ue,l=mt;return h(),g("div",null,[i(l,{placement:"left-start",width:400,trigger:"hover"},{reference:d(()=>[p("span",Ol,"🔭外部链接("+C(e.links.length)+")",1)]),default:d(()=>[p("ul",null,[(h(!0),g(D,null,I(e.links,c=>(h(),g("li",{key:c},[i(r,{type:"primary",onClick:u=>e.$emit("linkClick",c)},{default:d(()=>[_(C(e.trimLink(c)),1)]),_:2},1032,["onClick"])]))),128))])]),_:1})])}const Ul=b(Fl,[["render",zl]]);class Rl{date="";author="";message="";hash="";insertions=0;deletions=0}const ql={class:"create-time"},Bl={class:"last-update"},Hl=["href"],jl={class:"quality-score"},Vl=y({props:{file:{required:!0,type:Object}},data(){return{config:G}},emits:["linkClick"],methods:{handleLinkClick(e){this.$emit("linkClick",e)}},computed:{quality(){return k.calcQuanlityStr(this.file.id)},firstCommit(){return this.file.commitList[0]||new Rl}}}),Nl=y({...Vl,__name:"DocMetadataInfo",setup(e){return(t,o)=>(h(),g(D,null,[p("p",ql,[o[0]||(o[0]=_(" ⏰",-1)),o[1]||(o[1]=p("span",null,"创建时间: ",-1)),_(C(new Date(t.file.createTime).toLocaleString()),1)]),p("p",Bl,[o[2]||(o[2]=_(" 🪵",-1)),p("span",null,"最后更新: "+C(new Date(t.firstCommit.date).toLocaleString()),1),o[3]||(o[3]=_()),p("a",{href:T(G).repositoryUrl+"/commit/"+t.firstCommit.hash,target:"_blank"},C(t.firstCommit.message),9,Hl)]),p("p",jl,[o[4]||(o[4]=_("⚽",-1)),o[5]||(o[5]=p("span",null,"质量分数: ",-1)),_(C(t.quality),1)]),t.file.formattedMetadata.links.length>0?(h(),v(Ul,{key:0,links:t.file.formattedMetadata.links,onLinkClick:t.handleLinkClick},null,8,["links","onLinkClick"])):O("",!0),i(Al,{file:t.file},null,8,["file"]),i(Vo,{tags:t.file.formattedMetadata.tags,doc:t.file.id},null,8,["tags","doc"])],64))}}),Go=b(Nl,[["__scopeId","data-v-1d06ff1b"]]),Kl=y({data(){return{show:!1,url:""}},methods:{preview(e){this.url=e,this.show=!0}}}),Ql=["src"];function Wl(e,t,o,n,s,a){const r=J;return h(),v(r,{modelValue:e.show,"onUpdate:modelValue":t[0]||(t[0]=l=>e.show=l),size:"80%","with-header":!1,"lock-scroll":!0},{default:d(()=>[p("iframe",{src:e.url,style:{width:"100%",height:"100%"}},null,8,Ql)]),_:1},8,["modelValue"])}const Jl=b(Kl,[["render",Wl]]),Gl=y({data(){return{showDialog:!1}},methods:{show(e){console.log(e),this.showDialog=!0,Ue.render("mermaidshower-svg",e).then(t=>{this.$refs.container.innerHTML=t.svg.replace(/[ ]*max-width:[ 0-9\.]*px;/i,"height:80vh")}).then(()=>{ts("#mermaidshower svg",{zoomEnabled:!0,controlIconsEnabled:!0,mouseWheelZoomEnabled:!0,fit:!0,center:!0})})}}}),xl={ref:"container",id:"mermaidshower"};function Yl(e,t,o,n,s,a){const r=Vt;return h(),v(r,{modelValue:e.showDialog,"onUpdate:modelValue":t[0]||(t[0]=l=>e.showDialog=l),title:"查看",width:"80%",top:"5vh"},{default:d(()=>[p("div",xl,null,512)]),_:1},8,["modelValue"])}const xo=b(Gl,[["render",Yl]]);function ie(e){return!e||e.length==0?"":e.map(t=>Xo(t.level)+"- "+t.name+`
`+ie(t.chidren)).join(`
`)}function Yo(e,t){return!e||e.length==0?"":e.map(o=>Xo(t)+"- "+o.name+`
`+Yo(o.chidren,t+1)).join(`
`)}function Xo(e){let t="";for(let o=0;o<e;o++)t+=" ";return t}const Xl=y({props:{doc:{type:String,required:!0}},data(){return{showDrawer:!1,llmMode:"category",query:"",presets:[{name:"根据整个目录回答问题",value:"answerByAllCategory",template:()=>this.answerByAllCategoryTemplate()},{name:"根据内容回答问题",value:"ansuwerByContent",template:()=>this.answerByContentTempalte()},{name:"根据目录回答问题",value:"ansuwerByCategory",template:()=>this.answerByCategoryTempalte()},{name:"标签预测",value:"predictTag",template:()=>this.tagsPredicateTemplate()},{name:"概括总结",value:"summary",template:()=>this.summaryTemplate()},{name:"补充目录",value:"category",template:()=>this.categoryTempalte()},{name:"更新与趋势",value:"trends",template:()=>this.trendsTemplate()},{name:"历史背景",value:"history",template:()=>this.historyTemplate()},{name:"未来发展",value:"future",template:()=>this.futureTemplate()},{name:"核心概念解释",value:"concepts",template:()=>this.conceptsTemplate()},{name:"实践应用场景",value:"applications",template:()=>this.applicationsTemplate()},{name:"常见问题与解答",value:"faq",template:()=>this.faqTemplate()},{name:"知识对比分析",value:"comparison",template:()=>this.comparisonTemplate()},{name:"学习路径规划",value:"learningPath",template:()=>this.learningPathTemplate()},{name:"关键要点梳理",value:"keyPoints",template:()=>this.keyPointsTemplate()},{name:"案例分析",value:"caseStudy",template:()=>this.caseStudyTemplate()},{name:"错误概念纠正",value:"misconceptions",template:()=>this.misconceptionsTemplate()},{name:"知识关联图谱",value:"relations",template:()=>this.relationsTemplate()}]}},watch:{doc(){this.handleModeChange()}},computed:{isDark(){return this.$store.state.isDarkMode}},methods:{async answerByContentTempalte(){return`
        请根据以下文本回答问题：

        问题：


        文本：
        ---
        ${(await k.getDocFileInfo(this.doc)).content}
        ---
      `},async answerByAllCategoryTemplate(){const e=await re.getCategoryList();return`
        以下是个人知识体系的目录，请根据目录回答问题：

        问题：


        目录：
        ---
        ${Yo(e,0)}
        ---
      `},async answerByCategoryTempalte(){const e=await k.getContentByDocId(this.doc),t=ie(e);return`
        以下是关于 《${this.doc}》 的目录，请根据目录回答问题：

        问题：


        目录：
        ---
        ${t}
        ---
      `},async futureTemplate(){return`
        简单介绍一下关于 《${this.doc}》 的未来可能得发展方向与挑战
      `},async historyTemplate(){return`
        简单介绍一下关于 《${this.doc}》 的历史背景，重点放在关于 《${this.doc}》 的发展历程
      `},async trendsTemplate(){const e=await k.getContentByDocId(this.doc),t=ie(e);return`
        以下是关于 《${this.doc}》 的目录，根据你最新的模型，列出该主题的最近更新与趋势，并附带年份
        ---
        ${t}
        ---
      `},async categoryTempalte(){const e=await k.getContentByDocId(this.doc),t=ie(e);return`
        以下是关于 《${this.doc}》 的目录，还有哪些方面的内容还可以补充
        ---
        ${t}
        ---
      `},async summaryTemplate(){return`
        概括以下文本的内容：
        ---
        ${(await k.getDocFileInfo(this.doc)).content}
        ---
      `},async tagsPredicateTemplate(){const e=ke.getTagList(),t=await k.getDocFileInfo(this.doc);return`
      根据这篇 《${this.doc}》的内容，从标签列表中挑选出最合适的 5 个标签，标签尽量从标签列表选择，当然也可以根据文本内容生成，但是生成的标签应具备抽象通用的语义，标签不要太过具体
      
      标签列表：${e.join(",")}

      文本内容：
      ---
      ${t.content}
      ---
      `},show(){this.showDrawer=!0},async handleModeChange(){const e=this.presets.filter(o=>o.value==this.llmMode)[0].template,t=(await e()).split(`
`).map(o=>o.replace(/(^\s*)|(\s*$)/g,"")).join(`
`);this.query=t},async conceptsTemplate(){const e=await k.getDocFileInfo(this.doc);return`
        请详细解释关于 《${this.doc}》 的核心概念和定义，并提供易于理解的示例。
        
        文本内容：
        ---
        ${e.content}
        ---
      `},async applicationsTemplate(){const e=await k.getDocFileInfo(this.doc);return`
        请列举关于 《${this.doc}》 的实际应用场景，并详细说明在不同场景中如何运用相关知识。
        
        文本内容：
        ---
        ${e.content}
        ---
      `},async faqTemplate(){const e=await k.getDocFileInfo(this.doc),t=await k.getContentByDocId(this.doc),o=ie(t);return`
        基于以下关于 《${this.doc}》 的内容和目录，请提出并回答可能遇到的常见问题。
        
        目录：
        ---
        ${o}
        ---
        
        内容：
        ---
        ${e.content}
        ---
      `},async comparisonTemplate(){const e=await k.getDocFileInfo(this.doc);return`
        请将 《${this.doc}》 与其他相关概念或技术进行对比，突出它们之间的异同点。
        
        文本内容：
        ---
        ${e.content}
        ---
      `},async learningPathTemplate(){const e=await k.getDocFileInfo(this.doc),t=await k.getContentByDocId(this.doc),o=ie(t);return`
        基于 《${this.doc}》 的知识体系，请设计一个循序渐进的学习路径，包括前置知识、学习顺序和实践建议。
        
        目录：
        ---
        ${o}
        ---
        
        内容：
        ---
        ${e.content}
        ---
      `},async keyPointsTemplate(){const e=await k.getDocFileInfo(this.doc);return`
        请梳理 《${this.doc}》 的关键要点，并按重要性排序，提供简洁的摘要。
        
        文本内容：
        ---
        ${e.content}
        ---
      `},async caseStudyTemplate(){const e=await k.getDocFileInfo(this.doc);return`
        请基于 《${this.doc}》 的知识，提供一个相关的案例分析，包括背景、问题、解决方案和结果。
        
        文本内容：
        ---
        ${e.content}
        ---
      `},async misconceptionsTemplate(){const e=await k.getDocFileInfo(this.doc);return`
        指出在学习 《${this.doc}》 过程中常见的错误概念或误解，并提供正确的理解。
        
        文本内容：
        ---
        ${e.content}
        ---
      `},async relationsTemplate(){const e=await k.getDocFileInfo(this.doc),t=await k.getContentByDocId(this.doc),o=ie(t);return`
        分析 《${this.doc}》 与其他相关知识领域的关联，绘制知识关系图谱。
        
        目录：
        ---
        ${o}
        ---
        
        内容：
        ---
        ${e.content}
        ---
      `},handleQueryKeyUp(e){},handleCopy(){navigator.clipboard.writeText(this.query),Z.success("复制成功")}},async created(){this.query=await this.categoryTempalte()}}),Zl={class:"llm-container"};function ec(e,t,o,n,s,a){const r=lt,l=it,c=co,u=lo,m=pt,f=z,w=J;return h(),v(w,{modelValue:e.showDrawer,"onUpdate:modelValue":t[2]||(t[2]=L=>e.showDrawer=L),size:e.$isMobile()?"75%":"44%",direction:e.$isMobile()?"btt":"rtl",title:"模板生成问题",modal:!1,onClose:t[3]||(t[3]=L=>e.$emit("close")),"lock-scroll":!1,"modal-class":"operational-drawer-modal",class:"operational-drawer"},{default:d(()=>[p("div",Zl,[i(u,{gutter:12},{default:d(()=>[i(c,{span:24},{default:d(()=>[t[4]||(t[4]=_(" 问题模板： ",-1)),i(l,{modelValue:e.llmMode,"onUpdate:modelValue":t[0]||(t[0]=L=>e.llmMode=L),onChange:e.handleModeChange,style:{width:"100%"}},{default:d(()=>[(h(!0),g(D,null,I(e.presets,L=>(h(),v(r,{key:L.value,value:L.value,label:L.name},{default:d(()=>[_(C(L.name),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1})]),_:1}),i(m,{type:"textarea",rows:"15",modelValue:e.query,"onUpdate:modelValue":t[1]||(t[1]=L=>e.query=L),onKeyup:e.handleQueryKeyUp},null,8,["modelValue","onKeyup"]),i(u,{gutter:12,style:{"margin-top":"10px"}},{default:d(()=>[i(c,{span:24},{default:d(()=>[i(f,{type:"success",onClick:e.handleCopy,style:{width:"100%"}},{default:d(()=>[...t[5]||(t[5]=[_("复制提问",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1})])]),_:1},8,["modelValue","size","direction"])}const Zo=b(Xl,[["render",ec],["__scopeId","data-v-ec431ff3"]]),tc=y({inject:["showHeader"],components:{ContentsList:Oa,HistoryList:Va,MindGraph:Ro,MindNote:Xa,ToolBox:di,LinkPopover:bt,DocSideCategory:Gi,LinkList:oi,KnowledgeNetwork:qo,DocBreadcrumbNav:Xi,DocTabNav:ll,ResourceBrower:ml,ImageViewer:Uo,KnowledgeReviewer:Jo,DocMetadataInfo:Go,InstantPreviewer:Jl,MermaidShower:xo,LLM:Zo},watch:{showHeader:{handler(e){this.parentShowHeader=e},immediate:!0}},setup(){const e=W(),t=W(),o=W(),n=W(),s=W();return{mindGraph:e,showMindGraph:()=>{e.value?.show()},knowledgeNetwork:t,showKnowledgeNetwork:()=>{t.value?.show()},linkList:o,showLinkList:()=>{o.value?.show()},knowledgeReviewer:n,showKnowledgeReviewer:()=>{n.value?.show()},llm:s,showLLM:()=>{s.value?.show()}}},data(){return{file:new vt,contentsList:[],doc:"",kw:"",loading:!0,showAside:!0,isDrawerShow:!1,parentShowHeader:!0,eventManager:null}},computed:{contentHtml(){return k.renderMd(this.file)}},methods:{docUrl2Id(e){return k.docUrl2Id(e)},async handleCopyDocPath(){const e="/"+E.docId2Url(this.doc);await navigator.clipboard.writeText(e),Z.success("复制成功: "+e)},handleTocItemClick(e){const t=document.querySelector(".main.markdown-section")?.querySelectorAll("h1,h2,h3,h4,h5,h6");for(let o of t)if(o.id.replace(/<mark>/gi,"").replace(/<\/mark>/gi,"")==e){window.scrollTo(0,o.offsetTop-80);break}},handleTabNavDbclick(){this.syncCategoryListScrollBar()},syncCategoryListScrollBar(){this.$refs.docSideCategory.syncCategoryListScrollBar()},openInEditor(){window.open(`vscode://file/${G.localUrl}/${k.docId2Url(this.doc)}/`,"_blank")},async showDoc(e,t,o){window.scrollTo(0,k.getDocReadRecord(e)),this.loading=!0,this.doc=e,this.kw=o||"";try{this.file=await k.getDocFileInfo(e)}catch(n){Z.error(n.message)}N.setDocTitle(this.file.name),this.generateTOC(),this.$nextTick(()=>{const n=this.$refs.markdownSection;o||this.eventManager.renderMermaid(),this.eventManager.syncHeading(t),this.syncCategoryListScrollBar(),this.$refs.knowledgeNetwork.init(),this.eventManager.renderLatex(n),this.registerNecessaryEvent(n)}),this.loading=!1},registerNecessaryEvent(e){this.eventManager.registerLinkRouter(e),this.eventManager.registerImageClick(e),this.eventManager.registerHeadingClick(e),this.eventManager.registerDocTagSupClick(e),this.eventManager.registerTextSelected(e),this.eventManager.registerMermaidFullScreenClick(e)},generateTOC(){this.contentsList=k.getContent(this.contentHtml)}},beforeRouteUpdate(e,t){const o=e.params.doc.toString();this.showDoc(o,e.query.headingId?.toString(),e.query.kw?.toString()),this.$refs.docSideCategory.updateCurrentCategory(o)},beforeRouteLeave(){N.resetDocTitle()},async created(){this.eventManager=new Wo(this),this.eventManager.registerScrollListener(),this.eventManager.listenEventBus(),this.showDoc(this.$route.params.doc.toString(),this.$route.query.headingId?.toString(),this.$route.query.kw?.toString())},unmounted(){this.eventManager.removeAllScrollListener()}}),oc={class:"main-content"},nc=["innerHTML"],sc={style:{"text-align":"center"}},rc={class:"footer-wrapper"};function ac(e,t,o,n,s,a){const r=S("doc-side-category"),l=S("doc-tab-nav"),c=S("doc-breadcrumb-nav"),u=S("doc-metadata-info"),m=Kt,f=S("history-list"),w=S("contents-list"),L=S("mind-note"),$=ft,M=Fe,Y=Oe,F=S("tool-box"),Ct=S("link-popover"),nn=xn,sn=S("mind-graph"),rn=S("link-list"),an=S("knowledge-reviewer"),ln=S("mermaid-shower"),cn=S("knowledge-network"),dn=S("LLM"),un=Uo,hn=S("instant-previewer"),pn=S("resource-brower");return h(),g(D,null,[i(Y,null,{default:d(()=>[i(r,{doc:e.doc,showAside:e.showAside,onToggleAside:t[0]||(t[0]=se=>e.showAside=!e.showAside),ref:"docSideCategory"},null,8,["doc","showAside"]),i(M,{class:"main"},{default:d(()=>[(h(),v(le,null,[i(l,{onDbclick:e.handleTabNavDbclick},null,8,["onDbclick"])],1024)),i($,{rows:25,animated:"",loading:e.loading,throttle:50,style:{"max-width":"80%","margin-top":"20px",position:"fixed"}},{default:d(()=>[p("div",oc,[i(c),i(u,{file:e.file,onLinkClick:t[1]||(t[1]=se=>e.eventManager?.openOutterLink(se))},null,8,["file"]),p("div",{class:ee(["main markdown-section",{center:e.showAside}]),ref:"markdownSection",innerHTML:e.contentHtml,style:we({width:e.isDrawerShow?"920px":"74%"})},null,14,nc),p("div",sc,[i(m,{style:{width:"72%"}}),p("div",rc,[i(f,{file:e.file,doc:e.doc},null,8,["file","doc"])])]),p("div",{class:"toc-wrapper",style:we({top:e.parentShowHeader?"66px":"6px",height:e.parentShowHeader?"calc(80 % - 60px)":"80%"})},[(h(),v(le,null,[i(w,{doc:e.doc,onItemClick:e.handleTocItemClick},null,8,["doc","onItemClick"])],1024)),(h(),v(le,null,[i(L)],1024))],4)])]),_:1},8,["loading"])]),_:1})]),_:1}),i(F,{onShowMindGraph:t[2]||(t[2]=se=>{e.showMindGraph(),e.showAside=!1,e.isDrawerShow=!0}),onShowKnowledgeNetwork:t[3]||(t[3]=se=>{e.showKnowledgeNetwork(),e.showAside=!1,e.isDrawerShow=!0}),onCopyDocPath:e.handleCopyDocPath,onShowLinkList:e.showLinkList,onShowKnowledgeReviewer:e.showKnowledgeReviewer,onShowLlm:t[4]||(t[4]=se=>{e.showLLM(),e.showAside=!1,e.isDrawerShow=!0}),onOpenInEditor:e.openInEditor},null,8,["onCopyDocPath","onShowLinkList","onShowKnowledgeReviewer","onOpenInEditor"]),i(Ct,{ref:"linkPopover"},null,512),i(nn,{bottom:220,right:26}),i(sn,{ref:"mindGraph",onClose:t[5]||(t[5]=se=>{e.showAside=!0,e.isDrawerShow=!1})},null,512),i(rn,{html:e.contentHtml,ref:"linkList"},null,8,["html"]),i(an,{ref:"knowledgeReviewer",doc:e.doc},null,8,["doc"]),i(ln,{ref:"mermaidShower"},null,512),(h(),v(le,null,[i(cn,{ref:"knowledgeNetwork",doc:e.doc,onClose:t[6]||(t[6]=se=>{e.showAside=!0,e.isDrawerShow=!1})},null,8,["doc"])],1024)),(h(),v(le,null,[i(dn,{doc:e.doc,ref:"llm",onClose:t[7]||(t[7]=se=>{e.showAside=!0,e.isDrawerShow=!1})},null,8,["doc"])],1024)),i(un,{ref:"imageViewer"},null,512),i(hn,{ref:"instantPreviewer"},null,512),i(pn,{ref:"resourceBrower"},null,512)],64)}const ic=b(tc,[["render",ac],["__scopeId","data-v-fc3fa2a1"]]),lc=Object.freeze(Object.defineProperty({__proto__:null,default:ic},Symbol.toStringTag,{value:"Module"})),en={onSwipe(e,t){let o,n;e.addEventListener("touchstart",s=>{o=s}),e.addEventListener("touchend",s=>{n=s;const a=n.changedTouches[0].clientX-o.changedTouches[0].clientX,r=n.changedTouches[0].clientY-o.changedTouches[0].clientY;t([a>0?"right":"left",a>0?"down":"up"],[Math.abs(a),Math.abs(r)])})},onPress(e,t){let o=!1,n=0;const s=r=>(o=!0,n=new Date().getTime(),r.stopPropagation(),r.preventDefault(),!1),a=r=>{if(o){const l=new Date().getTime();t(l-n),o=!1}return r.stopPropagation(),r.preventDefault(),!1};e.addEventListener("touchstart",s),e.addEventListener("touchend",a),e.addEventListener("touchcancel",a)}},cc={class:"search-box-zone"},dc={class:"tag-zone"},uc={class:"data-container"},hc=y({data(){return{tags:[],checkedMap:{},kw:""}},methods:{docUrl2Id(e){return E.docUrl2Id(e)},randomType(e){return jo.calcTagType(e)},handleTagClick(e){this.checkedMap[e]?this.checkedMap[e]=!this.checkedMap[e]:this.checkedMap[e]=!0}},computed:{filtedTags(){return this.tags.filter(e=>e.tag.indexOf(this.kw)!=-1)},chapters(){const e=this.filtedTags.filter(t=>this.checkedMap[t.tag]).flatMap(t=>t.chapters);return Array.from(new Set(e))}},async created(){let e=(await P.getTagMapping()).map(t=>({tag:t[0],count:t[1].length,chapters:t[1]}));this.tags=e.map(t=>({tag:t.tag,type:this.randomType(t.tag),count:t.count,chapters:t.chapters})),en.onSwipe(this.$refs.container,(t,o)=>{t[0]=="right"&&o[0]>150&&history.back()})},mounted(){this.$route.query.tag&&(this.checkedMap[this.$route.query.tag.toString()]=!0)}}),pc=y({...hc,__name:"TagListPage",setup(e){return(t,o)=>{const n=x,s=pt,a=be;return h(),g("div",{class:ee(["container",{mobile:t.$isMobile()}]),ref:"container"},[p("div",cc,[i(s,{placeholder:"搜索标签",modelValue:t.kw,"onUpdate:modelValue":o[0]||(o[0]=r=>t.kw=r)},{prefix:d(()=>[i(n,{class:"el-input__icon",size:32},{default:d(()=>[i(T(uo))]),_:1})]),_:1},8,["modelValue"])]),p("div",dc,[i(Ht,{name:"list",tag:"p"},{default:d(()=>[(h(!0),g(D,null,I(t.filtedTags,r=>(h(),v(a,{key:r.tag,type:r.type,onClick:l=>t.handleTagClick(r.tag),effect:t.checkedMap[r.tag]?"dark":"light"},{default:d(()=>[_(C(r.tag)+"("+C(r.count)+")",1)]),_:2},1032,["type","onClick","effect"]))),128))]),_:1})]),p("div",uc,[i(Bo,{chapters:t.chapters},null,8,["chapters"])])],2)}}}),mc=b(pc,[["__scopeId","data-v-ec382014"]]),Bt=Object.freeze(Object.defineProperty({__proto__:null,default:mc},Symbol.toStringTag,{value:"Module"}));oe([he,fs,ne]);const fc=y({methods:{init(){var e=document.getElementById("docCluster"),t=te(e),o;t.showLoading();const n=this.$route.query.kw;function s(a){if(a){n&&a.name.indexOf(n)!=-1&&(a.label={fontSize:25,color:"red"});for(let r of a.children)s(r)}}P.getDocCluster().then(a=>{const r=a[0];s(r),t.hideLoading(),t.setOption(o={tooltip:{trigger:"item",triggerOn:"mousemove"},series:[{type:"tree",data:[r],top:"1%",left:"7%",bottom:"1%",right:"20%",edgeShape:"polyline",symbolSize:7,label:{position:"left",verticalAlign:"middle",align:"right",fontSize:15,lineHeight:55},leaves:{label:{position:"top",verticalAlign:"middle",align:"left",padding:20}},emphasis:{focus:"descendant"},expandAndCollapse:!1,animationDuration:550,roam:!0,animationDurationUpdate:750}]}),t.setOption(o)})}},mounted(){this.init()}}),gc={id:"docCluster",style:{height:"1080px",width:"100%"}};function wc(e,t,o,n,s,a){return h(),g("div",gc)}const yc=b(fc,[["render",wc]]),_c=Object.freeze(Object.defineProperty({__proto__:null,default:yc},Symbol.toStringTag,{value:"Module"})),kc={class:"header"},$c={class:"header-wrapper"},vc={class:"container"},bc={class:"logo"},Cc=y({emits:["showSearch","showCategorySearch"],computed:{siteName(){return G.siteName}},methods:{refresh(){location.reload()}}}),Sc=y({...Cc,__name:"MobileHeader",setup(e){return(t,o)=>{const n=ue,s=x,a=z;return h(),g("div",kc,[p("div",$c,[p("div",vc,[p("div",bc,[i(n,{href:"#",onClick:o[0]||(o[0]=de(r=>t.$router.push("/home"),["prevent"]))},{default:d(()=>[_(C(t.siteName),1)]),_:1})]),i(Mo),i(a,{size:"default",text:"",onClick:o[1]||(o[1]=r=>t.$emit("showSearch"))},{default:d(()=>[i(s,null,{default:d(()=>[i(T(uo))]),_:1})]),_:1}),i(a,{size:"default",text:"",onClick:o[2]||(o[2]=r=>t.$emit("showCategorySearch"))},{default:d(()=>[i(s,null,{default:d(()=>[i(T(Yn))]),_:1})]),_:1}),i(a,{size:"default",text:"",onClick:t.refresh},{default:d(()=>[i(s,null,{default:d(()=>[i(T(Qt))]),_:1})]),_:1},8,["onClick"]),i(a,{size:"default",text:"",onClick:o[3]||(o[3]=r=>t.$store.commit("setShowCategory",!0))},{default:d(()=>[i(s,null,{default:d(()=>[i(T(Xn))]),_:1})]),_:1})])])])}}}),tn=b(Sc,[["__scopeId","data-v-a0fa1aa6"]]),Dc=y({components:{MobileHeader:tn,Search:Ve,CategorySearch:je},methods:{showSearch(){this.$refs.search.show()},showCategorySearch(){this.$refs.categorySearch.show()}},setup(){}});function Lc(e,t,o,n,s,a){const r=tn,l=dt,c=Jt,u=S("router-view"),m=Fe,f=Oe,w=Ve,L=je;return h(),g(D,null,[i(f,{class:"mobile-layout",ref:"main"},{default:d(()=>[i(c,{class:"mobile-header"},{default:d(()=>[i(l,null,{default:d(()=>[i(r,{onShowSearch:e.showSearch,onShowCategorySearch:e.showCategorySearch},null,8,["onShowSearch","onShowCategorySearch"])]),_:1})]),_:1}),i(m,{class:"mobile-main"},{default:d(()=>[i(u,null,{default:d(({Component:$})=>[i(at,{name:"page",mode:"out-in"},{default:d(()=>[(h(),v(kn($)))]),_:2},1024)]),_:1})]),_:1})]),_:1},512),i(w,{ref:"search"},null,512),i(L,{ref:"categorySearch"},null,512)],64)}const Mc=b(Dc,[["render",Lc],["__scopeId","data-v-64c657bf"]]),Ic=Object.freeze(Object.defineProperty({__proto__:null,default:Mc},Symbol.toStringTag,{value:"Module"})),Tc=y({components:{Banner:zo,Statistic:Oo},setup(){}}),Ec={style:{width:"100%","overflow-x":"scroll"}};function Pc(e,t,o,n,s,a){const r=S("banner"),l=S("statistic");return h(),g(D,null,[i(r),p("div",Ec,[i(l)])],64)}const Ac=b(Tc,[["render",Pc],["__scopeId","data-v-49af17c8"]]),Fc=Object.freeze(Object.defineProperty({__proto__:null,default:Ac},Symbol.toStringTag,{value:"Module"})),Oc=y({components:{FullScreen:ot},data(){return{visible:!1,images:[],viewer:null}},mounted(){this.viewer=new os(this.$refs.images,{inline:!0,fullscreen:!0,viewed(e){},hide(e){console.log("hide event",e)}})},methods:{show(e,t){this.images=e,this.visible=!0,this.$nextTick(()=>{this.viewer.update(),this.viewer?.view(t)})}}}),zc={class:"mask"},Uc={ref:"images",style:{display:"none"}},Rc=["src"];function qc(e,t,o,n,s,a){const r=S("full-screen"),l=x,c=z;return ae((h(),g("div",zc,[i(c,{onClick:t[0]||(t[0]=u=>e.visible=!1),class:"close-btn",text:"",size:"large"},{default:d(()=>[i(l,null,{default:d(()=>[i(r)]),_:1})]),_:1}),p("ul",Uc,[(h(!0),g(D,null,I(e.images,u=>(h(),g("li",{key:u},[p("img",{src:u},null,8,Rc)]))),128))],512)],512)),[[ce,e.visible]])}const on=b(Oc,[["render",qc],["__scopeId","data-v-06ec9d75"]]),Bc=y({props:{doc:{required:!0,type:String}},computed:{showCategory:{get(){return this.$store.state.showCategory},set(e){this.$store.commit("setShowCategory",e)}}},watch:{showCategory(){this.showCategory&&this.$nextTick(()=>{this.syncCategoryListScrollBar()})}},methods:{handleFirstLoad(){this.$nextTick(()=>{this.syncCategoryListScrollBar()})},syncCategoryListScrollBar(){const e=document.querySelector(".el-menu-item.is-active");e&&e.scrollIntoView({behavior:"smooth"})}},components:{CategoryList:Ko,ArrowRightBold:io},data(){return{}}}),Hc={class:"mobile-category-wrapper"},jc={class:"drawer-header"},Vc={class:"category-content"};function Nc(e,t,o,n,s,a){const r=z,l=S("category-list"),c=J;return h(),v(c,{modelValue:e.showCategory,"onUpdate:modelValue":t[1]||(t[1]=u=>e.showCategory=u),direction:"rtl","with-header":!1,size:"70%","close-on-click-modal":!0,"append-to-body":!1,"custom-class":"mobile-category-drawer","show-close":!1},{default:d(()=>[p("div",Hc,[p("div",jc,[i(r,{type:"default",size:"small",onClick:t[0]||(t[0]=u=>e.showCategory=!1),icon:e.ArrowRightBold,circle:"",class:"close-btn"},null,8,["icon"]),t[2]||(t[2]=p("h3",{class:"drawer-title"},"目录",-1))]),p("div",Vc,[i(l,{doc:e.doc,onFirstLoad:e.handleFirstLoad},null,8,["doc","onFirstLoad"])])])]),_:1},8,["modelValue"])}const Kc=b(Bc,[["render",Nc],["__scopeId","data-v-61e983ad"]]),Qc=y({components:{Tools:oo},watch:{showHeader:{handler(e){this.parentShowHeader=e},immediate:!0}},emits:["showReadingHistory","showMindGraph","showKnowledgeNetwork","showBookMarkAdder","showBookMarkList","copyDocPath","showLinkList","goToDoc","goToPpt","showKnowledgeReviewer","showKnowledgeRedundancy","showKwFinder","showLlm"],data(){return{showDrawer:!1,fontSize:1,parentShowHeader:!0,actionList:[{name:"思维导图",type:"success",action:"showMindGraph"},{name:"知识网络",type:"warning",action:"showKnowledgeNetwork"},{name:"知识回顾",type:"primary",action:"showKnowledgeReviewer"},{name:"知识助手",type:"warning",action:"showLlm",divided:!0},{name:"文本搜索",type:"warning",action:"showKwFinder"}]}},methods:{localActionDispatch(e){switch(e){case"showMoreSetting":this.showDrawer=!0;break}},handleFontSizeChange(e){const t=document.querySelector(".markdown-section");t.style.fontSize=e+"px"}},setup(){},created(){},unmounted(){}}),Wc={position:"top",offset:20,class:"tool-box"},Jc={class:"more-setting-container"};function Gc(e,t,o,n,s,a){const r=S("tools"),l=x,c=z,u=so,m=no,f=ro,w=ht,L=J;return h(),g(D,null,[p("div",Wc,[i(f,null,{dropdown:d(()=>[i(m,null,{default:d(()=>[(h(!0),g(D,null,I(e.actionList,$=>(h(),v(u,{key:$.name,divided:$.divided||!1},{default:d(()=>[i(c,{class:"box-item",onClick:M=>$.local?e.localActionDispatch($.action):e.$emit($.action),type:$.type,size:"small"},{default:d(()=>[_(C($.name),1)]),_:2},1032,["onClick","type"])]),_:2},1032,["divided"]))),128))]),_:1})]),default:d(()=>[p("div",null,[i(c,{type:"primary",round:"",size:"small",class:"fix-button"},{default:d(()=>[i(l,{style:{"vertical-align":"middle"}},{default:d(()=>[i(r)]),_:1}),t[2]||(t[2]=_(" 工具栏 ",-1))]),_:1})])]),_:1})]),i(L,{modelValue:e.showDrawer,"onUpdate:modelValue":t[1]||(t[1]=$=>e.showDrawer=$),title:"更多设置","lock-scroll":!1},{default:d(()=>[p("div",Jc,[p("div",null,[t[3]||(t[3]=p("span",null,"字体大小",-1)),i(w,{modelValue:e.fontSize,"onUpdate:modelValue":t[0]||(t[0]=$=>e.fontSize=$),min:16,max:48,step:1,onInput:e.handleFontSizeChange},null,8,["modelValue","onInput"])])])]),_:1},8,["modelValue"])],64)}const xc=b(Qc,[["render",Gc],["__scopeId","data-v-74bc39e1"]]),Yc=y({components:{MobileDocSideCategory:Kc,LinkPopover:bt,MobileImageViewer:on,MobileToolBox:xc,KnowledgeReviewer:Jo,KnowledgeNetwork:qo,DocMetadataInfo:Go,MindGraph:Ro,MermaidShower:xo,LLM:Zo},setup(){const e=W(),t=W(),o=W(),n=W();return{knowledgeReviewer:e,showKnowledgeReviewer:()=>{e.value?.show()},knowledgeNetwork:t,showKnowledgeNetwork:()=>{t.value?.show()},mindGraph:o,showMindGraph:()=>{o.value?.show()},llm:n,showLLM:()=>{n.value?.show()}}},computed:{contentHtml(){return k.renderMd(this.file)}},data(){return{doc:"",file:new vt,eventManager:null,kw:""}},methods:{async init(e,t,o){this.file=await k.getDocFileInfo(this.doc),this.kw=o||"",this.$nextTick(()=>{const n=this.$refs.markdownSection;document.body.scrollTo(0,k.getDocReadRecord(this.doc)),this.eventManager.renderMermaid(),this.eventManager.syncHeading(t),this.eventManager.renderLatex(n),this.registerNecessaryEvent(n)})},registerNecessaryEvent(e){this.eventManager?.registerImageClick(e),this.eventManager.registerLinkRouter(e),this.eventManager.registerTextSelected(e),this.eventManager.registerMermaidFullScreenClick(e)}},beforeRouteUpdate(e,t){this.doc=e.params.doc.toString();const o=e.query.headingId?.toString(),n=this.$route.query.kw?.toString();this.init(this.doc,o,n)},mounted(){en.onSwipe(this.$refs.markdownSection,(e,t)=>{console.log(e,t),e[0]=="left"&&t[0]>150&&(this.$refs.docSideCategory.showCategory=!0),e[0]=="right"&&t[0]>150&&history.back(),e[1]=="down"&&t[1]>500&&location.reload()})},async created(){this.doc=this.$route.params.doc.toString();const e=this.$route.query.headingId?.toString(),t=this.$route.query.kw?.toString();this.init(this.doc,e,t),this.eventManager=new Wo(this,!0),this.eventManager.registerScrollListener()}}),Xc=["innerHTML"];function Zc(e,t,o,n,s,a){const r=S("mobile-doc-side-category"),l=S("doc-metadata-info"),c=Fe,u=Oe,m=S("link-popover"),f=S("mind-graph"),w=on,L=S("knowledge-reviewer"),$=S("knowledge-network"),M=S("mermaid-shower"),Y=S("mobile-tool-box"),F=S("LLM");return h(),g(D,null,[i(u,null,{default:d(()=>[i(r,{doc:e.doc,ref:"docSideCategory"},null,8,["doc"]),i(c,null,{default:d(()=>[i(l,{file:e.file},null,8,["file"]),p("div",{class:"markdown-section",innerHTML:e.contentHtml,ref:"markdownSection"},null,8,Xc)]),_:1})]),_:1}),i(m,{ref:"linkPopover"},null,512),i(f,{ref:"mindGraph"},null,512),i(w,{ref:"imageViewer"},null,512),i(L,{ref:"knowledgeReviewer",doc:e.doc},null,8,["doc"]),i($,{ref:"knowledgeNetwork",doc:e.doc},null,8,["doc"]),i(M,{ref:"mermaidShower"},null,512),i(Y,{onShowMindGraph:e.showMindGraph,onShowKnowledgeReviewer:e.showKnowledgeReviewer,onShowKnowledgeNetwork:e.showKnowledgeNetwork,onShowLlm:e.showLLM},null,8,["onShowMindGraph","onShowKnowledgeReviewer","onShowKnowledgeNetwork","onShowLlm"]),i(F,{doc:e.doc,ref:"llm"},null,8,["doc"])],64)}const ed=b(Yc,[["render",Zc],["__scopeId","data-v-5092fae9"]]),td=Object.freeze(Object.defineProperty({__proto__:null,default:ed},Symbol.toStringTag,{value:"Module"}));export{X as _,hd as c,pd as g};
