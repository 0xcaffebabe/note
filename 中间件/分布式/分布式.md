# 分布式

## 分布式Session

### 集群产生的问题

服务器集群后，因为session是存放在服务器上，客户端会使用同一个Sessionid在多个不同的服务器上获取对应的Session，从而会导致Session不一致问题

### 解决方案

- cookie代替session
- nginx将同一个ip的请求都转发到同一台服务器
- 使用数据库存储session
- 使用web容器的session同步
- 使用redis存储session
- token

### SpringSession 使用redis存储session

- 依赖

```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-data-redis</artifactId>
</dependency>
<dependency>
    <groupId>org.springframework.session</groupId>
    <artifactId>spring-session-data-redis</artifactId>
</dependency>
```

- 配置

```java
@EnableRedisHttpSession
```

这时候，Session的存取都是通过redis来了