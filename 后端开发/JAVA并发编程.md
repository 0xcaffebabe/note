# 线程安全性

>当多个线程访问某个类时，这个类始终都能表现出正确的行为，则称这个类是线程安全的

- 无状态对象一定是线程安全的

## 原子性

```java
if (condition){
    a++; // 当此段代码运行在多线程的环境时，则会产生线程安全问题
}
```

观察结果的失效就是大多数竞态条件的本质

一种常见的竞态条件发生在单例构造模式中：

```java
public static Object get(){

    if (instance == null){
        instance = new Object();
    }
    return instance;
}
```

- 复合操作：由一系列原子操作构成

## 加锁机制

- 内置锁:`synchronized`关键字

>重入：某个线程试图获得一个已经由它持有的锁

锁能使其保护的代码路径以串行形式访问

- 对持有锁的范围、时间进行良好设计



