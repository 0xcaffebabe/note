{"name":"Linuxæ€§èƒ½ä¼˜åŒ–","id":"æ“ä½œç³»ç»Ÿ-linux-Linuxæ€§èƒ½ä¼˜åŒ–","content":"# Linux æ€§èƒ½ä¼˜åŒ–\n\n## ä¸€ã€æ€»è®ºï¼šLinux æ€§èƒ½ä¼˜åŒ–çš„ç¬¬ä¸€æ€§åŸç†\n\n### 1. æ€§èƒ½çš„æœ¬è´¨\n\nLinux æ€§èƒ½é—®é¢˜å¹¶éâ€œå‚æ•°ä¸åˆç†â€æˆ–â€œæœºå™¨ä¸å¤Ÿå¥½â€ï¼Œå…¶æœ¬è´¨æ˜¯ï¼š\n\n> **æœ‰é™èµ„æºåœ¨æ—¶é—´ä¸ç©ºé—´ç»´åº¦ä¸Šçš„åˆ†é…å¤±è¡¡**\n\næ‰€æœ‰æ€§èƒ½é—®é¢˜ï¼Œéƒ½å¯ä»¥å½’çº¦ä¸ºä»¥ä¸‹å››ç±»ä¸å˜é—®é¢˜ï¼š\n\n| ç»´åº¦ | æœ¬è´¨é—®é¢˜         | å…¸å‹ç—‡çŠ¶            |\n| -- | ------------ | --------------- |\n| è®¡ç®— | CPU æ˜¯å¦è¢«é«˜æ•ˆä½¿ç”¨  | us/sys é«˜ã€cs é«˜   |\n| å­˜å‚¨ | æ•°æ®æ˜¯å¦åœ¨â€œæœ€è¿‘çš„åœ°æ–¹â€ | cache missã€swap |\n| é˜Ÿåˆ— | ç­‰å¾…æ˜¯å¦å¤±æ§       | load é«˜ã€å»¶è¿ŸæŠ–åŠ¨     |\n| åè°ƒ | è°ƒåº¦ä¸å¹¶å‘æ˜¯å¦åˆç†    | æŠ¢å ã€é”ç«äº‰          |\n\nåç»­æ‰€æœ‰ CPU / å†…å­˜ / IO / ç½‘ç»œå†…å®¹ï¼Œå‡æ˜¯è¿™å››ä¸ªç»´åº¦åœ¨ä¸åŒå­ç³»ç»Ÿä¸­çš„å…·ä½“ä½“ç°ã€‚\n\n---\n\n## äºŒã€æ€§èƒ½åˆ†æçš„ç»Ÿä¸€æ–¹æ³•è®º\n\n### 1. æ€§èƒ½é—®é¢˜çš„æ ‡å‡†åˆ†æè·¯å¾„\n\n> ç°è±¡ â†’ æŒ‡æ ‡ â†’ å½’å› æ¨¡å‹ â†’ å†³ç­–åŸåˆ™ â†’ ä¼˜åŒ–æ‰‹æ®µ\n\né¿å…ç›´æ¥â€œçœ‹åˆ°æŒ‡æ ‡å°±è°ƒå‚â€ã€‚\n\n### 2. æ€§èƒ½æŒ‡æ ‡çš„ä¸‰å±‚ç»“æ„\n\n1. **ç—‡çŠ¶æŒ‡æ ‡**ï¼šloadã€latencyã€QPS\n2. **å› æœæŒ‡æ ‡**ï¼šCPU ä½¿ç”¨ç‡ã€iowaitã€é˜Ÿåˆ—é•¿åº¦\n3. **æœºåˆ¶æŒ‡æ ‡**ï¼šç¼ºé¡µå¼‚å¸¸ã€ä¸Šä¸‹æ–‡åˆ‡æ¢ã€ä¸­æ–­\n\n---\n\n## ä¸‰ã€CPU æ€§èƒ½ï¼šè®¡ç®—ä¸è°ƒåº¦\n\n### 1. æœ¬è´¨æ¨¡å‹\n\nCPU æ€§èƒ½é—®é¢˜ = **è®¡ç®—è´Ÿè½½ + è°ƒåº¦ç­–ç•¥ + å¹¶å‘åè°ƒ**\n\n### 2. æ ¸å¿ƒå¯è§‚æµ‹æŒ‡æ ‡\n\n* Load Averageï¼ˆè¿è¡Œé˜Ÿåˆ— + ä¸å¯ä¸­æ–­ç¡çœ ï¼‰\n* CPU ä½¿ç”¨ç‡ï¼ˆus/sys/wa/si/hiï¼‰\n* ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ˆcswch / nvcswchï¼‰\n\n### 3. é—®é¢˜å½’å› æ¨¡å‹\n\n```text\nLoad é«˜ â†’\n  â”œâ”€ us é«˜ â†’ è®¡ç®—å¯†é›†\n  â”œâ”€ sys é«˜ â†’ å†…æ ¸/ä¸­æ–­\n  â”œâ”€ wa é«˜ â†’ IO é˜»å¡\n  â””â”€ cs é«˜ â†’ è°ƒåº¦/å¹¶å‘é—®é¢˜\n```\n\n### 4. ç­–ç•¥åˆ†å±‚\n\n* **è°ƒåº¦éš”ç¦»**ï¼šCPU ç»‘å®šã€cpusetã€cgroups\n* **ä¼˜å…ˆçº§æ§åˆ¶**ï¼šnice / sched policy\n* **æ‹“æ‰‘æ„ŸçŸ¥**ï¼šNUMA æœ¬åœ°æ€§\n* **ä¸­æ–­æ²»ç†**ï¼širqbalance / affinity\n\n### 5. ç¨³å®šè®¤çŸ¥\n\n* CPU æ°¸è¿œåœ¨â€œå…¬å¹³â€ä¸â€œå±€éƒ¨æ€§â€ä¹‹é—´æƒè¡¡\n* è¿‡åº¦ç»‘å®šä¼šé™ä½ç³»ç»Ÿå¼¹æ€§\n\n---\n\n## å››ã€å†…å­˜æ€§èƒ½ï¼šå±€éƒ¨æ€§ä¸å›æ”¶\n\n### 1. æœ¬è´¨æ¨¡å‹\n\nå†…å­˜æ€§èƒ½ = **å‘½ä¸­ç‡ Ã— å›æ”¶æˆæœ¬**\n\n### 2. å†…å­˜åˆ†å±‚è§†è§’\n\n* CPU Cache\n* Page Cache\n* Slab Cache\n* Swap\n\n### 3. å¯è§‚æµ‹æŒ‡æ ‡\n\n* available memory\n* major/minor page fault\n* swap in/out\n\n### 4. å›æ”¶ä¸å‹åŠ›æ¨¡å‹\n\nkswapd åŸºäº pages_min/low/high è¿›è¡Œå›æ”¶å†³ç­–ï¼Œæœ¬è´¨æ˜¯ï¼š\n\n> **å»¶è¿Ÿå›æ”¶ï¼Œé¿å…æŠ–åŠ¨**\n\n### 5. ç­–ç•¥åˆ†å±‚\n\n* ç»“æ„æ€§ç­–ç•¥ï¼šå‡å°‘åŠ¨æ€åˆ†é…ã€å¯¹è±¡æ± \n* ç³»ç»Ÿæ€§ç­–ç•¥ï¼šswappinessã€cgroups memory\n* æ¶æ„æ€§ç­–ç•¥ï¼šç¼“å­˜å‰ç§»ã€å¤–éƒ¨ç¼“å­˜\n\n---\n\n## äº”ã€IO æ€§èƒ½ï¼šå¸¦å®½ã€å»¶è¿Ÿä¸é˜Ÿåˆ—\n\n### 1. æœ¬è´¨æ¨¡å‹\n\nIO æ€§èƒ½ = **è®¾å¤‡èƒ½åŠ› Ã— è®¿é—®æ¨¡å¼ Ã— é˜Ÿåˆ—æ²»ç†**\n\n### 2. IO æ ˆç»Ÿä¸€è§†è§’\n\nåº”ç”¨ â†’ æ–‡ä»¶ç³»ç»Ÿ â†’ é€šç”¨å—å±‚ â†’ è°ƒåº¦å™¨ â†’ è®¾å¤‡\n\n### 3. æ ¸å¿ƒæŒ‡æ ‡\n\n* IOPS\n* ååé‡\n* å“åº”æ—¶é—´\n* é¥±å’Œåº¦\n\n### 4. å†³ç­–åŸåˆ™\n\n* éšæœº IO çœ‹ IOPS\n* é¡ºåº IO çœ‹åå\n* å»¶è¿Ÿæ•æ„Ÿç³»ç»Ÿä¼˜å…ˆ deadline\n\n### 5. ä¼˜åŒ–ç­–ç•¥åˆ†å±‚\n\n* åº”ç”¨å±‚ï¼šæ‰¹é‡ã€é¡ºåºåŒ–ã€é›¶æ‹·è´\n* ç³»ç»Ÿå±‚ï¼šPageCacheã€å¼‚æ­¥ IO\n* è®¾å¤‡å±‚ï¼šSSDã€RAIDã€è°ƒåº¦ç®—æ³•\n\n---\n\n## å…­ã€ç½‘ç»œæ€§èƒ½ï¼šRTTã€å¸¦å®½ä¸é˜Ÿåˆ—\n\n### 1. æœ¬è´¨æ¨¡å‹\n\nç½‘ç»œæ€§èƒ½ = **RTT Ã— BDP Ã— é˜Ÿåˆ—ç®¡ç†**\n\n### 2. æ”¶å‘è·¯å¾„æŠ½è±¡\n\nDMA â†’ ä¸­æ–­ â†’ softirq â†’ åè®®æ ˆ â†’ socket buffer\n\n### 3. æ ¸å¿ƒæŒ‡æ ‡\n\n* RTT\n* Recv-Q / Send-Q\n* ä¸¢åŒ…ç‡\n\n### 4. è°ƒä¼˜åŸåˆ™\n\n* æ¡æ‰‹ä¼˜åŒ–è§£å†³è¿æ¥å»ºç«‹æˆæœ¬\n* ç¼“å†²åŒºä¼˜åŒ–è§£å†³å¸¦å®½åˆ©ç”¨\n* æ‹¥å¡æ§åˆ¶å†³å®šé•¿æœŸåå\n\n### 5. é£é™©æç¤º\n\n* è¿‡åº¦å…³é—­ ICMP ä¼šé™ä½å¯è¯Šæ–­æ€§\n* tcp_tw_reuse éœ€è°¨æ…\n\n---\n\n## ä¸ƒã€å†…æ ¸çº¿ç¨‹ä¸åå°æœºåˆ¶\n\n### 1. æ ¸å¿ƒå†…æ ¸çº¿ç¨‹è§’è‰²\n\n* kswapdï¼šå†…å­˜å›æ”¶\n* kworkerï¼šå¼‚æ­¥å†…æ ¸ä»»åŠ¡\n* migrationï¼šè´Ÿè½½å‡è¡¡\n* jbd2ï¼šæ–‡ä»¶ç³»ç»Ÿä¸€è‡´æ€§\n\n### 2. æ²»ç†è§†è§’\n\nå†…æ ¸çº¿ç¨‹æ˜¯ç³»ç»Ÿâ€œéšå½¢è´Ÿè½½â€ï¼Œä¸å¯å¿½è§†\n\n---\n\n## å…«ã€ç³»ç»Ÿçº§æ€§èƒ½æ²»ç†\n\n### 1. æ€§èƒ½ä¸æ˜¯è°ƒå‚é—®é¢˜\n\nè€Œæ˜¯ï¼š\n\n* æ¶æ„è¾¹ç•Œé—®é¢˜\n* éš”ç¦»ä¸é…é¢é—®é¢˜\n* å®¹é‡è§„åˆ’é—®é¢˜\n\n### 2. æ¨èæ²»ç†å·¥å…·\n\n* cgroups\n* NUMA-aware éƒ¨ç½²\n* å¯è§‚æµ‹æ€§ï¼ˆæŒ‡æ ‡ + è¿½è¸ªï¼‰\n\n---\n\n## ä¹ã€ç¨³å®šçŸ¥è¯† vs æ˜“å˜å®ç°\n\n### ç¨³å®šä¸å˜\n\n* å±€éƒ¨æ€§åŸç†\n* é˜Ÿåˆ—ä¸ç­‰å¾…\n* è°ƒåº¦ä¸å…¬å¹³\n\n### æ˜“å˜å®ç°\n\n* å…·ä½“è°ƒåº¦å™¨\n* å…·ä½“ sysctl å‚æ•°\n* å…·ä½“ offload æŠ€æœ¯\n\n---\n\n## åã€ç»“è¯­\n\næ€§èƒ½ä¼˜åŒ–ä¸æ˜¯â€œæŠŠç³»ç»Ÿæ‹§åˆ°æœ€å¿«â€ï¼Œè€Œæ˜¯ï¼š\n\n> **åœ¨çº¦æŸæ¡ä»¶ä¸‹ï¼Œæ„å»ºå¯é¢„æµ‹ã€å¯æ²»ç†ã€å¯æ¼”è¿›çš„ç³»ç»Ÿè¡Œä¸º**\n\n## å…³è”å†…å®¹ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰\n\n- [/æ“ä½œç³»ç»Ÿ/å†…å­˜ç®¡ç†.md](/æ“ä½œç³»ç»Ÿ/å†…å­˜ç®¡ç†.md) ä¸æœ¬æ–‡å†…å­˜æ€§èƒ½éƒ¨åˆ†å¯†åˆ‡ç›¸å…³ï¼Œæ¢è®¨äº†å†…å­˜åˆ†é…ã€è™šæ‹Ÿå†…å­˜å’Œé¡µé¢ç½®æ¢ç­‰å…³é”®æŠ€æœ¯\n- [/æ“ä½œç³»ç»Ÿ/è¿›ç¨‹ä¸çº¿ç¨‹.md](/æ“ä½œç³»ç»Ÿ/è¿›ç¨‹ä¸çº¿ç¨‹.md) ä¸æœ¬æ–‡CPUè°ƒåº¦éƒ¨åˆ†ç›¸å…³ï¼Œè¯¦ç»†ä»‹ç»äº†è¿›ç¨‹å’Œçº¿ç¨‹çš„ç®¡ç†å’Œè°ƒåº¦æœºåˆ¶\n- [/è®¡ç®—æœºç³»ç»Ÿ/ç¨‹åºç»“æ„å’Œæ‰§è¡Œ/ä¼˜åŒ–ç¨‹åºæ€§èƒ½.md](/è®¡ç®—æœºç³»ç»Ÿ/ç¨‹åºç»“æ„å’Œæ‰§è¡Œ/ä¼˜åŒ–ç¨‹åºæ€§èƒ½.md) ä»åº•å±‚ç¨‹åºæ‰§è¡Œè§’åº¦æ¢è®¨æ€§èƒ½ä¼˜åŒ–ï¼Œä¸æœ¬æ–‡ç³»ç»Ÿå±‚é¢ä¼˜åŒ–ç›¸è¾…ç›¸æˆ\n- [/è½¯ä»¶å·¥ç¨‹/æ€§èƒ½å·¥ç¨‹/æ€§èƒ½ä¼˜åŒ–.md](/è½¯ä»¶å·¥ç¨‹/æ€§èƒ½å·¥ç¨‹/æ€§èƒ½ä¼˜åŒ–.md) ä»å·¥ç¨‹è§’åº¦æ¢è®¨æ€§èƒ½ä¼˜åŒ–æ–¹æ³•è®ºï¼Œä¸æœ¬æ–‡çš„æŠ€æœ¯å®ç°å½¢æˆäº’è¡¥\n- [/æ“ä½œç³»ç»Ÿ/linux/Linux.md](/æ“ä½œç³»ç»Ÿ/linux/Linux.md) Linuxç³»ç»Ÿæ€»ä½“æ¦‚è¿°ï¼Œä¸ºæ·±å…¥ç†è§£æ€§èƒ½ä¼˜åŒ–æä¾›äº†èƒŒæ™¯çŸ¥è¯†\n- [/æ“ä½œç³»ç»Ÿ/linux/å†…æ ¸.md](/æ“ä½œç³»ç»Ÿ/linux/å†…æ ¸.md) ä¸Linuxå†…æ ¸ç›¸å…³çš„æ€§èƒ½ä¼˜åŒ–ï¼Œæœ‰åŠ©äºç†è§£ç³»ç»Ÿåº•å±‚æœºåˆ¶\n- [/è®¡ç®—æœºç½‘ç»œ/Linuxè™šæ‹ŸåŒ–.md](/è®¡ç®—æœºç½‘ç»œ/Linuxè™šæ‹ŸåŒ–.md) ä¸Linuxç³»ç»Ÿè™šæ‹ŸåŒ–ç›¸å…³çš„æ€§èƒ½è€ƒé‡ï¼Œæ‰©å±•äº†æ€§èƒ½ä¼˜åŒ–çš„åº”ç”¨åœºæ™¯\n","metadata":"tags: ['æ“ä½œç³»ç»Ÿ']","hasMoreCommit":true,"totalCommits":16,"commitList":[{"date":"2026-02-12T14:07:03+08:00","author":"MY","message":"doc: æ•´ç†æ ‡ç­¾","hash":"290b3e8ad18f48832ac282290238d020fc030a88"},{"date":"2026-01-21T17:54:11+08:00","author":"MY","message":"docs(linux): æ›´æ–°Linuxæ€§èƒ½ä¼˜åŒ–æ–‡æ¡£å†…å®¹å¹¶æ·»åŠ ç›¸å…³å›¾ç‰‡èµ„æº","hash":"42b0154ffdf65e1be29d4902832a2b1fd18fc9a5"},{"date":"2025-11-16T21:30:56+08:00","author":"MY","message":"docs: ç»Ÿä¸€å¹¶ç²¾ç®€æ–‡æ¡£æ ‡ç­¾","hash":"21362e9d7aeb62e05364cd5e7f3a3c24d7e293c7"},{"date":"2025-09-21T14:03:43+08:00","author":"MY","message":"docs(mindmap): ç»Ÿä¸€æ€ç»´å¯¼å›¾æ ¹èŠ‚ç‚¹æ ¼å¼","hash":"44fc90fa0f22040d171dbf83cd6f2fd8c020444a"},{"date":"2024-11-27T16:25:26+08:00","author":"MY","message":"ğŸ“¦å®¹å™¨åŒ–","hash":"e562244320baadb10ffbe0aef6ff9679da0f475a"},{"date":"2024-11-21T19:08:00+08:00","author":"MY","message":"ğŸ“¦æ€§èƒ½ç›¸å…³","hash":"340d03e0ac71d5d14daa022cce236600abece443"},{"date":"2024-05-28T19:53:40+08:00","author":"MY","message":"âœç›‘æ§","hash":"86620b7aeaf14cd9f9f392c4fc8ee5a3f9be003c"},{"date":"2024-02-04T19:31:43+08:00","author":"MY","message":"âœLinuxæ€§èƒ½ä¼˜åŒ–","hash":"81907c1d6ce35881cb26aa99a102f628dedef56a"},{"date":"2024-02-01T19:14:42+08:00","author":"MY","message":"âœLinuxæ€§èƒ½ä¼˜åŒ–","hash":"e7036b91ec32d08606577979cb58bc1142b15a14"},{"date":"2024-01-30T19:54:27+08:00","author":"MY","message":"âœLinuxæ€§èƒ½ä¼˜åŒ–","hash":"f31877466e59d4799bdcaba77512266bd195a4ff"}],"createTime":"2024-01-22T19:56:24+08:00"}