# 内存管理
[toc]
**分层存储器体系**
**存储管理器**：操作系中管理分层存储器体系的部分
## 无存储器抽象
*PSW（程序状态字）*
IBM 360系统的不用交换运行多个程序
*思考：避免绝对物理地址的引用*
## 存储器抽象：地址空间
### 概念
运行多个程序互相不影响，需要解决两问题：
- 保护
- 重定位
**基址寄存器与界限寄存器**
*动态重定位*

### 交换技术
*内存不足时写回到磁盘*
**内存压缩**：将小空闲区合并成一大块
### 空闲内存管理
- 使用位图的存储管理
- 使用链表
    - 首次适配算法
    - 下次适配算法
    - 最佳适配算法
    - 最差适配算法
    - 快速适配算法
## 虚拟内存
地址空间被分为多块，每块称作**页**
页被映射到物理内存，如果程序引用不存在的物理内存
由操作系统负责将缺失的部分装入物理内存
### 分页
**内存管理单元（MMU）**
**缺页中断**：当访问的页没有映射到物理内存中时，操作系统会将其他的页写到磁盘，将空出来的内存映射给当前的页
### 页表
- 页表项的结构
    - 保护位：允许什么类型的访问（读、写、执行）
    - 修改位：判断页面是否被写过
    - 访问位：判断页面是否被访问过
    - 高速缓存禁止位
### 加速分页过程
分页系统需要考虑的2个问题：
- 虚拟地址映射到物理地址必须非常快
- 如果虚拟地址空间很大，则页表也会很大

**转换检测缓冲区（TLB）**：小型硬件设备，能直接将虚拟地址映射成物理地址，而无需访问页表（二八定律）
### 软件TLB管理


