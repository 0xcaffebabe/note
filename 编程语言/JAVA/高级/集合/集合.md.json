{"name":"é›†åˆ","id":"ç¼–ç¨‹è¯­è¨€-JAVA-é«˜çº§-é›†åˆ-é›†åˆ","content":"# é›†åˆ\n\n> é›†åˆæ˜¯javaä¸­æä¾›çš„ä¸€ç§å®¹å™¨ï¼Œå¯ä»¥ç”¨æ¥å­˜å‚¨å¤šä¸ªæ•°æ®\n\n## ç±»å±‚æ¬¡ç»“æ„\n\n```mermaid\nmindmap\n    root((å®¹å™¨))\n        Collection\n            List[List]\n                CopyOnWriteList\n                ArrayList\n                Vector\n                    Stack\n                LinkedList\n            Set(Set)\n                HashSet\n                    LinkedHashSet\n                SortedSet\n                    TreeSet\n                CopyOnWriteArraySet\n                ConcurrentSkipListSet\n            Queue((Queue))\n                Deque{{Deque}}\n                    ArrayDeque\n                    BlockingDeque\n                        LinkedBlockingDeque\n                BlockingQueue))BlockingQueue((\n                    ArrayBlockingQueue\n                    PriorityBlockingQueue\n                    LinkedBlockingQueue\n                    TransferQueue\n                        LinkedTransferQueue\n                    SynchronousQueue\n                PriorityQueue\n                ConcurrentLinkedQueue\n                DelayQueue\n        Map \n            HashMap\n                LinkedHashMap\n            TreeMap\n            WeakHashMap\n            IdentityHashMap\n\n```\n\n- List å­˜å‚¨ä¸€ç»„ä¸å”¯ä¸€ï¼ˆå¯ä»¥æœ‰å¤šä¸ªå…ƒç´ å¼•ç”¨ç›¸åŒçš„å¯¹è±¡ï¼‰ï¼Œæœ‰åºçš„å¯¹è±¡\n- Set ä¸å…è®¸é‡å¤çš„é›†åˆã€‚ä¸ä¼šæœ‰å¤šä¸ªå…ƒç´ å¼•ç”¨ç›¸åŒçš„å¯¹è±¡\n- Queue è¢«è®¾è®¡ç”¨æ¥å¯ä»¥ä»¥æŸç§ä¼˜å…ˆçº§å¤„ç†å…ƒç´ çš„é›†åˆ\n- Map ä½¿ç”¨é”®å€¼å¯¹å­˜å‚¨ã€‚Mapä¼šç»´æŠ¤ä¸Keyæœ‰å…³è”çš„å€¼\n\nå¯ä»¥å­¦ä¹ äººå®¶çš„æ¥å£æ˜¯æ€ä¹ˆåˆ’åˆ†çš„ï¼Œè¿™ä¸ªç±»è™½ç„¶æ¥å£ä¼—å¤šï¼Œä½†æ˜¯èŒè´£å´å¾ˆæ¸…æ™°\n\nä»¥åŠäººå®¶æ˜¯å¦‚ä½•å¤ç”¨å·²æœ‰çš„ä»£ç æ¥å®ç°æ–°åŠŸèƒ½\n\n## Iteratorè¿­ä»£å™¨\n\n```java\nIterator<String> it = coll.iterator();\nwhile(it.hasNext()){ //åˆ¤æ–­æ˜¯å¦æœ‰è¿­ä»£å…ƒç´ \n    String s = it.next();//è·å–è¿­ä»£å‡ºçš„å…ƒç´ \n    System.out.println(s);\n}\n```\n\n## List\n\nList é›†åˆçš„éå†ç»“æœæ˜¯ç¨³å®šçš„\n\n- ArrayList\n    - éçº¿ç¨‹å®‰å…¨\n    - å†…éƒ¨ä½¿ç”¨æ•°ç»„\n    - å¿«é€Ÿéšæœºè®¿é—® æ’å…¥åˆ é™¤æ…¢\n- LinkedList\n    - æœ¬è´¨åŒå‘é“¾è¡¨\n    - æ’å…¥åˆ é™¤å¿« éšæœºè®¿é—®æ…¢\n    - å†…å­˜åˆ©ç”¨ç‡è¾ƒé«˜\n\n### å¸¸ç”¨æ–¹æ³•\n\n- public void add(int index, E element) : å°†æŒ‡å®šçš„å…ƒç´ ï¼Œæ·»åŠ åˆ°è¯¥é›†åˆä¸­çš„æŒ‡å®šä½ç½®ä¸Šã€‚ -\n- public E get(int index) :è¿”å›é›†åˆä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ã€‚\n- public E remove(int index) : ç§»é™¤åˆ—è¡¨ä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ , è¿”å›çš„æ˜¯è¢«ç§»é™¤çš„å…ƒç´ ã€‚\n- public E set(int index, E element) :ç”¨æŒ‡å®šå…ƒç´ æ›¿æ¢é›†åˆä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ,è¿”å›å€¼çš„æ›´æ–°å‰çš„å…ƒç´ \n\n## Queue\n\n- FIFO\n- é˜»å¡é˜Ÿåˆ—é˜»å¡çš„ç‰¹æ€§ä¸FIFOç»“åˆ é€‚åˆåšBuffer\n\n## Mapé›†åˆ\n\n- Collection æ¥å£å®šä¹‰äº†å•åˆ—é›†åˆè§„èŒƒï¼Œæ¯æ¬¡å­˜å‚¨ä¸€ä¸ªå…ƒç´ \n- Map æ¥å£å®šä¹‰äº†åŒåˆ—é›†åˆçš„è§„èŒƒï¼Œæ¯æ¬¡å­˜å‚¨ä¸€å¯¹å…ƒç´ \n\n### å¸¸ç”¨å­ç±»\n\nMapé›†åˆç±»            | Key          | Value        | Super       | JDK | è¯´æ˜\n----------------- | ------------ | ------------ | ----------- | --- | ------------------\nHashtable         | **ä¸å…è®¸ä¸ºnull** | **ä¸å…è®¸ä¸ºnull** | Dictionary  | 1.0 | çº¿ç¨‹å®‰å…¨ï¼ˆè¿‡æ—¶ï¼‰\nConcurrentHashMap | **ä¸å…è®¸ä¸ºnull** | **ä¸å…è®¸ä¸ºnull** | AbstractMap | 1.5 | é”åˆ†æ®µæŠ€æœ¯æˆ–CAS(JDK8åŠä»¥ä¸Š)\nTreeMap           | **ä¸å…è®¸ä¸ºnull** | å…è®¸ä¸ºnull      | AbstractMap | 1.2 | çº¿ç¨‹ä¸å®‰å…¨(æœ‰åº)\nHashMap           | å…è®¸ä¸ºnull      | å…è®¸ä¸ºnull      | AbstractMap | 1.2 | çº¿ç¨‹ä¸å®‰å…¨( resizeæ­»é“¾é—®é¢˜)\n\nåœ¨ä»»ä½•Mapä¸­ éƒ½è¦é¿å…KVè®¾ç½®ä¸ºnull\n\n- HashMap\n\nå¹¶å‘åœºæ™¯ä¸‹ æ•°æ®ä¸¢å¤± \n\næ­»é“¾é—®é¢˜ï¼šå¹¶å‘æƒ…å†µä¸‹é“¾è¡¨ä¿®æ”¹å¯¼è‡´çš„ä¸ä¸€è‡´é—®é¢˜\n\n- ConcurrentHashMap\n\nJDK11åå–æ¶ˆäº†åˆ†æ®µé”æœºåˆ¶ å¼•å…¥äº†çº¢é»‘æ ‘ç»“æ„ put remove sizeç­‰æ“ä½œéƒ½æ˜¯ç”¨äº†CAS\n\n- LinkedHashMap \n- TreeMap keyæœ‰åº åŸºäºçº¢é»‘æ ‘å®ç°\n\nå¹¶éä¸€å®šè¦è¦†å†™hashCodeä¸equals å…¶å†…éƒ¨å…ƒç´ æ—¶é€šè¿‡Comparableä¸Comparatoræ¥å®ç°keyå»é‡æ’åºçš„\n\n### å¸¸ç”¨æ–¹æ³•\n\n- publicÂ VÂ put(KÂ key,Â VÂ value) :  æŠŠæŒ‡å®šçš„é”®ä¸æŒ‡å®šçš„å€¼æ·»åŠ åˆ°Mapé›†åˆä¸­ã€‚ \n- publicÂ VÂ remove(ObjectÂ key) : æŠŠæŒ‡å®šçš„é”® æ‰€å¯¹åº”çš„é”®å€¼å¯¹å…ƒç´  åœ¨Mapé›†åˆä¸­åˆ é™¤ï¼Œè¿”å›è¢«åˆ é™¤å…ƒç´ çš„ å€¼ã€‚ \n- publicÂ VÂ get(ObjectÂ key) æ ¹æ®æŒ‡å®šçš„é”®ï¼Œåœ¨Mapé›†åˆä¸­è·å–å¯¹åº”çš„å€¼ã€‚ \n- publicÂ Set<K>Â keySet() : è·å–Mapé›†åˆä¸­æ‰€æœ‰çš„é”®ï¼Œå­˜å‚¨åˆ°Seté›†åˆä¸­ã€‚ \n- publicÂ Set<Map.Entry<K,V>>Â entrySet() : è·å–åˆ°Mapé›†åˆä¸­æ‰€æœ‰çš„é”®å€¼å¯¹å¯¹è±¡çš„é›†åˆ(Seté›†åˆ)ã€‚\n\n## Seté›†åˆ\n\n- ä¸å…è®¸å‡ºç°é‡å¤\n\n### HashSet\n\n> åº•å±‚ä½¿ç”¨hashmap\n\n![æ‰¹æ³¨ 2019-08-02 095407](/assets/æ‰¹æ³¨%202019-08-02%20095407.png)\n\nå­˜å‚¨è‡ªå®šä¹‰ç±»å‹å…ƒç´ æ—¶ï¼Œéœ€è¦é‡å†™å¯¹è±¡ä¸­çš„hashCodeå’Œequalsæ–¹æ³•\n\n### TreeSet\n\nåº•å±‚ä½¿ç”¨TreeMap ä¿è¯Keyæœ‰åº\n\n### LinkedHashSet \n\n> æœ‰åºçš„å“ˆå¸Œé›†åˆ\n\n## Collections å·¥å…·ç±»\n\n- publicÂ staticÂ <T>Â booleanÂ addAll(Collection<T>Â c,Â T...Â elements) :å¾€é›†åˆä¸­æ·»åŠ ä¸€äº›å…ƒç´ ã€‚ \n- publicÂ staticÂ voidÂ shuffle(List<?>Â list)Â æ‰“ä¹±é¡ºåº :æ‰“ä¹±é›†åˆé¡ºåºã€‚ \n- publicÂ staticÂ <T>Â voidÂ sort(List<T>Â list) :å°†é›†åˆä¸­å…ƒç´ æŒ‰ç…§é»˜è®¤è§„åˆ™æ’åºã€‚ \n- publicÂ staticÂ <T>Â voidÂ sort(List<T>Â listï¼ŒComparator<?Â superÂ T>Â ) :å°†é›†åˆä¸­å…ƒç´ æŒ‰ç…§æŒ‡å®šè§„åˆ™æ’åº\n\n## é›†åˆåˆå§‹åŒ–\n\n- ArrayListçš„åˆå§‹å€¼ä¸º10 æ¯æ¬¡æ‰©å®¹ä»¥1.5å€çš„é€Ÿåº¦è¿›è¡Œæ‰©å®¹\n- HashMapçš„åˆå§‹å€¼ä¸º16 æ¯æ¬¡æ‰©å®¹ä»¥2çš„å¹‚è¿›è¡Œæ‰©å®¹\n\nè¿™æ ·å¦‚æœå­˜æ”¾åœ¨é›†åˆçš„å…ƒç´ æ¯”è¾ƒå¤š å°±ä¼šé€ æˆä¸æ–­æ‰©å®¹ å½±å“æ€§èƒ½\n\næ‰€ä»¥é›†åˆåˆå§‹åŒ–æ—¶åº”è¯¥æŒ‡å®šå¥½é»˜è®¤å€¼\n\n## æ•°ç»„ä¸é›†åˆ\n\n```java\nnew int[-1]; // è¿è¡Œæ—¶å¼‚å¸¸ï¼šNegativeArraySizeExceptionï¼š-1\n```\n\næ•°ç»„éå†ä¼˜å…ˆä½¿ç”¨foreachæ–¹å¼\n\n### æ•°ç»„è½¬é›†åˆ\n\næ³¨æ„è½¬é›†åˆçš„è¿‡ç¨‹ä¸­æ˜¯å¦ä½¿ç”¨äº†è§†å›¾çš„æ–¹å¼ï¼š\n\nArrays.asList(...)è¿™ä¸ªæ–¹æ³•è¿”å›äº†ä¸€ä¸ªä¸å¯å˜çš„ArrayListï¼ˆArraysçš„å†…éƒ¨ç±»ï¼‰,ä¸èƒ½è¿›è¡Œä¿®æ”¹æ“ä½œ å¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸\n\n### é›†åˆè½¬æ•°ç»„\n\n```java\nObject[] objects = list.toArray();// æ³›å‹ä¸¢å¤±\n\nString[] arr1 = new String[2];\nlist.toArray(arr1); // arr1ä¸º[null,null]\n\nString[] arr2 = new String[3];\nlist.toArray(arr2); // arr2ä¸º[1,2,3]\n```\n\nå½“toArrayä¼ å…¥çš„æ•°ç»„å®¹é‡æ¯”sizeå°æ—¶ è¯¥æ–¹æ³•å°±ä¼šå¼ƒç”¨è¿™ä¸ªæ•°ç»„ è€Œæ˜¯è‡ªå·±åˆ›å»ºä¸€ä¸ªæ•°ç»„è¿”å›\n\nå½“æ•°ç»„å®¹é‡ç­‰äºsizeæ—¶ è¿è¡Œæ—¶æœ€å¿«çš„,ç©ºé—´æ•ˆç‡ä¹Ÿæ˜¯æœ€é«˜çš„\n\n## é›†åˆä¸æ³›å‹\n\n```java\n//ç¬¬ä¸€æ®µ:æ³›å‹å‡ºç°ä¹‹å‰çš„é›†åˆå®šä¹‰æ–¹å¼\nList al = new ArrayList();\nal.add (new Object());\nal.add (new Integer(111));\nal.add(new String(\"hello alal\"));\n\n//ç¬¬äºŒæ®µ:æŠŠa1å¼•ç”¨èµ‹å€¼ç»™a2ï¼Œæ³¨æ„a2ä¸alçš„åŒºåˆ«æ˜¯å¢åŠ äº†æ³›å‹é™åˆ¶<object>\nList<Object> a2 = al;\na2.add (new Object());\na2.add (new Integer(222));\na2.add(new String(\"hello a2a2\")ï¼‰;\n\n//ç¬¬ä¸‰æ®µ:æŠŠa1å¼•ç”¨èµ‹å€¼ç»™a3ï¼Œæ³¨æ„a3ä¸alçš„åŒºåˆ«æ˜¯å¢åŠ äº†æ³›å‹<Integer>\nList<Integer> a3 = al;\na3.add(new Integer (333)ï¼‰;\nä¸‹æ–¹ä¸¤è¡Œç¼–è¯‘å‡ºé”™ï¼Œä¸å…è®¸å¢åŠ éIntegerç±»å‹è¿›å…¥é›†åˆ\na3.add(new object());\na3.add(new String(\"hello a3a3\"));\n\n//ç¬¬å››æ®µ:æŠŠa1å¼•ç”¨èµ‹å€¼ç»™a4ï¼Œalä¸a4çš„åŒºåˆ«æ˜¯å¢åŠ äº†é€šé…ç¬¦\nList<?>a4 = al;\n//å…è®¸å‰¯é™¤å’Œæ¸…é™¤å…ƒç´ \nal.remove(O);\na4.clear();\n// ç¼–è¯‘å‡ºé”™ã€‚ä¸å…è®¸å¢åŠ ä»»ä½•å…ƒç´ \na4.add (new Object());\n```\n\n`<? extends T>` putåŠŸèƒ½å—é™ ?åªèƒ½æ˜¯TåŠTçš„å­ç±»å‹\n\n`<? super T>` get åŠŸèƒ½å—é™ ?åªèƒ½æ˜¯TåŠTçš„çˆ¶ç±»å‹\n\n## å…ƒç´ çš„æ¯”è¾ƒ\n\nComparableå’ŒComparatorä¸¤ä¸ªæ¥å£çš„åŒºåˆ«ï¼š\n- Comparableï¼šè‡ªå·±ä¸åˆ«äººæ¯”è¾ƒ\n- Comparatorï¼šç¬¬ä¸‰æ–¹æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡\n\n### hashCode ä¸ equals\n\né€šè¿‡å“ˆå¸Œå°†æ•°æ®åˆ†æ•£å¼€æ¥\n\n- equalsç›¸ç­‰ åˆ™hashCodeå¿…é¡»ç›¸ç­‰\n- è¦†å†™equals å¿…é¡»è¦†å†™hashCode\n\n```java\n// HashMap åˆ¤æ–­ä¸¤ä¸ªkeyæ˜¯å¦ç›¸ç­‰\nif (e.hash == hash &&\n    ((k = e.key) == key || (key != null && key.equals(k))))\n```\n\n## å¿«é€Ÿå¤±è´¥æœºåˆ¶\n\nå½“å‰çº¿ç¨‹ç»´æŠ¤ä¸€ä¸ªexpectedModCount éå†ä¹‹å‰è¿™ä¸ªå€¼ç­‰äºmodCount\n\nå¦‚æœåœ¨éå†çš„è¿‡ç¨‹ä¸­å‘ç° expectedModCount != modCount å°±ä»£è¡¨é›†åˆè¢«åˆ«çš„çº¿ç¨‹ä¿®æ”¹äº† è¿™æ—¶å€™ä¼šè·‘å‡ºä¸€ä¸ªConcurrentModificationException\n\nè¿™ä¸ªæ—¶å€™å¾—ä½¿ç”¨è¿­ä»£å™¨æ¥å®ç°åœ¨éå†ä¸­ä¿®æ”¹é›†åˆçš„åŠŸèƒ½\n\nå¹¶å‘é›†åˆéƒ½æ˜¯ä½¿ç”¨å¿«é€Ÿå¤±è´¥æœºåˆ¶å®ç°çš„ é›†åˆä¿®æ”¹ä¸éå†æ²¡æœ‰ä»»ä½•å…³ç³» ä½†è¿™ç§æœºåˆ¶ä¼šå¯¼è‡´è¯»å–ä¸åˆ°æœ€æ–°çš„æ•°æ® ä¹Ÿæ˜¯CAPç†è®ºä¸­ Aä¸Pçš„çŸ›ç›¾\n\n## æ³¨æ„äº‹é¡¹\n\n### çº¿ç¨‹å®‰å…¨\n\nCollections å¸®æˆ‘ä»¬å®ç°äº† Listã€Setã€Map å¯¹åº”çš„çº¿ç¨‹å®‰å…¨çš„æ–¹æ³•\n\nsynchronizedæ‰“å¤´çš„æ–¹æ³•å¯ä»¥å°†æŒ‡å®šçš„é›†åˆåŒ…è£…æˆçº¿ç¨‹å®‰å…¨çš„é›†åˆ\n\n### é›†åˆæ€§èƒ½\n\n- æ‰¹é‡æ–°å¢\n\nåœ¨ List å’Œ Map å¤§é‡æ•°æ®æ–°å¢çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸è¦ä½¿ç”¨ for å¾ªç¯ + add/put æ–¹æ³•æ–°å¢ï¼Œè¿™æ ·å­ä¼šæœ‰å¾ˆå¤§çš„æ‰©å®¹æˆæœ¬ï¼Œæˆ‘ä»¬åº”è¯¥å°½é‡ä½¿ç”¨ addAll å’Œ putAll æ–¹æ³•è¿›è¡Œæ–°å¢\n\n- æ‰¹é‡åˆ é™¤\n\nArrayListçš„removeæ–¹æ³•ï¼Œåˆ é™¤ä¹‹åéƒ½ä¼šå¯¹è¢«åˆ é™¤ä½ç½®çš„å…ƒç´ è¿›è¡Œç§»åŠ¨ï¼Œå¦‚æœè¿›è¡Œå¾ªç¯removeï¼Œä¼šé€ æˆæ€§èƒ½é—®é¢˜ï¼Œå¯ä»¥é‡‡ç”¨removeAllæ–¹æ³•ï¼Œè¿™ä¸ªæ‰¹é‡åˆ é™¤æ¥å£åªä¼šå¯¹æ•°ç»„çš„å…ƒç´ ç§»åŠ¨ä¸€æ¬¡\n\n### é›†åˆçš„å‘\n\n- Arrays.asList(array),å½“arrayè¢«ä¿®æ”¹æ—¶ï¼Œä¼šé€ æˆlistä¹Ÿè¢«ä¿®æ”¹\n- toArray æ–¹æ³•å¦‚æœå£°æ˜çš„æ•°ç»„å°äºlisté•¿åº¦ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªç©ºæ•°ç»„\n\n## JAVA7åˆ°JAVA8é›†åˆçš„å‡çº§\n\n- æ‰€æœ‰é›†åˆéƒ½æ–°å¢äº†forEach æ–¹æ³•\n- JAVA7ä¸­ArrayListæ— å‚åˆå§‹åŒ–æ˜¯ç›´æ¥åˆå§‹åŒ–10ï¼ŒJAVA8æ— å‚åˆå§‹åŒ–åˆ™æ˜¯ä¸€ä¸ªç©ºæ•°ç»„\n- JAVA7ä¸­çš„HashMapæ— å‚åˆå§‹åŒ–çš„å¤§å°æ˜¯16ï¼ŒJAVA8æ— å‚åˆå§‹åŒ–åˆ™æ˜¯ä¸€ä¸ªç©ºæ•°ç»„ï¼Œå¹¶ä¸”å¼•å…¥äº†çº¢é»‘æ ‘ï¼Œå¹¶ä¸”å¢åŠ äº†xxIfAbsentç­‰æ–¹æ³•\n- Arrays æä¾›äº†å¾ˆå¤š parallel å¼€å¤´çš„æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•æ”¯æŒå¹¶è¡Œè®¡ç®—\n\n## Guava\n\n### å·¥å‚æ¨¡å¼åˆå§‹åŒ–\n\n```java\nHashMap<Object, Object> map = Maps.newHashMap();\n```\n\n### Lists\n\n```java\nArrayList<String> list = Lists.newArrayList();\nArrayList<Object> objects = Lists.newArrayListWithCapacity(10);\n// ä¸çŸ¥é“ç²¾ç¡®å€¼ï¼Œç»™å‡ºä¸€ä¸ªæ¨¡ç³Šå€¼\nArrayList<Object> objects1 = Lists.newArrayListWithExpectedSize(20);\n// åè½¬ä¸€ä¸ªlistï¼Œå¹¶éç‰©ç†åè½¬ï¼Œè€Œæ˜¯é€šè¿‡å¯¹ä¼ å…¥indexçš„å¤„ç†å®ç°çš„\nvar list = Lists.reverse(list)\n// listæ‹†åˆ†\nvar list = Lists.partition(list,3)\n```\n\n### Maps\n\n## List\n\n### ArrayList\n\nArrayListçš„subListæ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªlistè§†å›¾ï¼Œå¯¹è¿™ä¸ªSubListçš„ä¿®æ”¹éƒ½ä¼šæ˜ å°„åˆ°åŸæ¥çš„list\n\nè€ŒArrays.asListè¿”å›çš„arraysåŒ…ä¸‹çš„ArrayListï¼Œè¿™ä¸ªç±»å¹¶æ²¡æœ‰é‡å†™add,removeç­‰æ–¹æ³•ï¼Œæ‰€ä»¥ä¿®æ”¹æ—¶ä¼šæŠ›å‡ºå¼‚å¸¸\n\n#### ç»“æ„\n\n![202002191425](/assets/202002191425.jfif)\n\n- DEFAULT_CAPACITY è¡¨ç¤ºæ•°ç»„çš„åˆå§‹å¤§å°ï¼Œé»˜è®¤æ˜¯ 10\n- size è¡¨ç¤ºå½“å‰æ•°ç»„çš„å¤§å°\n- modCount ç»Ÿè®¡å½“å‰æ•°ç»„è¢«ä¿®æ”¹çš„ç‰ˆæœ¬æ¬¡æ•°ï¼Œæ•°ç»„ç»“æ„æœ‰å˜åŠ¨ï¼Œå°±ä¼š +1\n\n#### è§£æ\n\n- åˆå§‹åŒ–\n\nä¸€å…±æœ‰ä¸‰ç§æ–¹å¼å¯ä»¥åˆå§‹åŒ–ArrayList\n\n```java\npublic ArrayList(Collection<? extends E> c) {\n    elementData = c.toArray();\n    if ((size = elementData.length) != 0) {\n        // ç›´æ¥å°†ä¼ å…¥çš„é›†åˆè½¬æˆæ•°ç»„å¤åˆ¶ç»™å†…éƒ¨æ•°ç»„\n        if (elementData.getClass() != Object[].class)\n            elementData = Arrays.copyOf(elementData, size, Object[].class);\n    } else {\n        this.elementData = {};\n    }\n}\n\npublic ArrayList() {\n    this.elementData = {};\n}\n\npublic ArrayList(int initialCapacity) {\n    if (initialCapacity > 0) {\n        this.elementData = new Object[initialCapacity];\n    } else if (initialCapacity == 0) {\n        this.elementData = {};\n    } else {\n        throw new IllegalArgumentException(\"Illegal Capacity: \"+\n                                           initialCapacity);\n    }\n}\n```\n\n- æ–°å¢ä¸æ‰©å®¹\n\næ·»åŠ å…ƒç´ æ—¶ï¼š\n\n- åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å±•ï¼Œå¦‚æœéœ€è¦åˆ™åªéœ€æ‰©å®¹\n- æ·»åŠ \n\n```java\n// è¿™ä¸ªç‰ˆæœ¬æ˜¯åŸºäºJDK13çš„\nprivate void add(E e, Object[] elementData, int s) {\n    // å½“å‘ç°ç°åœ¨listçš„sizeè·Ÿæ•°ç»„å®¹é‡ä¸€æ ·å¤§æ—¶ï¼Œåˆ™è¿›è¡Œæ‰©å®¹\n    if (s == elementData.length)\n        // è¿™é‡Œæ‰©å®¹å®Œï¼Œä¼šäº§ç”Ÿä¸€ä¸ªæ–°æ•°ç»„ï¼Œæˆ‘ä»¬è¦å°†æ–°æ•°ç»„ä¿å­˜\n        elementData = grow(size+1);\n    //æ·»åŠ index:size\n    elementData[s] = e;\n    size = s + 1;\n}\n// æ‰©å®¹æ ¸å¿ƒä»£ç \nprivate Object[] grow(int minCapacity) {\n    int oldCapacity = elementData.length;\n    // åªæœ‰æ•°ç»„ä¸ä¸ºç©ºæ—¶ï¼Œæ‰è¿›è¡Œæ‰©å®¹ï¼Œå¦åˆ™ç›´æ¥åˆ›å»º\n    if (oldCapacity > 0 || elementData != DEFAULTCAPACITY_EMPTY_ELEMENTDATA) {\n        // è®¡ç®—æ•°ç»„çš„æ–°å®¹é‡\n        int newCapacity = ArraysSupport.newLength(oldCapacity,\n                minCapacity - oldCapacity, /* minimum growth */\n                oldCapacity >> 1           /* preferred growth */);\n        // å¤åˆ¶è€æ•°ç»„åˆ°æ–°æ•°ç»„\n        return elementData = Arrays.copyOf(elementData, newCapacity);\n    } else {\n        return elementData = new Object[Math.max(DEFAULT_CAPACITY, minCapacity)];\n    }\n}\n// è®¡ç®—å®¹é‡çš„æ–¹æ³•\npublic static int newLength(int oldLength, int minGrowth, int prefGrowth) {\n    // åˆ¤æ–­listçš„sizeä¸elementDataçš„å·®å€¼å¦‚æœå¤§äºelementDataé•¿åº¦çš„ä¸€åŠ\n    // æ–°æ•°ç»„é•¿åº¦å°±ç­‰äºè€æ•°ç»„é•¿åº¦åŠ ä¸Šlistçš„sizeä¸elementDataçš„å·®å€¼\n    // å¦åˆ™æ–°æ•°ç»„çš„é•¿åº¦å°±ç­‰äºè€æ•°ç»„çš„1.5å€\n    int newLength = Math.max(minGrowth, prefGrowth) + oldLength;\n    if (newLength - MAX_ARRAY_LENGTH <= 0) { // æ•°ç»„é•¿åº¦ä¸èƒ½å¤§äºæ•´æ•°æœ€å¤§å€¼\n        return newLength;\n    }\n    return hugeLength(oldLength, minGrowth);\n}\n```\n\næ‰€ä»¥æ‰©å®¹çš„æœ¬è´¨å°±æ˜¯ç”³è¯·ä¸€ä¸ªæ›´å¤§çš„æ•°ç»„ï¼Œå°†æ—§æ•°ç»„çš„å†…å®¹ç§»è¿‡å»\n\n**æºç æ‰©å®¹è¿‡ç¨‹å€¼å¾—å€Ÿé‰´çš„åœ°æ–¹**\n\n- é€šè¿‡è‡ªåŠ¨æ‰©å®¹çš„æ–¹å¼ï¼Œè®©ä½¿ç”¨è€…ä¸ç”¨å…³å¿ƒåº•å±‚æ•°æ®ç»“æ„çš„å˜åŒ–ï¼Œå°è£…å¾—å¾ˆå¥½\n- 1.5 å€çš„æ‰©å®¹é€Ÿåº¦ï¼Œå¯ä»¥è®©æ‰©å®¹é€Ÿåº¦åœ¨å‰æœŸç¼“æ…¢ä¸Šå‡ï¼Œåœ¨åæœŸå¢é€Ÿè¾ƒå¿«\n- æ‰©å®¹è¿‡ç¨‹ä¸­ï¼Œæ³¨æ„æ•°ç»„å¤§å°æº¢å‡ºçš„æƒ…å†µ\n\n\n- åˆ é™¤\n\næ— è®ºæ˜¯æ ¹æ®Objectåˆ é™¤è¿˜æ˜¯indexåˆ é™¤ï¼Œéƒ½å¿…é¡»ç»™å‡ºè¢«åˆ é™¤å…ƒç´ çš„index\n\n```java\nprivate void fastRemove(Object[] es, int i) {\n    modCount++;\n    final int newSize;\n    if ((newSize = size - 1) > i)\n        // å°†elementData ä¸‹æ ‡ä¸ºiåé¢çš„å…¨éƒ¨å…ƒç´ å¾€å‰ç§»åŠ¨ä¸€ä¸ªä½\n        System.arraycopy(es, i + 1, es, i, newSize - i);\n    // å¦‚æœåˆ é™¤çš„æ˜¯æœ€åä¸€ä¸ªå…ƒç´ ï¼Œç½®ä¸ºnullå°±è¡Œ\n    es[size = newSize] = null; // åŒæ—¶è®°å¾—size-1\n}\n```\n\n![202002191507](/assets/202002191507.jfif)\n\n#### è¿­ä»£å™¨\n\n- hasNext\n\n```java\npublic boolean hasNext() {\n    return cursor != size;\n}\n```\n\n- next\n\n```java\npublic E next() {\n    // æœ‰ç‚¹ä¹è§‚é”çš„æ„æ€ï¼Œé€šè¿‡ç‰ˆæœ¬å·æ¥ç¡®å®šæŒæœ‰çš„æ•°æ®æ˜¯å¦è¢«ä¿®æ”¹äº†\n    if (modCount != expectedModCount)\n        throw new ConcurrentModificationException();\n    // å¦åˆ™æ¯æ¬¡æ ¹æ®æ¸¸æ ‡è·å–å…ƒç´ ï¼Œè·å–å®Œæ¸¸æ ‡+1\n    int i = cursor;\n    if (i >= size)\n        throw new NoSuchElementException();\n    Object[] elementData = ArrayList.this.elementData;\n    if (i >= elementData.length)\n        throw new ConcurrentModificationException();\n    cursor = i + 1;\n    return (E) elementData[lastRet = i];\n}\n```\n\n- remove\n\n```java\npublic void remove() {\n    if (lastRet < 0)\n        throw new IllegalStateException();\n   if (modCount != expectedModCount)\n        throw new ConcurrentModificationException();\n    // å°†å½“å‰æ¸¸æ ‡ä½œä¸ºä¸‹æ ‡ï¼Œåˆ é™¤è¿™ä¸ªä½ç½®çš„å…ƒç´ \n    try {\n        ArrayList.this.remove(lastRet);\n        // åˆ é™¤å®Œä¹‹åè¦æ›´æ–°ç‰ˆæœ¬å·\n        cursor = lastRet;\n        lastRet = -1;\n        expectedModCount = modCount;\n    } catch (IndexOutOfBoundsException ex) {\n        throw new ConcurrentModificationException();\n    }\n}\n```\n\n#### çº¿ç¨‹å®‰å…¨\n\nArrayList æœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜çš„æœ¬è´¨ï¼Œæ˜¯å› ä¸º ArrayList è‡ªèº«çš„ elementDataã€sizeã€modConut åœ¨è¿›è¡Œå„ç§æ“ä½œæ—¶ï¼Œéƒ½æ²¡æœ‰åŠ é”\n\n---\n\né—®ï¼šå¯¹ ArrayList çš„ç†è§£ï¼Ÿ\n\nç­”ï¼šåº•å±‚æ•°æ®ç»“æ„ã€å¯¹æ•°ç»„çš„å°è£…ã€addã€remove\n\né—®ï¼šä¸ºä»€ä¹ˆè¯´æ‰©å®¹ä¼šæ¶ˆè€—æ€§èƒ½\n\nç­”ï¼šæ‰©å®¹åº•å±‚ä½¿ç”¨çš„æ˜¯ System.arraycopy æ–¹æ³•ï¼Œä¼šæŠŠåŸæ•°ç»„çš„æ•°æ®å…¨éƒ¨æ‹·è´åˆ°æ–°æ•°ç»„ä¸Šï¼Œæ‰€ä»¥æ€§èƒ½æ¶ˆè€—æ¯”è¾ƒä¸¥é‡\n\n\n### LinkedList\n\n#### æ¶æ„\n\nLinkedList åº•å±‚æ•°æ®ç»“æ„æ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨\n\n![202002191526](/assets/202002191526.jfif)\n\n#### è§£æ\n\n- nodeçš„ç»“æ„\n\n```java\nprivate static class Node<E> {\n    E item;\n    Node<E> next;\n    Node<E> prev;\n    \n    Node(Node<E> prev, E element, Node<E> next) {\n        this.item = element;\n        this.next = next;\n        this.prev = prev;\n    }\n}\n```\n\n- å°¾éƒ¨è¿½åŠ èŠ‚ç‚¹\n\n```java\nvoid linkLast(E e) {\n    final Node<E> l = this.last;\n    final Node<E> newNode = new Node<>(l, e, null);\n    this.last = newNode;\n    // å¦‚æœå°¾èŠ‚ç‚¹ä¸ºç©ºï¼Œåˆ™ä»£è¡¨å½“å‰é“¾è¡¨æ˜¯ç©ºçš„ï¼Œç›´æ¥æŠŠæ’å…¥èŠ‚ç‚¹ä½œä¸ºå¤´èŠ‚ç‚¹\n    if (l == null)\n        first = newNode;\n    else\n        l.next = newNode; // å¦åˆ™å°±å°†æ’å…¥èŠ‚ç‚¹è®¾ç½®ä¸ºå°¾èŠ‚ç‚¹ï¼Œå¹¶ä¸”æŠŠæ—§å°¾èŠ‚ç‚¹çš„nextæŒ‡å‘æ’å…¥èŠ‚ç‚¹\n    size++;\n    modCount++;\n}\n```\n\n- å¤´éƒ¨è¿½åŠ èŠ‚ç‚¹\n\n```java\nprivate void linkFirst(E e) {\n    final Node<E> f = this.first;\n    final Node<E> newNode = new Node<>(null, e, f);\n    this.first = newNode;\n    // å¦‚æœå¤´èŠ‚ç‚¹ä¸ºç©ºï¼Œåˆ™ä»£è¡¨å½“å‰é“¾è¡¨æ˜¯ç©ºçš„ï¼Œç›´æ¥æŠŠæ’å…¥èŠ‚ç‚¹ä½œä¸ºå°¾èŠ‚ç‚¹\n    if (f == null)\n        last = newNode;\n    else\n        f.prev = newNode; // å¦åˆ™å°±å°†æ’å…¥èŠ‚ç‚¹è®¾ç½®ä¸ºå¤´èŠ‚ç‚¹ï¼Œå¹¶ä¸”æŠŠæ—§å¤´èŠ‚ç‚¹çš„prevæŒ‡å‘æ’å…¥èŠ‚ç‚¹\n    size++;\n    modCount++;\n}\n```\n\n- åˆ é™¤èŠ‚ç‚¹\n\n```java\nE unlink(Node<E> x) {\n    // assert x != null;\n    final E element = x.item;\n    final Node<E> next = x.next;\n    final Node<E> prev = x.prev;\n    // å½“å‰åˆ é™¤çš„æ˜¯å¤´èŠ‚ç‚¹ï¼Œæ‰€ä»¥å°†åˆ é™¤èŠ‚ç‚¹çš„nextå˜ä¸ºå¤´èŠ‚ç‚¹\n    if (prev == null) {\n        first = next;\n    } else {\n        // å¦åˆ™è®¾ç½®åˆ é™¤èŠ‚ç‚¹çš„ä¸Šä¸€ä¸ªèŠ‚ç‚¹çš„nextæŒ‡å‘åˆ é™¤èŠ‚ç‚¹çš„next\n        prev.next = next;\n        x.prev = null;\n    }\n    // å½“å‰åˆ é™¤çš„æ˜¯å°¾èŠ‚ç‚¹ï¼Œæ‰€ä»¥å°†åˆ é™¤èŠ‚ç‚¹çš„prevå˜ä¸ºå°¾èŠ‚ç‚¹\n    if (next == null) {\n        last = prev;\n    } else {\n        // å¦åˆ™è®¾ç½®åˆ é™¤èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„prevæŒ‡å‘åˆ é™¤èŠ‚ç‚¹çš„prev\n        next.prev = prev;\n        x.next = null;\n    }\n    \n    x.item = null;\n    size--;\n    modCount++;\n    return element;\n}\n```\n\n- æ ¹æ®ä¸‹æ ‡æŸ¥è¯¢èŠ‚ç‚¹\n\n```java\nNode<E> node(int index) {\n    // assert isElementIndex(index);\n    if (index < (size >> 1)) { // åœ¨å‰åŠéƒ¨åˆ†ï¼Œæ‰€ä»¥ä»å¤´èŠ‚ç‚¹è¿­ä»£æŸ¥æ‰¾\n        Node<E> x = first;\n        for (int i = 0; i < index; i++)\n            x = x.next;\n        return x;\n    } else { // åœ¨ååŠéƒ¨åˆ†ï¼Œæ‰€ä»¥å°¾å¤´èŠ‚ç‚¹è¿­ä»£æŸ¥æ‰¾\n        Node<E> x = last;\n        for (int i = size - 1; i > index; i--)\n            x = x.prev;\n        return x;\n    }\n}\n```\n\n#### è¿­ä»£å™¨\n\n```java\n// åŒå‘è¿­ä»£å™¨\nprivate class ListItr implements ListIterator<E> {\n    private Node<E> lastReturned;//ä¸Šä¸€æ¬¡æ‰§è¡Œ next() æˆ–è€… previos() æ–¹æ³•æ—¶çš„èŠ‚ç‚¹ä½ç½®\n    private Node<E> next;//ä¸‹ä¸€ä¸ªèŠ‚ç‚¹\n    private int nextIndex;//ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„ä½ç½®\n    â€¦â€¦â€¦â€¦\n}\n```\n\n- ä»å¤´åˆ°å°¾è¿­ä»£\n\n```java\npublic boolean hasNext() {\n    return nextIndex < size;\n}\n    \npublic E next() {\n    checkForComodification();\n    if (!hasNext())\n        throw new NoSuchElementException();\n\n    lastReturned = next;\n    next = next.next; // nextæŒ‡å‘å½“å‰éå†å…ƒç´ çš„next\n    nextIndex++;\n    return lastReturned.item;\n}\n```\n\n- ä»å°¾åˆ°å¤´è¿­ä»£\n\n```java\npublic boolean hasPrevious() {\n    return nextIndex > 0;\n}\n\npublic E previous() {\n    checkForComodification();\n    if (!hasPrevious())\n        throw new NoSuchElementException();\n    // ä¸»è¦æ˜¯åˆ¤æ–­nextä¸ºç©ºçš„æƒ…å†µä¸‹è¦é€‰æ‹©lastä½œä¸ºéå†èŠ‚ç‚¹ï¼Œå¦åˆ™é€‰æ‹©éå†å…ƒç´ çš„prev\n    lastReturned = next = (next == null) ? last : next.prev;\n    nextIndex--;\n    return lastReturned.item;\n}\n```\n\n- åˆ é™¤\n\n```java\npublic void remove() {\n    checkForComodification();\n    // lastReturned æ˜¯æœ¬æ¬¡è¿­ä»£éœ€è¦åˆ é™¤çš„å€¼ï¼Œåˆ†ä»¥ä¸‹ç©ºå’Œéç©ºä¸¤ç§æƒ…å†µï¼š\n    // lastReturned ä¸ºç©ºï¼Œè¯´æ˜è°ƒç”¨è€…æ²¡æœ‰ä¸»åŠ¨æ‰§è¡Œè¿‡ next() æˆ–è€… previos()ï¼Œç›´æ¥æŠ¥é”™\n    // lastReturned ä¸ä¸ºç©ºï¼Œæ˜¯åœ¨ä¸Šæ¬¡æ‰§è¡Œ next() æˆ–è€… previos()æ–¹æ³•æ—¶èµ‹çš„å€¼\n    if (lastReturned == null)\n        throw new IllegalStateException();\n    Node<E> lastNext = lastReturned.next;\n    //åˆ é™¤å½“å‰èŠ‚ç‚¹\n    unlink(lastReturned);\n    // next == lastReturned çš„åœºæ™¯åˆ†æï¼šä»å°¾åˆ°å¤´é€’å½’é¡ºåºï¼Œå¹¶ä¸”æ˜¯ç¬¬ä¸€æ¬¡è¿­ä»£ï¼Œå¹¶ä¸”è¦åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ çš„æƒ…å†µä¸‹\n    // è¿™ç§æƒ…å†µä¸‹ï¼Œprevious() æ–¹æ³•é‡Œé¢è®¾ç½®äº† lastReturned = next = last,æ‰€ä»¥ next å’Œ lastReturnedä¼šç›¸ç­‰\n    if (next == lastReturned)\n        // è¿™æ—¶å€™ lastReturned æ˜¯å°¾èŠ‚ç‚¹ï¼ŒlastNext æ˜¯ nullï¼Œæ‰€ä»¥ next ä¹Ÿæ˜¯ nullï¼Œè¿™æ ·åœ¨ previous() æ‰§è¡Œæ—¶ï¼Œå‘ç° next æ˜¯ nullï¼Œå°±ä¼šæŠŠå°¾èŠ‚ç‚¹èµ‹å€¼ç»™ next\n        next = lastNext;\n    else\n        nextIndex--;\n    lastReturned = null;\n    expectedModCount++;\n}\n```\n\n---\n\né—®ï¼šArrayList å’Œ LinkedList æœ‰ä½•ä¸åŒ\n\nç­”ï¼šåº•å±‚æ•°æ®ç»“æ„ï¼Œæ•°ç»„ç»“æ„å¯¼è‡´çš„è¯»å†™å·®å¼‚\n\né—®ï¼š ArrayList å’Œ LinkedList åº”ç”¨åœºæ™¯\n\nç­”ï¼šArrayList æ›´é€‚åˆäºå¿«é€Ÿçš„æŸ¥æ‰¾åŒ¹é…ï¼Œä¸é€‚åˆé¢‘ç¹æ–°å¢åˆ é™¤ï¼Œåƒå·¥ä½œä¸­ç»å¸¸ä¼šå¯¹å…ƒç´ è¿›è¡ŒåŒ¹é…æŸ¥è¯¢çš„åœºæ™¯æ¯”è¾ƒåˆé€‚ï¼ŒLinkedList æ›´é€‚åˆäºç»å¸¸æ–°å¢å’Œåˆ é™¤ï¼Œå¯¹æŸ¥è¯¢åè€Œå¾ˆå°‘çš„åœºæ™¯\n\né—®ï¼šArrayList å’Œ LinkedList ä¸¤è€…æœ‰æ²¡æœ‰æœ€å¤§å®¹é‡\n\nç­”ï¼šä¸¤ä¸ªéƒ½æœ‰æœ€å¤§å®¹é‡ï¼Œæ˜¯intçš„æœ€å¤§å€¼ï¼ŒåŸå› æ˜¯ArrayListä½¿ç”¨çš„æ•°ç»„å®¹é‡ä¸èƒ½è¶…è¿‡intæœ€å¤§å€¼ï¼ŒLinkedListåˆ™æ˜¯å› ä¸ºsizeä½¿ç”¨intè¡¨ç¤ºçš„ï¼Œæ‰€ä»¥ä¹Ÿä¸èƒ½è¶…è¿‡intçš„æœ€å¤§å€¼\n\né—®ï¼šArrayList å’Œ LinkedList æ˜¯å¦‚ä½•å¯¹ null å€¼è¿›è¡Œå¤„ç†çš„\n\nç­”ï¼šArrayList å…è®¸ null å€¼æ–°å¢ï¼Œä¹Ÿå…è®¸ null å€¼åˆ é™¤ã€‚åˆ é™¤ null å€¼æ—¶ï¼Œæ˜¯ä»å¤´å¼€å§‹ï¼Œæ‰¾åˆ°ç¬¬ä¸€å€¼æ˜¯ null çš„å…ƒç´ åˆ é™¤ï¼›LinkedList æ–°å¢åˆ é™¤æ—¶å¯¹ null å€¼æ²¡æœ‰ç‰¹æ®Šæ ¡éªŒï¼Œæ˜¯å…è®¸æ–°å¢å’Œåˆ é™¤çš„\n\né—®ï¼šArrayList å’Œ LinedList æ˜¯çº¿ç¨‹å®‰å…¨çš„ä¹ˆï¼Œä¸ºä»€ä¹ˆ\n\nç­”ï¼šéƒ½éçº¿ç¨‹å®‰å…¨ï¼Œä¸»è¦çš„é—®é¢˜ç‚¹åœ¨äºå¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œæ‰€æœ‰çº¿ç¨‹ä»»ä½•æ—¶åˆ»éƒ½å¯å¯¹æ•°ç»„å’Œé“¾è¡¨è¿›è¡Œæ“ä½œï¼Œè¿™ä¼šå¯¼è‡´å€¼è¢«è¦†ç›–ï¼Œç”šè‡³æ··ä¹±çš„æƒ…å†µ\n\n## Map\n\n```mermaid\nclassDiagram\n    Map <.. HashTable: å®ç°\n    Dictionary <-- HashTable: ç»§æ‰¿\n    HashTable <-- Properties: ç»§æ‰¿\n    Map <.. EnumMap: å®ç°\n    AbstractMap <-- EnumMap: ç»§æ‰¿\n    AbstractMap <-- HashMap: ç»§æ‰¿\n    AbstractMap <-- TreeMap: ç»§æ‰¿\n    HashMap <-- LinkedHashMap: ç»§æ‰¿\n    Map <.. HashMap: å®ç°\n    Map <.. AbstractMap: å®ç°\n    Map <.. SortedMap: å®ç°\n    SortedMap <.. NavigableMap: å®ç°\n    NavigableMap <.. TreeMap: å®ç°\n```\n\n### HashMap\n\n- å…è®¸ null å€¼ï¼Œä¸åŒäº HashTable ï¼Œæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„\n- load factorï¼ˆå½±å“å› å­ï¼‰ é»˜è®¤å€¼æ˜¯ 0.75ï¼Œ æ˜¯å‡è¡¡äº†æ—¶é—´å’Œç©ºé—´æŸè€—ç®—å‡ºæ¥çš„å€¼\n- å¦‚æœæœ‰å¾ˆå¤šæ•°æ®éœ€è¦å‚¨å­˜åˆ° HashMap ä¸­ï¼Œå»ºè®® HashMap çš„å®¹é‡ä¸€å¼€å§‹å°±è®¾ç½®æˆè¶³å¤Ÿçš„å¤§å°ï¼Œè¿™æ ·å¯ä»¥é˜²æ­¢åœ¨å…¶è¿‡ç¨‹ä¸­ä¸æ–­çš„æ‰©å®¹ï¼Œå½±å“æ€§èƒ½\n- åœ¨è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œå¦‚æœ HashMap çš„ç»“æ„è¢«ä¿®æ”¹ï¼Œä¼šå¿«é€Ÿå¤±è´¥\n\n#### æ¶æ„\n\n![202002201344](/assets/202002201344.jfif)\n\n#### æ“ä½œ\n\n- æ–°å¢\n\n![202002201350](/assets/202002201350.jpg)\n\n1.ç©ºæ•°ç»„æœ‰æ— åˆå§‹åŒ–ï¼Œæ²¡æœ‰çš„è¯åˆå§‹åŒ–ï¼›\n2.å¦‚æœé€šè¿‡ key çš„ hash èƒ½å¤Ÿç›´æ¥æ‰¾åˆ°å€¼ï¼Œè·³è½¬åˆ° 6ï¼Œå¦åˆ™åˆ° 3ï¼›\n3.å¦‚æœ hash å†²çªï¼Œä¸¤ç§è§£å†³æ–¹æ¡ˆï¼šé“¾è¡¨ or çº¢é»‘æ ‘ï¼›\n4.å¦‚æœæ˜¯é“¾è¡¨ï¼Œé€’å½’å¾ªç¯ï¼ŒæŠŠæ–°å…ƒç´ è¿½åŠ åˆ°é˜Ÿå°¾ï¼›\n5.å¦‚æœæ˜¯çº¢é»‘æ ‘ï¼Œè°ƒç”¨çº¢é»‘æ ‘æ–°å¢çš„æ–¹æ³•ï¼›\n6.é€šè¿‡ 2ã€4ã€5 å°†æ–°å…ƒç´ è¿½åŠ æˆåŠŸï¼Œå†æ ¹æ® onlyIfAbsent åˆ¤æ–­æ˜¯å¦éœ€è¦è¦†ç›–ï¼›\n7.åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹ï¼Œéœ€è¦æ‰©å®¹è¿›è¡Œæ‰©å®¹ï¼Œç»“æŸã€‚\n\n```java\nfinal V putVal(int hash, K key, V value, boolean onlyIfAbsent,\n               boolean evict) {\n    Node<K,V>[] tab; Node<K,V> p; int n, i;\n    // å¦‚æœæ•°ç»„ä¸ºç©ºï¼Œé‚£å°±åˆå§‹åŒ–æ•°ç»„\n    if ((tab = table) == null || (n = tab.length) == 0)\n        n = (tab = resize()).length;\n    // å¦‚æœæ ¹æ®hashCodeå¾—åˆ°çš„ç´¢å¼•ä½ç½®ä¸ºç©ºï¼Œç›´æ¥å°†æ–°èŠ‚ç‚¹æ”¾åˆ°è¯¥èŠ‚ç‚¹\n    if ((p = tab[i = (n - 1) & hash]) == null)\n        tab[i] = newNode(hash, key, value, null);\n    else {\n        Node<K,V> e; K k;\n        // å¦‚æœç°åœ¨ç´¢å¼•ä½ç½®çš„hashå€¼ä¸keyéƒ½ç›¸ç­‰ï¼Œç›´æ¥å°†æ–°èŠ‚ç‚¹æ”¾åœ¨è¿™é‡Œ\n        if (p.hash == hash &&\n            ((k = p.key) == key || (key != null && key.equals(k))))\n            e = p;\n        // å¦åˆ™å°±éœ€è¦è¿½åŠ èŠ‚ç‚¹åˆ°å½“å‰ç´¢å¼•ä½ç½®èŠ‚ç‚¹çš„åé¢ï¼ˆé“¾è¡¨æˆ–è€…çº¢é»‘æ ‘ï¼‰\n        // å¦‚æœæ˜¯çº¢é»‘æ ‘ï¼Œé‚£å°±è°ƒç”¨çº¢é»‘æ ‘çš„å¢åŠ æ–¹æ³•\n        else if (p instanceof TreeNode)\n            e = ((TreeNode<K,V>)p).putTreeVal(this, tab, hash, key, value);\n        else {\n            // å¦åˆ™å°±æ˜¯é“¾è¡¨ï¼Œè¿›è¡Œéå†\n            for (int binCount = 0; ; ++binCount) {\n                if ((e = p.next) == null) {\n                    p.next = newNode(hash, key, value, null);\n                    if (binCount >= TREEIFY_THRESHOLD - 1) // -1 for 1st\n                        treeifyBin(tab, hash);\n                    break;\n                }\n                // å½“éå†çš„èŠ‚ç‚¹hashå€¼ä¸keyéƒ½ç›¸ç­‰æ—¶ï¼Œé‚£æ–°èŠ‚ç‚¹å°±æ˜¯æ”¾åœ¨è¿™é‡Œ\n                if (e.hash == hash &&\n                    ((k = e.key) == key || (key != null && key.equals(k))))\n                    break;\n                p = e;\n            }\n        }\n        // è¿™é‡Œçš„eå¦‚æœä¸ä¸ºnullï¼Œé‚£å°±ä»£è¡¨æ’å…¥çš„è¿™ä¸ªkeyä¸­æ˜¯æœ‰å€¼å¾—ï¼Œæ ¹æ®ä¼ å…¥çš„onlyIfAbsentå†³å®šæ˜¯å¦è¦†ç›–\n        if (e != null) { // existing mapping for key\n            V oldValue = e.value;\n            if (!onlyIfAbsent || oldValue == null)\n                e.value = value;\n            afterNodeAccess(e);\n            return oldValue;\n        }\n    }\n    // ç»´æŠ¤HashMapçš„å…¶ä»–çŠ¶æ€ä¿¡æ¯\n    ++modCount;\n    if (++size > threshold)\n        // sizeè¾¾åˆ°ä¸€å®šçš„ç¨‹åº¦ï¼Œå°±éœ€è¦æ‰©å®¹\n        resize();\n    afterNodeInsertion(evict);\n    return null;\n}\n```\n\n**é“¾è¡¨è½¬ä¸ºçº¢é»‘æ ‘**\n\nåªæœ‰å½“é“¾è¡¨é•¿åº¦å¤§äºç­‰äº8ï¼Œå¹¶ä¸”æ•´ä¸ªæ•°ç»„é•¿åº¦å¤§äºç­‰äº64æ—¶ï¼Œæ‰ä¼šè¿›è¡Œé“¾è¡¨è½¬çº¢é»‘æ ‘\n\nè‡³äºä¸ºä»€ä¹ˆæ˜¯8ï¼Œé“¾è¡¨æŸ¥è¯¢çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O (n)ï¼Œçº¢é»‘æ ‘çš„æŸ¥è¯¢å¤æ‚åº¦æ˜¯ O (log (n))ã€‚åœ¨é“¾è¡¨æ•°æ®ä¸å¤šçš„æ—¶å€™ï¼Œä½¿ç”¨é“¾è¡¨è¿›è¡Œéå†ä¹Ÿæ¯”è¾ƒå¿«ï¼Œåªæœ‰å½“é“¾è¡¨æ•°æ®æ¯”è¾ƒå¤šçš„æ—¶å€™ï¼Œæ‰ä¼šè½¬åŒ–æˆçº¢é»‘æ ‘ï¼Œä½†çº¢é»‘æ ‘éœ€è¦çš„å ç”¨ç©ºé—´æ˜¯é“¾è¡¨çš„ 2 å€ï¼Œè€ƒè™‘åˆ°è½¬åŒ–æ—¶é—´å’Œç©ºé—´æŸè€—ï¼Œ8æ˜¯æœ€åˆé€‚çš„\n\nåœ¨å…ƒç´ æ”¾ç½®è¿‡ç¨‹ä¸­ï¼Œæ¶æ„æ„é€ å“ˆå¸Œå†²çªçš„æ•°æ®æ˜¯æœ‰å¯èƒ½çš„ï¼Œé’ˆå¯¹äºJDK8ä¹‹å‰ä½¿ç”¨é“¾è¡¨æ¥å­˜å‚¨ç›¸åŒå“ˆå¸Œçš„æ•°æ®å¯ä»¥è¿›è¡Œå“ˆå¸Œç¢°æ’æ‹’ç»æœåŠ¡æ”»å‡»ï¼Œæ¶ˆè€—æœåŠ¡ç«¯çš„CPU\n\n**çº¢é»‘æ ‘çš„æ’å…¥**\n\n```java\nfinal TreeNode<K,V> putTreeVal(HashMap<K,V> map, Node<K,V>[] tab,\n                               int h, K k, V v) {\n    Class<?> kc = null;\n    boolean searched = false;\n    // æ‰¾åˆ°æ ¹èŠ‚ç‚¹\n    TreeNode<K,V> root = (parent != null) ? root() : this;\n    // éå†\n    for (TreeNode<K,V> p = root;;) {\n        int dir, ph; K pk;\n        // è¯´æ˜åº”è¯¥æ’åœ¨å½“å‰éå†èŠ‚ç‚¹çš„å³å­æ ‘\n        if ((ph = p.hash) > h)\n            dir = -1;\n        // è¯´æ˜åº”è¯¥æ’åœ¨å½“å‰éå†èŠ‚ç‚¹çš„å·¦å­æ ‘\n        else if (ph < h)\n            dir = 1;\n        // æ‰¾åˆ°è·Ÿæ’å…¥èŠ‚ç‚¹ç›¸ç­‰çš„èŠ‚ç‚¹ï¼Œè¿”å›\n        else if ((pk = p.key) == k || (k != null && k.equals(pk)))\n            return p;\n        // å®ç°äº†Comparableï¼Œé€šè¿‡compareToæ¯”è¾ƒ\n        else if ((kc == null &&\n                  (kc = comparableClassFor(k)) == null) ||\n                 (dir = compareComparables(kc, k, pk)) == 0) {\n            if (!searched) {\n                TreeNode<K,V> q, ch;\n                searched = true;\n                if (((ch = p.left) != null &&\n                     (q = ch.find(h, k, kc)) != null) ||\n                    ((ch = p.right) != null &&\n                     (q = ch.find(h, k, kc)) != null))\n                    return q;\n            }\n            dir = tieBreakOrder(k, pk);\n        }\n\n        // æ’å…¥æ–°èŠ‚ç‚¹\n        TreeNode<K,V> xp = p;\n        if ((p = (dir <= 0) ? p.left : p.right) == null) {\n            Node<K,V> xpn = xp.next;\n            TreeNode<K,V> x = map.newTreeNode(h, k, v, xpn);\n            if (dir <= 0)\n                xp.left = x;\n            else\n                xp.right = x;\n            xp.next = x;\n            x.parent = x.prev = xp;\n            if (xpn != null)\n                ((TreeNode<K,V>)xpn).prev = x;\n            moveRootToFront(tab, balanceInsertion(root, x));\n            return null;\n        }\n    }\n}\n```\n\nç€è‰²æ˜¯æŒ‡çº¢é»‘æ ‘çš„èŠ‚ç‚¹ç€ä¸Šçº¢è‰²æˆ–é»‘è‰²ï¼Œæ—‹è½¬æ˜¯ä¸ºäº†è®©çº¢é»‘æ ‘æ›´åŠ å¹³è¡¡ï¼Œæé«˜æŸ¥è¯¢çš„æ•ˆç‡ï¼Œæ€»çš„æ¥è¯´éƒ½æ˜¯ä¸ºäº†æ»¡è¶³çº¢é»‘æ ‘çš„ 5 ä¸ªåŸåˆ™ï¼š\n\n1. èŠ‚ç‚¹æ˜¯çº¢è‰²æˆ–é»‘è‰²\n2. æ ¹æ˜¯é»‘è‰²\n3. æ‰€æœ‰å¶å­éƒ½æ˜¯é»‘è‰²\n4. ä»ä»»ä¸€èŠ‚ç‚¹åˆ°å…¶æ¯ä¸ªå¶å­çš„æ‰€æœ‰ç®€å•è·¯å¾„éƒ½åŒ…å«ç›¸åŒæ•°ç›®çš„é»‘è‰²èŠ‚ç‚¹\n5. ä»æ¯ä¸ªå¶å­åˆ°æ ¹çš„æ‰€æœ‰è·¯å¾„ä¸Šä¸èƒ½æœ‰ä¸¤ä¸ªè¿ç»­çš„çº¢è‰²èŠ‚ç‚¹\n\n- æŸ¥æ‰¾\n\n```\n1.æ ¹æ® hash ç®—æ³•å®šä½æ•°ç»„çš„ç´¢å¼•ä½ç½®ï¼Œequals åˆ¤æ–­å½“å‰èŠ‚ç‚¹æ˜¯å¦æ˜¯æˆ‘ä»¬éœ€è¦å¯»æ‰¾çš„ keyï¼Œæ˜¯çš„è¯ç›´æ¥è¿”å›ï¼Œä¸æ˜¯çš„è¯å¾€ä¸‹ã€‚\n2.åˆ¤æ–­å½“å‰èŠ‚ç‚¹æœ‰æ—  next èŠ‚ç‚¹ï¼Œæœ‰çš„è¯åˆ¤æ–­æ˜¯é“¾è¡¨ç±»å‹ï¼Œè¿˜æ˜¯çº¢é»‘æ ‘ç±»å‹ã€‚\n3.åˆ†åˆ«èµ°é“¾è¡¨å’Œçº¢é»‘æ ‘ä¸åŒç±»å‹çš„æŸ¥æ‰¾æ–¹æ³•\n```\n\né“¾è¡¨æŸ¥æ‰¾\n\n```java\ndo {\n    // éå†ï¼Œçœ‹éå†çš„èŠ‚ç‚¹çš„keyæ˜¯å¦ä¸æŸ¥æ‰¾çš„keyç›¸ç­‰\n    if (e.hash == hash &&\n        ((k = e.key) == key || (key != null && key.equals(k))))\n        return e;\n} while ((e = e.next) != null);\n```\n\nçº¢é»‘æ ‘æŸ¥æ‰¾\n\n```java\nfinal TreeNode<K,V> find(int h, Object k, Class<?> kc) {\n    TreeNode<K,V> p = this;\n    do {\n        int ph, dir; K pk;\n        TreeNode<K,V> pl = p.left, pr = p.right, q;\n        // hashæ¯”å½“å‰èŠ‚ç‚¹å°ï¼Œå¾€å·¦å­æ ‘å¯»æ‰¾\n        if ((ph = p.hash) > h)\n            p = pl;\n        // hashæ¯”å½“å‰èŠ‚ç‚¹å¤§ï¼Œå¾€å·¦å³æ ‘å¯»æ‰¾\n        else if (ph < h)\n            p = pr;\n        // æ‰¾åˆ°äº†\n        else if ((pk = p.key) == k || (k != null && k.equals(pk)))\n            return p;\n        // å·¦å­æ ‘ä¸ºç©ºï¼Œæ‰€ä»¥åªèƒ½å‘å³å­æ ‘æ‰¾\n        else if (pl == null)\n            p = pr;\n        // å³å­æ ‘ä¸ºç©ºï¼Œæ‰€ä»¥åªèƒ½å·¦å³å­æ ‘æ‰¾\n        else if (pr == null)\n            p = pl;\n        // ä½¿ç”¨compareToæ¯”è¾ƒ\n        else if ((kc != null ||\n                  (kc = comparableClassFor(k)) != null) &&\n                 (dir = compareComparables(kc, k, pk)) != 0)\n            p = (dir < 0) ? pl : pr;\n        else if ((q = pr.find(h, k, kc)) != null)\n            return q;\n        else\n            p = pl;\n    } while (p != null);\n    return null;\n}\n```\n\n### TreeMap\n\nTreeMap åº•å±‚çš„æ•°æ®ç»“æ„å°±æ˜¯çº¢é»‘æ ‘ï¼ŒTreeMap åˆ©ç”¨äº†çº¢é»‘æ ‘å·¦èŠ‚ç‚¹å°ï¼Œå³èŠ‚ç‚¹å¤§çš„æ€§è´¨ï¼Œæ ¹æ® key è¿›è¡Œæ’åºï¼Œä½¿æ¯ä¸ªå…ƒç´ èƒ½å¤Ÿæ’å…¥åˆ°çº¢é»‘æ ‘å¤§å°é€‚å½“çš„ä½ç½®ï¼Œç»´æŠ¤äº† key çš„å¤§å°å…³ç³»\n\n- æ–°å¢\n\n```java\npublic V put(K key, V value) {\n    Entry<K,V> t = root;\n    // æ ¹èŠ‚ç‚¹ä¸ºç©ºï¼Œç›´æ¥å°†æ’å…¥èŠ‚ç‚¹ä½œä¸ºæ ¹èŠ‚ç‚¹\n    if (t == null) {\n        compare(key, key); // type (and possibly null) check\n        root = new Entry<>(key, value, null);\n        size = 1;\n        modCount++;\n        return null;\n    }\n    int cmp;\n    Entry<K,V> parent;\n    // split comparator and comparable paths\n    Comparator<? super K> cpr = comparator;\n    if (cpr != null) {\n        // éå†æ‰¾åˆ°æ’å…¥èŠ‚ç‚¹åº”è¯¥æ’å…¥çš„ä½ç½®ï¼Œparentä¿å­˜äº†è¯¥ä½ç½®çš„çˆ¶èŠ‚ç‚¹\n        do {\n            parent = t;\n            cmp = cpr.compare(key, t.key);\n            if (cmp < 0)\n                t = t.left;\n            else if (cmp > 0)\n                t = t.right;\n            else\n                return t.setValue(value);\n        } while (t != null);\n    }\n    else {\n        // å®ç°äº†Comparableçš„æƒ…å†µä¸‹çš„æ¯”è¾ƒ\n        if (key == null)\n            throw new NullPointerException();\n        @SuppressWarnings(\"unchecked\")\n            Comparable<? super K> k = (Comparable<? super K>) key;\n        do {\n            parent = t;\n            cmp = k.compareTo(t.key);\n            if (cmp < 0)\n                t = t.left;\n            else if (cmp > 0)\n                t = t.right;\n            else\n                return t.setValue(value);\n        } while (t != null);\n    }\n    Entry<K,V> e = new Entry<>(key, value, parent);\n    if (cmp < 0)\n        parent.left = e;\n    else\n        parent.right = e;\n    fixAfterInsertion(e);\n    size++;\n    modCount++;\n    return null;\n}\n```\n\n### LinkedHashMap\n\nLinkedHashMap æœ¬èº«æ˜¯ç»§æ‰¿ HashMap çš„ï¼Œæ‰€ä»¥å®ƒæ‹¥æœ‰ HashMap çš„æ‰€æœ‰ç‰¹æ€§ï¼Œå†æ­¤åŸºç¡€ä¸Šï¼Œè¿˜æä¾›äº†ä¸¤å¤§ç‰¹æ€§ï¼š\n\n- æŒ‰ç…§æ’å…¥é¡ºåºè¿›è¡Œè®¿é—®ï¼›\n- å®ç°äº†è®¿é—®æœ€å°‘æœ€å…ˆåˆ é™¤åŠŸèƒ½\n\n**æŒ‰ç…§æ’å…¥é¡ºåºæ–°å¢**\n\n```java\n// é€šè¿‡åœ¨åˆ›å»ºæ–°èŠ‚ç‚¹æ—¶ï¼ŒæŠŠè¿™ä¸ªèŠ‚ç‚¹åŠ åˆ°ä¸€ä¸ªé“¾è¡¨çš„æœ€å°¾éƒ¨æ¥ç»´æŠ¤æ’å…¥é¡ºåº\nNode<K,V> newNode(int hash, K key, V value, Node<K,V> e) {\n    LinkedHashMap.Entry<K,V> p =\n        new LinkedHashMap.Entry<>(hash, key, value, e);\n    linkNodeLast(p);\n    return p;\n}\nprivate void linkNodeLast(LinkedHashMap.Entry<K,V> p) {\n    LinkedHashMap.Entry<K,V> last = tail;\n    tail = p;\n    if (last == null)\n        head = p;\n    else {\n        p.before = last;\n        last.after = p;\n    }\n}\n```\n\n**æŒ‰ç…§æ’å…¥é¡ºåºè®¿é—®**\n\n```java\n// è·Ÿé“¾è¡¨çš„è¿­ä»£å™¨ä¸€æ ·\nfinal LinkedHashMap.Entry<K,V> nextNode() {\n    LinkedHashMap.Entry<K,V> e = next;\n    if (modCount != expectedModCount)\n        throw new ConcurrentModificationException();\n    if (e == null)\n        throw new NoSuchElementException();\n    current = e;\n    next = e.after;\n    return e;\n}\n```\n\n**æœ€å°‘è®¿é—®åˆ é™¤çš„å®ç°**\n\nåœ¨getä¹‹åï¼ŒLinkedHashMapä¼šå¯¹è·å–åˆ°çš„èŠ‚ç‚¹æ‰§è¡Œç§»åˆ°é“¾è¡¨å°¾éƒ¨çš„æ“ä½œ\n\n```java\npublic V get(Object key) {\n    Node<K,V> e;\n    if ((e = getNode(hash(key), key)) == null)\n        return null;\n    if (accessOrder)\n        afterNodeAccess(e);\n    return e.value;\n}\n```\n\n```java\n// è¿™æ®µä»£ç æ˜¯è´Ÿè´£æŠŠeç§»åˆ°æœ«å°¾\n// è¿™æ ·å°±é˜Ÿå¤´çš„å…ƒç´ å°±æ˜¯è®¿é—®æœ€å°‘çš„å…ƒç´ \nvoid afterNodeAccess(Node<K,V> e) { // move node to last\n    LinkedHashMap.Entry<K,V> last;\n    if (accessOrder && (last = tail) != e) {\n        LinkedHashMap.Entry<K,V> p =\n            (LinkedHashMap.Entry<K,V>)e, b = p.before, a = p.after;\n        p.after = null;\n        if (b == null)\n            head = a;\n        else\n            b.after = a;\n        if (a != null)\n            a.before = b;\n        else\n            last = b;\n        if (last == null)\n            head = p;\n        else {\n            p.before = last;\n            last.after = p;\n        }\n        tail = p;\n        ++modCount;\n    }\n}\n```\n\n### é—®é¢˜\n\n#### HashMap åº•å±‚æ•°æ®ç»“æ„\n\nåº•å±‚é‡‡ç”¨äº†æ•°ç»„ã€é“¾è¡¨ã€çº¢é»‘æ ‘æ¥å®ç°çš„\n\næ•°ç»„çš„ä¸»è¦ä½œç”¨æ˜¯æŸ¥æ‰¾ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(1)ï¼Œé»˜è®¤å¤§å°16ï¼Œå…ƒç´ å­˜æ”¾çš„ä¸‹æ ‡æ˜¯æ ¹æ®keyçš„hashCodeè®¡ç®—å‡ºæ¥çš„\n\nå…ƒç´ å­˜æ”¾åœ¨Nodeé‡Œé¢ï¼Œå½“keyçš„hashCodeä¸€æ ·æ—¶ï¼Œä½†æ˜¯keyå¹¶ä¸ç›¸ç­‰ï¼ŒNodeå°±ä¼šä¸²èµ·æ¥ï¼Œå½¢æˆé“¾è¡¨ï¼Œé“¾è¡¨çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(N)\n\nå½“é“¾è¡¨é•¿åº¦å¤§äºç­‰äº8ä¸”æ•°ç»„é•¿åº¦å¤§äºç­‰äº64æ—¶ï¼Œé“¾è¡¨å°±ä¼šè½¬æˆçº¢é»‘æ ‘ï¼Œçº¢é»‘æ ‘çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(lg n)\n\n#### HashMapã€TreeMapã€LinkedHashMap ä¸‰è€…æœ‰å•¥ç›¸åŒç‚¹ï¼Œæœ‰å•¥ä¸åŒç‚¹\n\nç›¸åŒç‚¹ï¼š\n\n- éƒ½ä½¿ç”¨äº†çº¢é»‘æ ‘\n- hashç®—æ³•ç›¸åŒ\n- éƒ½éçº¿ç¨‹å®‰å…¨\n\nä¸åŒç‚¹ï¼š\n\n- HashMapæ•°æ®ç»“æ„ä»¥æ•°ç»„ä¸ºä¸»ï¼ŒæŸ¥è¯¢é€Ÿåº¦å¿«ï¼ŒTreeMapåˆ©ç”¨äº†çº¢é»‘æ ‘å·¦å°å³å¤§çš„ç‰¹ç‚¹ï¼Œå¯ä»¥å®ç°å¯¹keyçš„æ’åºï¼ŒLinkedHashMapåˆ™å¢åŠ äº†é“¾è¡¨çš„ç»“æ„ï¼Œå®ç°äº†é¡ºåºè®¿é—®ä»¥åŠæœ€å°‘è®¿é—®åˆ é™¤\n\n#### hashç®—æ³•\n\n```java\nn=array.length;\ntab[i = (n - 1) & hash]\n```\n\nå–æ¨¡ç®—æ³•çš„å¥½å¤„ï¼Œå°±æ˜¯å¯ä»¥ä¿è¯è®¡ç®—å‡ºæ¥çš„ç´¢å¼•ä¸‹æ ‡å€¼å¯ä»¥å‡åŒ€çš„åˆ†å¸ƒåœ¨æ•°ç»„çš„å„ä¸ªç´¢å¼•ä½ç½®ä¸Š\n\nå½“ b æ˜¯ 2 çš„å¹‚æ¬¡æ–¹æ—¶ï¼Œa % b = a &ï¼ˆb-1ï¼‰\n\n#### è§£å†³hashå†²çªçš„åŠæ³•\n\n- å¥½çš„hashç®—æ³•\n- è‡ªåŠ¨æ‰©å®¹\n- å†²çªåä½¿ç”¨é“¾è¡¨ä¸çº¢é»‘æ ‘\n\n#### HashMap æ˜¯å¦‚ä½•æ‰©å®¹çš„\n\n- putæ—¶ï¼Œå‘ç°æ•°ç»„ä¸ºç©ºï¼Œåˆå§‹åŒ–æ‰©å®¹ï¼Œé»˜è®¤å¤§å°16\n- putæˆåŠŸåï¼Œå‘ç°æ•°ç»„å¤§äºç°åœ¨æ•°ç»„çš„å®¹é‡*0.75ï¼Œä¼šè¿›è¡Œæ‰©å®¹ï¼Œæ¯æ¬¡æ‰©å®¹ä¸ºåŸæ¥æ•°ç»„å¤§å°çš„ä¸¤å€\n- æ‰©å®¹ä¹‹åï¼Œéœ€è¦å¯¹æ•°ç»„ä¸­çš„NodeèŠ‚ç‚¹é‡æ–°è®¡ç®—hashå€¼ï¼Œé‡æ–°æ”¾ç½®\n\n#### å¯¹è±¡ä½œä¸º Map çš„ key æ—¶ï¼Œéœ€è¦æ³¨æ„çš„ç‚¹\n\nä¸€å®šéœ€è¦è¦†å†™ equals å’Œ hashCode æ–¹æ³•ï¼Œå¦‚æœæ˜¯ TreeMap çš„è¯ï¼Œéœ€è¦å®ç° Comparable æ¥å£\n\n## Set\n\nHashSetã€TreeSet ä¸¤ä¸ªç±»æ˜¯åœ¨ Map çš„åŸºç¡€ä¸Šç»„è£…èµ·æ¥çš„ç±»\n\n### HashSet\n\nHashSet ä½¿ç”¨çš„å°±æ˜¯ç»„åˆæ–¹å¼æ¥å†…ç½® HashMap\n\n**å¤šç”¨ç»„åˆï¼Œå°‘ç”¨ç»§æ‰¿**\n\n#### æ“ä½œ\n\n- åˆå§‹åŒ–\n\n```java\n// å½“æ ¹æ®ä¼ å…¥çš„é›†åˆè¿›è¡Œåˆå§‹åŒ–æ—¶ï¼Œä¼šæ ¹æ®é›†åˆçš„æ•°é‡è®¡ç®—HashMapå¤§å°\npublic HashSet(Collection<? extends E> c) {\n    map = new HashMap<>(Math.max((int) (c.size()/.75f) + 1, 16));\n    addAll(c);\n}\n```\n\n#### å€¼å¾—å€Ÿé‰´çš„åœ°æ–¹\n\n- ä½¿ç”¨ç»„åˆè¿˜æ˜¯ç»§æ‰¿\n- åŒ…è£…å¤æ‚é€»è¾‘ï¼Œæš´éœ²æ˜“ç”¨api\n- ç»„åˆä½¿ç”¨å…¶ä»–apiæ—¶ï¼Œè¦å¤šäº†è§£ç»„åˆçš„api\n\n### TreeSet\n\nTreeSetåº•å±‚ç»„åˆçš„æ˜¯ TreeMapï¼Œè¿­ä»£çš„æ—¶å€™ï¼Œä¹Ÿå¯ä»¥æŒ‰ç…§ key çš„æ’åºé¡ºåºè¿›è¡Œè¿­ä»£\n\n#### TreeSetå¦‚ä½•å¤ç”¨TreeMapçš„\n\nç¬¬ä¸€ç§æ–¹å¼ï¼šç›´æ¥ä½¿ç”¨\n\n```java\npublic boolean add(E e) {\n    return m.put(e, PRESENT)==null;\n}\n```\n\nç¬¬äºŒç§æ–¹å¼ï¼šå®šä¹‰æ¥å£ï¼Œäº¤ç»™æœåŠ¡æä¾›è€…å®ç°\n\nTreeMapå†…éƒ¨å®ç°äº†NavigableSetæ¥å£æ¥æä¾›ä¸€äº›æ¯”è¾ƒå¤æ‚çš„åŠŸèƒ½\n\n### é—®é¢˜\n\n#### TreeSetçš„ä½¿ç”¨åœºæ™¯\n\nä¸€èˆ¬éƒ½æ˜¯åœ¨éœ€è¦æŠŠå…ƒç´ è¿›è¡Œæ’åºçš„æ—¶å€™ä½¿ç”¨ TreeSetï¼Œä½¿ç”¨æ—¶éœ€è¦æ³¨æ„å…ƒç´ æœ€å¥½å®ç° Comparable æ¥å£\n\n#### å¦‚ä½•æ ¹æ® key çš„æ–°å¢é¡ºåºè¿›è¡Œéå†\n\né€‰æ‹©ä½¿ç”¨ LinkedHashSet\n\n#### å¦‚ä½•å¯¹ key è¿›è¡Œå»é‡\n\nä½¿ç”¨TreeSetï¼ŒTreeSet åº•å±‚ä½¿ç”¨çš„æ˜¯ TreeMapï¼ŒTreeMap åœ¨ put çš„æ—¶å€™ï¼Œå¦‚æœå‘ç° key æ˜¯ç›¸åŒçš„ï¼Œä¼šæŠŠ value å€¼è¿›è¡Œè¦†ç›–ï¼Œæ‰€æœ‰ä¸ä¼šäº§ç”Ÿé‡å¤çš„ key\n","metadata":"","hasMoreCommit":true,"totalCommits":14,"commitList":[{"date":"2026-01-08T11:52:55+08:00","author":"MY","message":"doc(java-collections): é‡æ„æ–‡æ¡£","hash":"e0203004013ac1a831e58f218e6acaca027ed080"},{"date":"2025-09-21T14:03:43+08:00","author":"MY","message":"docs(mindmap): ç»Ÿä¸€æ€ç»´å¯¼å›¾æ ¹èŠ‚ç‚¹æ ¼å¼","hash":"44fc90fa0f22040d171dbf83cd6f2fd8c020444a"},{"date":"2024-11-18T15:00:13+08:00","author":"MY","message":"ğŸ“¦Java åŸºç¡€","hash":"270332d69c4b80cb8600b368ecda389c7c95b038"},{"date":"2023-11-06T20:07:31+08:00","author":"MY","message":"âœé›†åˆ&é¢å‘å¯¹è±¡","hash":"1bc147d8eb110fdddea62531487b7c972fd29f15"},{"date":"2022-10-17T20:48:10+08:00","author":"MY","message":"âœï¸Map","hash":"e50b5c3f8d2492452074933ad046696c785f3fdd"},{"date":"2021-09-09T15:45:23+08:00","author":"cjiping","message":"ğŸ“¦æ•´ç† Java é›†åˆ","hash":"252c795143c74614225c05db16d40cdaded2b684"},{"date":"2021-01-22T08:52:26+08:00","author":"cjiping","message":"âœæ›´æ–° Java é›†åˆ","hash":"82c6aa0a5091e8f6833701cb2ee88b1aec5b9db2"},{"date":"2021-01-21T19:32:24+08:00","author":"cjiping","message":"âœæ›´æ–° Java é›†åˆ","hash":"8a20e3ea6d53fa525ded369f54bab4c12a095c7c"},{"date":"2020-09-23T13:40:12+08:00","author":"MY","message":"âœæ›´æ–° Java é›†åˆ","hash":"4b1c1b27c91ff0294c6003b710ddd89c53c73abd"},{"date":"2020-09-22T11:35:28+08:00","author":"MY","message":"âœæ›´æ–° Java é›†åˆ","hash":"383571b060d89dc78077b25d9d9076d3f1d9853b"}],"createTime":"2019-08-02T11:59:43+08:00"}