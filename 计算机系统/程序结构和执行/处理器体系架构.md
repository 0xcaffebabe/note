# 处理器体系架构

## 中央处理器

**组成**

-  运算器 数据加工
-  控制器 程序执行/指令执行

**主要功能**

![批注 2020-02-13 164218](/assets/批注%202020-02-13%20164218.png)

**主要寄存器**

![批注 2020-02-13 164355](/assets/批注%202020-02-13%20164355.png)

**操作控制器**

取指令，将机器指令译码并生成执行部件控制信号序列 ，建立正确的数据通路，从而完成指令的正确执行

### 数据通路

- 执行部件间传送信息的路径
- 不同指令、同一指令在执行的不同阶段的数据通路不同

**分类**

- 共享通路（总线）
  - 主要部件都连接在公共总线上，各部件间通过总线进行数据传输
  - 结构简单，实现容易，但并发性较差，需分时使用总线，效率低
- 专用通路
  - 并发度高，性能佳，设计复杂，成本高
  - 可以看做多总线结构

#### 数据通路抽象模型（寄存器传输）

![批注 2020-02-13 165456](/assets/批注%202020-02-13%20165456.png)

- 单总线结构：2个锁存器，3个时钟周期

![批注 2020-02-14 083653](/assets/批注%202020-02-14%20083653.png)

- 双总线结构：1个锁存器，2个时钟周期

![批注 2020-02-14 083755](/assets/批注%202020-02-14%20083755.png)

- 三总线结构：0个锁存器，1个时钟周期

![批注 2020-02-14 084048](/assets/批注%202020-02-14%20084048.png)

总线越多，性能越好

### 指令周期

不同指令功能不同，数据通路不同，执行时间不同，如何安排时序

#### 基本概念

时钟周期 = 节拍脉冲 = 震荡周期 能完成一次微操作

机器周期 = CPU周期 从主存读出一条指令的最短时间 可完成 复杂操作

指令周期：从主存取一条指令并执行指令的时间

![批注 2020-02-14 091240](/assets/批注%202020-02-14%20091240.png)

#### 指令控制同步

- 定长指令周期：早期三级时序系统
- 变长指令周期：现代时序系统

#### 现代时许系统

![批注 2020-02-14 092312](/assets/批注%202020-02-14%20092312.png)

## Y86-64 指令集体系结构

## 程序员可见的状态

![enter image description here](http://www.pianshen.com/images/435/14753508889ce7dcecccce599df5835b.png)

## Y86 指令

![enter image description here](https://upload-images.jianshu.io/upload_images/5775602-22dde18ec1e21239.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/580/format/webp)

# Y86-64 异常

- 1 AOK
- 2 HLT
- 3 ADR
- 4 INS

# 逻辑设计和硬件控制语言HCL

## 逻辑门

![enter image description here](https://images2017.cnblogs.com/blog/1120165/201710/1120165-20171018192346584-1264073181.png)

## 组合电路和HCL布尔表达式

限制：

- 输入必须连接到下列之一：

  - 系统输入
  - 某个存储单元的输出
  - 某个逻辑门的输出

- 逻辑门的输出不能连接到一起

- 网必须无环

多路复用器：

![enter image description here](https://img-blog.csdn.net/20170316171027878)

## 字级的组合电路和HCL整数表达式

```hcl
[
    select1:expr1;
    select2:expr2:
    ...
]
```

## 集合关系

![enter image description here](https://images0.cnblogs.com/i/558323/201406/242309370174842.png)

## 存储器和时钟

# Y86-64的顺序实现

## 将处理组织成阶段

- 取指
- 译码
- 执行
- 访存
- 写回
- 更新PC

## SEQ硬件结构

## SEQ时序

# 流水线的通用原理

## 未流水线化

![](https://bobcn.github.io/image/2018/03/un_pipeline.png?120)

## 流水线化

![](https://bobcn.github.io/image/2018/03/pipeline.png?120)




