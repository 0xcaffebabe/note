{"name":"云计算","id":"计算机网络-云计算","content":"# 云计算\n\n## 背景\n\n- 按需自助服务\n- 普适的网络访问\n- 资源池\n- 快速可伸缩\n- 服务可计量\n\n## 基础\n\n- 并行计算\n- 分布式计算\n- 网格计算\n\n## 生态系统\n\n- 硬件\n- 软件\n- 服务\n- 网络\n- 安全\n\n## 部署模式\n\n- 公有云\n- 私有云\n- 混合云\n\n## 数据中心\n\n数据集中存储、计算、交换的中心\n\n### 软件定义数据中心\n\n![批注 2020-05-25 143140](/assets/批注%202020-05-25%20143140.png)\n\n## IaaS\n\n- 虚拟化\n- 负载均衡\n- 自动扩展\n\n通过声明式编程 从而能自动化基础架构\n\n### 区域\n\n区域：一般以国家或地区命名，相当程度地体现了云厂商的业务重点和地区倾向，一般要不选择经济发达地区，要不选择省资源的地区\n\n可用区：一个区域通常由多个可用区高速互联组成\n\n### 虚拟机\n\nvCPU 数和内存大小（按 GB 计算）的比例，是决定和区分虚拟机类型的重要指征之一\n\n- 通用均衡型的比例通常是 1:4\n- 计算密集型是 1:2 甚至 1:1\n- 内存优化型 一般是1:8 及以上\n- 图形计算型\n\n虚拟机的换代，往往首先会带来相应硬件 CPU 的换代提升，其次是底层软硬件架构的更新和提升，尤其是虚拟化技术的改进\n\n- 包年包月机型：降低了云端动态租用的不确定性，减少了服务器空置的情况\n- 竞价实例：闲置的机器资源拿出来，进行公开的拍卖，价高者得，这意味着资源随时有可能被回收\n- 突发性能类型：CPU 性能表现采用的是积分制，其积分会随着时间的推移匀速累加，也会随着算力的输出而被不断消耗，当积分不足或耗尽时，则 CPU 只能发挥出标称值的一小部分性能\n- ARM 实例：价格也很低，主要在生态和兼容性方面存在一些限制\n\n#### 检查点\n\n也就是虚拟机快照，快照就是复制内存、CPU状态等，但对于网络通信这种，则无法解决\n\n### 云硬盘\n\n云硬盘是在专用的磁盘服务器阵列中，与虚拟机是通过数据中心内部的特有 IO 线路进行连接\n\n一块大盘被分成小盘，与此同时会把大盘的读写总通道中分给小盘作为IO能力，在同等的性能等级下，云硬盘的容量越大，一般来说它的性能就越高，直到达到这个等级的上限\n\n### 虚拟网络\n\nVPC：虚拟私有网络（Virtual Private Cloud）\n\n- 网段，私有网络的内部 IP 区段，通常用 CIDR 形式来表达，\n- 子网，私有网络的下级网络结构，一个私有网络可以划分多个子网，这和通常意义上的子网也是对应和一致的。阿里云中把子网形象地称为“交换机”\n- 路由表，用于定义私有网络内流量的路由规则，决定着数据包的“下一跳”去向何方\n- 网关，是对进出私有网络的流量进行把守和分发的重要节点\n- 安全组，私有网络里虚拟机进出流量的通行或拦截规则\n\n虚拟机通过挂载VPC的虚拟网卡来加入VPC，而虚拟机的公网IP则是通过弹性IP来绑定\n\n为了让VPC内部的虚拟机可以对外访问，云服务商提供了添加NAT网关的方式来实现\n\n如果要让两个VPC之间互通，有种称为对等连接的方式可以实现，而多个VPC互通就要使用更高级的企业专网来实现了\n\n如果要实现混合云，轻量级的方案可以使用VPN，如果要追求性能何延迟，那就要拉专线了\n\n### 容错\n\n对于虚拟机的存放，要做容错，就要分散存放，分散程度：宿主机 < 可用区 < 区域\n\n### 伸缩\n\n虚拟机可以创建自定义镜像，并部署多个实例，配合负载均衡器来实现处理能力的扩展，同时也可以配置伸缩规则来伸缩实例\n\n### 运维\n\n云运维侧重点：\n\n- 监控\n- 备份\n- 迁移\n- 与云厂商对接\n- 云资源的管理、云相关操作的制度流程制定执行...\n\n## PaaS\n\n在 IaaS 的基础上又做了许多工作，构建了很多关键抽象和可复用的单元，让用户能够在更上层进行应用的构建\n\n优势：搭建和运维层面更有生产力及效率\n\n衡量PaaS：\n\n- 是否带有内生的运行环境\n- 存在的位置和范围，以及给予的控制粒度\n- 是否有状态\n- 支撑 PaaS 的虚拟机是否对外暴露\n\nPaaS封装带来了生产力效率提升，同时也带了调教设置灵活性的困扰\n\n### 对象存储\n\n与云硬盘的区别：\n\n- 对象存储一般暴露为HTTP接口，云硬盘则是操作系统级别的底层接口\n- 对象存储更像是一种KV数据库\n- 对象存储容量近乎无限扩展\n\n高级特性：\n\n- 冷热数据分层存储，降低存储成本\n- 生命周期管理，可根据设定的规则自动对数据进行归档或者删除\n- 对象版本管理\n\n### 应用托管\n\n云厂商提供受限的程序运行环境，需要做的就是上传代码即可\n\n在此基础上额外的服务：\n\n- 监控\n- 自动扩缩容\n- 与云平台的PaaS集成\n\n### 云数据库\n\n既有传统的关系型数据库，也有专门为云而设计的数据库，这些数据库大都兼容了已有的接口，应用都可以无缝迁移，相较于自己的数据库，云上数据库的优势在于：\n\n- 更容易的扩展，自动化设施使得读写分离等很容易\n- 自动调优，云平台帮助分析SQL性能，给出建议\n\n专门跑在云上的数据库，比如DynamoDB、Aurora等，可扩展性、可用性更强\n\n### 云上大数据\n\n存储与计算解耦的更多：\n\n- 存储端可以直接读写云平台已有的服务\n- 计算端得益于云的弹性，可以有效地降低成本\n\n### 云容器\n\n云上的容器调度服务由于多租户的特性，使得只需要创建 Worker 节点，并为之付费，由云平台来管理 Master 节点，另外跟容器有关的云服务就是容器镜像服务\n\n更加方便易用的全托管容器服务。更是不用自己管理集群，只要上传镜像，容器就能托管在上面\n\n### 无服务器计算\n\n通过各式各样的触发器来发布事件给编写函数进行处理，各种云之间没有标准，这是一种强厂商绑定的技术，复杂的业务也不适用，这是一些需要注意的点\n\n### 云上AI\n\n一些开箱即用的服务：图像识别、语音识别、视频处理等\n\n云平台也提供了从数据标注到模型部署的一站式开发平台来标准化AI的开发工作\n\n## 虚拟化技术\n\n虚拟化技术的核心思想是利用软件或固件管理程序构成虚拟化层，把物理资源映射为虛拟资源\n\n### 服务器虚拟化\n\n- 寄居虚拟化\n- 裸机虚拟化\n\n-|全虚拟化|半虚拟化|硬件虚拟化\n-|-|-|-\n特点|VMM向虚拟机模拟出和真实硬件完全相同的硬件环境|VMM需要操作系统的协助才能够完成对x86敏感特权指令的虚拟化|VMM需要硬件的协助才能完成对硬件资源的虚拟\n优点|不用修改Guest0S|性能高，能达到与原始系统相近的性能|不用修改GuestOS内核\n缺点|虚拟化平台给处理器带来开销|必须修改Guest OS|需要硬件支持\n代表产品|VMware;Virtual PC|Xen；Denali|Intel VT;AMD-V\n\n**虚拟机迁移**\n\n```mermaid\nsequenceDiagram\n  源宿主机 ->> 源宿主机: 预迁移\n  源宿主机 ->> 目标宿主机: 预定资源\n  源宿主机 ->> 目标宿主机: 预复制\n  源宿主机 ->> 目标宿主机: 停机复制\n  目标宿主机 ->> 源宿主机: 提交\n  目标宿主机 ->> 目标宿主机: 启动\n```\n\n停机并迁移数据很简单\n\n另外一种方式是热迁移，也就是在虚拟机运行时，直接复制内存，当内存发生变更，将变更的内存再复制，直至双边一致，这跟数据库数据[双写迁移](/中间件/数据库/mysql/数据库优化.md#分库分表)原理是一样的\n\n### 存储虚拟化\n\n存储虚拟化是指将存储网络中各个分散且异构的存储设备按照一定的策略映射成一个统一的连续编址的逻辑存储空间，称为虚拟存储池，并将虚拟存储池的访问接口提供给应用系统。\n\n### 网络虚拟化\n\n- 网卡虚拟化\n- 硬件设备虚拟化\n- 链路虚拟化\n\n## 混合云\n\n### 优势\n\n- 可控 & 开箱即用\n- 周期性应用/试点应用\n- 业务高峰分流\n- 成本控制\n- 平滑转型\n\n### 连接\n\n#### 入口分流\n\n- CDN\n- SLB软件负载均衡器\n\n#### 安全\n\nDDoS -> WAF -> SLB -> 系统安全\n\n#### 容灾多活\n\n- 数据同步\n\n### 技术难点\n\n#### 安全\n\n- 跨数据中心的账号管理\n- 符合法律法规\n- 网络隔离\n\n#### 运维\n\n- 统一发布\n- 统一监控\n- 资源调配\n\n## 云安全技术\n\n- 可信访问控制\n- 数据存在与可使用性证明\n- 数据隐私保护\n- 虚拟安全技术\n- 云资源访问控制\n\n## 开源云计算管理平台\n\n- open stack\n\n## 数据中心网络\n\n![三层南北网络](/assets/2023523112153.webp)\n\n![堆叠双活](/assets/2023523112850.webp)\n\n- 边界路由器：数据中心的入口与出口，为了高可用，边界路由器会有多个\n- 接入层交换机：连接统一机架上的服务器，LACP（Link Aggregation Control Protocol）协议可以使服务器与交换机进行通信，将服务器的多个网卡聚合称为一个网卡，多个网线聚合成一个网线，在网线之间可以进行负载均衡\n- 汇聚层交换机：连接多个机器之间的交换机\n\n汇聚层将大量的计算节点相互连接在一起，形成一个集群。在这个集群里面，服务器之间通过二层互通，这个区域常称为一个 POD（Point Of Delivery），有时候也称为一个可用区（Available Zone）。连接多个可用区的交换机称为核心交换机\n\n![解决东西流量演进的叶脊网络（Spine/Leaf）](/assets/2023523113652.webp)\n\n- 叶子交换机（leaf），直接连接物理服务器。L2/L3 网络的分界点在叶子交换机上，叶子交换机之上是三层网络\n- 脊交换机（spine switch），相当于核心交换机。叶脊之间通过 ECMP 动态选择多条路径。脊交换机现在只是为叶子交换机提供一个弹性的 L3 路由网络。南北流量可以不用直接从脊交换机发出，而是通过与 leaf 交换机并行的交换机，再接到边界路由器出去\n","metadata":"","hasMoreCommit":true,"totalCommits":14,"commitList":[{"date":"2024-11-13T19:11:32+08:00","author":"MY","message":"📦操作系统","hash":"e61620c72f4b61f38fd4124dcae670b77ff2f358"},{"date":"2024-11-01T16:01:02+08:00","author":"MY","message":"✏更新虚拟机迁移","hash":"d6d8169017b2a6c7c92cf539292416ea344e0b41"},{"date":"2023-11-27T17:19:45+08:00","author":"MY","message":"📦清理大图","hash":"fafd16978c7437cbbe855ac44c6d7d3c89b3ddb6"},{"date":"2023-05-23T17:26:34+08:00","author":"MY","message":"✏计算机网络","hash":"3b4ce4e0592ec2485ab9ff276a35a56c7ef3400b"},{"date":"2023-03-21T15:29:03+08:00","author":"MY","message":"更新 云计算","hash":"4ee16a9641bf7fba49e41e6fe418627cbb53eef4"},{"date":"2023-03-20T17:09:12+08:00","author":"MY","message":"更新 云计算","hash":"7e15638d8d0e59bad9909427cef1b18bd27f72f7"},{"date":"2023-03-17T17:35:11+08:00","author":"MY","message":"更新 云计算","hash":"c6e32c1318392e439ac4ce815b809ff7d241b5d6"},{"date":"2023-03-16T17:28:37+08:00","author":"MY","message":"更新 云计算","hash":"fd5f9305ff478c3a313527f6d60727a07624fe7c"},{"date":"2020-05-28T15:37:25+08:00","author":"MY","message":"更新 云计算","hash":"c15f5cd9fc116a1360d47a149b4e27e8b2940b74"},{"date":"2020-05-28T15:04:43+08:00","author":"MY","message":"增加 云安全技术","hash":"0c136906bd10d9795af039e5dfbda2935d21650d"}],"createTime":"2020-05-18T14:47:00+08:00"}