- 运输层的功能：为不同主机上的进程提供逻辑通信 

**运输层与网络层的关系**：网络层为运输层提供服务，运输层构建在网络层之上

# 运输层协议

- TCP
- UDP

运输层通过Socket端口来实现多路复用与多路分解

## UDP

- 对发送时间以及发送内容控制能力更强
- 无连接
- 无状态
- 分组首部小

![](https://pic4.zhimg.com/80/v2-84c4fa70b1d2ebd55e835edc78c56493_hd.png)

## TCP

![](https://img-blog.csdnimg.cn/20181130165347546.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxMzA4MDI3,size_16,color_FFFFFF,t_70)


RST/SYN/FIN 用于连接的建立与拆除

URG 代表是上层紧急数据

ACK 确认

PSH 尽快交给应用层

### RTT 估计

```java
均值RTT = 0.875 * 均值RTT + 0.125 * 样本RTT
```

### 可靠数据传输

![](https://images2017.cnblogs.com/blog/1099419/201801/1099419-20180128214133944-329653643.png)

### 流量控制

接收方通过在报文段中添加接口窗口字段来进行双方之间的速度匹配

### 连接管理

#### 建立

![](https://img-blog.csdn.net/20170104214009596?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2h1c2xlaQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)

#### 关闭

![](http://hi.csdn.net/attachment/201108/7/0_1312718564tZXD.gif)

### 拥塞控制

#### 原则

- 报文段丢失时发送方降低速率
- 未确认报文段确认到达时，发送方增加速率
- 带宽探测

#### 慢启动

![](http://www.51cto.com/files/uploadimg/20121231/0954250.jpg)

不断增加直到超时

### 公平性

UDP源有可能压制TCP流量

- 明确拥塞通知：由路由器在报文中插入当前路由器的拥塞情况