{"name":"前端监控","id":"软件工程-架构-系统设计-前端监控","content":"\n# 前端监控\n\n## 指标\n\n```mermaid\nmindmap\n  root((基础数据类型))\n    基本日志数据\n      唯一键值traceId\n      日志类型type\n      日志产生时间createAt\n      日志最后更新时间updatedAt\n    浏览器信息\n      浏览器UserAgent\n      浏览器类型BrowserType\n    页面信息\n      页面ID\n      页面地址URL\n      ?页面标题\n    用户信息\n      指纹ID\n      用户ID\n      ?用户名\n      ?用户邮箱\n    业务信息\n      业务标识appld\n      ?业务名称appName\n      客户端类型clientType\n      日志类型level\n```\n\n```mermaid\nmindmap\n  root((以代码维度的字段))\n    异常信息，data\n      代码异常\n        通用字段\n          代码堆栈，stack\n      网络请求\n        通用字段\n          请求耗时，elapsedTime\n          请求方法，method\n          请求类型，httpType\n          API地址，url\n          请求参数，body\n          响应状态，status\n      自定义日志\n        通用字段\n          打标签，tag\n      PVUV日志\n        通用字段\n          路由地址，route\n      Promise日志\n        通用字段\n      资源日志\n        通用字段\n    通用字段\n      问题ID，dataId\n      日志名称，name\n      问题级别，level\n      问题信息，message\n      问题发生事件，time\n      问题类型，type\n    页面性能，perf\n      日志id\n      指标名称，name\n      指标值，value\n      当前值和上次获取值的差值，delta\n      判断性能级别，rating\n    操作行为，breadcrumbs\n      行为名称，name\n      行为级别，level\n      行为类型，type\n      行为分类，category\n      发生时间，time\n\n```\n\n## WebVitals\n\n- 网页加载速度指标 LCP（Largest Contentful Paint）：记录页面首屏可见区域中最大元素的呈现时间\n- 网页可交互指标 FID（First Input Delay）：从用户首次和 Web 应用互动到浏览器实际开始处理事件或者处理脚本，响应用户互动的这段时间\n- 网页视觉稳定性指标 CLS（Cumulative Layout Shift）：这个指标更多的是判断用户的视觉上的体验，也就是在浏览器可视区内现有元素发生位置的改变，触发布局偏移，是否影响用户的使用体验\n- 首次内容绘制 FCP（Firs1t Contentful Paint）：记录页面首次渲染的时间\n- 互动响应速度 INP （Interaction to Next Paint）：监听用户交互互动到页面响应的延迟时间\n- 可交互时间 TTI （Time to Interactive）：衡量从网页开始加载到其主要子资源加载完成的时间\n- 总阻塞时间 TBT (Total Blocking Time)：衡量页面渲染期间，主线程阻塞的时间，超过50ms的阻塞时间，会被记录下来，作为页面渲染的延迟\n- 首字节时间 TTFB (Time to First Byte)：记录页面请求到响应的第一个字节的时间\n\n指标|体验好|需要改进|体验差\n-|-|-|-\nLCP|<2.5s|2.5s LCP <4s|>4s\nFID|<100ms|100ms < FID < 300ms|>300ms\nCLS|<0.1|0.1 < CLS < 0.25| >0.25\nFCP|<1.8s|1.8s < FCP < 3s|>3s\nINP|<200ms|200ms < INP < 500ms|>500ms\nTTFB|<800ms|800ms< TTFB< 1800ms|>1800ms\n\n```text\nTTFB    |\n             FP|\n                  FCP|\n                         LCP|\n```\n\nTTFB 最早发生，FP (First Paint) 紧接着 TTFB 之后发生，FCP 紧接着 FP 之后发生，LCP 紧接着 LCP 之后发生\n\n## 接口异常监听\n\n通过拦截 ajax 请求接口，来实现如下目标：\n\n- HTTP 响应码\n- 请求中断\n- 请求超时\n\n## 资源脚本异常监听\n\n通过全局的 onerror 监听或者框架提供的全局 errorHandle，实现全局的资源加载异常或脚本异常监听\n\n## 全局操作监听\n\n通过全局的 onxx 监听，实现全局的点击、键盘等事件监听，包括：\n\n- 鼠标点击\n- 键盘点击\n- 触摸点击\n- 触摸滑动\n- ...\n\n## 数据上报方式\n\n- fetch/xhr\n- beacon api\n- 通过请求小图片在url中携带数据\n","metadata":"","hasMoreCommit":false,"totalCommits":4,"commitList":[{"date":"2025-09-21T14:03:43+08:00","author":"MY","message":"docs(mindmap): 统一思维导图根节点格式","hash":"44fc90fa0f22040d171dbf83cd6f2fd8c020444a"},{"date":"2024-07-15T19:59:30+08:00","author":"MY","message":"✏前端性能优化","hash":"030a3f5157dcbb5d0454cad768dbfd94ca5641ee"},{"date":"2024-07-12T15:34:07+08:00","author":"MY","message":"✏前端监控","hash":"b6e57d76d75e5af300cb0d5c25744fe0d8b8a104"},{"date":"2024-07-11T19:37:49+08:00","author":"MY","message":"➕前端监控","hash":"884cd2d81b6d256bc2a431aea4719f056a51b54d"}],"createTime":"2024-07-11T19:37:49+08:00"}