{"name":"K8s","id":"è¿ç»´-K8s","content":"# Kubernetes\n\n## ä¸€ã€Kubernetes çš„æœ¬è´¨\n\n### 1. Kubernetes çš„æ ¸å¿ƒå‘½é¢˜\n\nåœ¨æŠ½ç¦»æ‰€æœ‰æŠ€æœ¯ç»†èŠ‚ä¹‹åï¼ŒKubernetes è¦è§£å†³çš„æœ¬è´¨é—®é¢˜åªæœ‰ä¸€ä¸ªï¼š\n\n> **å¦‚ä½•åœ¨ä¸ç¡®å®šçš„åŸºç¡€è®¾æ–½ä¹‹ä¸Šï¼Œå¯é åœ°è¿è¡Œç¡®å®šçš„åº”ç”¨æ„å›¾ï¼Ÿ**\n\næ›´æŠ½è±¡åœ°è¯´ï¼š\n\n* åº”ç”¨æœŸæœ›æ˜¯ç¨³å®šçš„\n* è¿è¡Œç¯å¢ƒæ˜¯åŠ¨æ€çš„\n* Kubernetes çš„ä½¿å‘½æ˜¯ï¼š\n  **åœ¨åŠ¨æ€ä¸–ç•Œä¸­ç»´æŒç¨³å®šæ„å›¾**\n\n---\n\n### 2. Kubernetes çš„å“²å­¦åŸºç¡€\n\nKubernetes çš„è®¾è®¡åŸºäºå››ä¸ªæ ¹æœ¬æ€æƒ³ï¼š\n\n| æ€æƒ³       | å«ä¹‰                   |\n| -------- | -------------------- |\n| å£°æ˜å¼      | æè¿°â€œè¦ä»€ä¹ˆâ€ï¼Œè€Œä¸æ˜¯â€œæ€ä¹ˆåšâ€     |\n| æ§åˆ¶å™¨æ¨¡å‹    | é€šè¿‡ä¸æ–­å¯¹æ¯”æœŸæœ›çŠ¶æ€ä¸å®é™…çŠ¶æ€æ¥ä¿®æ­£ç³»ç»Ÿ |\n| èµ„æºæŠ½è±¡     | ç”¨ç»Ÿä¸€çš„ API æè¿°ä¸€åˆ‡        |\n| åŸºç¡€è®¾æ–½å³èµ„æºæ±  | å±è”½åº•å±‚èŠ‚ç‚¹å·®å¼‚             |\n\n---\n\n### 3. Kubernetes çš„æŠ½è±¡å…¬å¼\n\nä»è®¤çŸ¥é«˜åº¦ï¼Œå¯ä»¥æŠŠ Kubernetes æŠ½è±¡ä¸ºï¼š\n\n```\nç”¨æˆ·æ„å›¾ï¼ˆYAMLï¼‰  \n   â†“\nAPI Serverï¼ˆæœŸæœ›çŠ¶æ€å­˜å‚¨ï¼‰  \n   â†“\næ§åˆ¶å™¨æ¨¡å‹ï¼ˆReconciliation Loopï¼‰  \n   â†“\nè°ƒåº¦ + æ‰§è¡Œ  \n   â†“\næœ€ç»ˆè¿è¡Œæ€\n```\n\n---\n\n## äºŒã€Kubernetes çš„ç»Ÿä¸€è®¤çŸ¥æ¨¡å‹\n\n### 1. ä¸‰å±‚ç»Ÿä¸€æ¶æ„\n\nKubernetes å¯ä»¥è¢«ç®€åŒ–ä¸ºä¸‰å±‚æ¨¡å‹ï¼š\n\n```\n+-----------------------------+\n|        API & èµ„æºå±‚         |\n|  Pod / Service / Deployment |\n+-----------------------------+\n|         æ§åˆ¶å±‚              |\n| Controller + Scheduler      |\n+-----------------------------+\n|         æ‰§è¡Œå±‚              |\n| kubelet + CRI + CNI        |\n+-----------------------------+\n```\n\n* **API å±‚**ï¼šç»Ÿä¸€è¡¨è¾¾æ„å›¾\n* **æ§åˆ¶å±‚**ï¼šç»´æŒç³»ç»Ÿæ”¶æ•›\n* **æ‰§è¡Œå±‚**ï¼šæŠŠæŠ½è±¡å˜ä¸ºç°å®\n\n---\n\n### 2. æ§åˆ¶å™¨æ¨¡å‹ï¼šKubernetes çš„å¿ƒè„\n\nä¸€åˆ‡ Kubernetes ç»„ä»¶éƒ½éµå¾ªåŒä¸€èŒƒå¼ï¼š\n\n```go\nfor {\n    actual := getActualState()\n    desired := getDesiredState()\n    if actual != desired {\n        makeThemEqual()\n    }\n}\n```\n\nè¿™å°±æ˜¯ Kubernetes æœ€æ ¸å¿ƒçš„ç¬¬ä¸€æ€§åŸç†ï¼š\n\n> **æœŸæœ›çŠ¶æ€é©±åŠ¨çš„è‡ªåŠ¨åŒ–æ”¶æ•›ç³»ç»Ÿ**\n\n---\n\n## ä¸‰ã€æ¶æ„ï¼šä»å®è§‚åˆ°å¾®è§‚\n\n### 1. æ§åˆ¶å¹³é¢ï¼ˆControl Planeï¼‰\n\næ§åˆ¶å¹³é¢çš„æœ¬è´¨æ˜¯ï¼š\n\n> ä¸€ä¸ªåˆ†å¸ƒå¼æ„å›¾å¤„ç†ç³»ç»Ÿ\n\n| ç»„ä»¶                 | æœ¬è´¨èŒè´£ |\n| ------------------ | ---- |\n| API Server         | æ„å›¾ç½‘å…³ |\n| etcd               | çŠ¶æ€ä¹‹æº |\n| Scheduler          | èµ„æºå†³ç­– |\n| Controller Manager | çŠ¶æ€æ”¶æ•› |\n\n---\n\n#### ï¼ˆ1ï¼‰API Serverï¼šå”¯ä¸€å…¥å£\n\n* æ‰€æœ‰ç»„ä»¶åªä¸ API Server é€šä¿¡\n* æ„æˆâ€œå•ä¸€çœŸç›¸æºâ€\n* æä¾›ï¼š\n\n  * è®¤è¯\n  * æˆæƒ\n  * å®¡è®¡\n  * èµ„æºå˜æ›´é€šçŸ¥\n\n**æœ¬è´¨ï¼š**\n\n> API Server = Kubernetes çš„â€œå¤§è„‘çš®å±‚â€\n\n---\n\n#### ï¼ˆ2ï¼‰etcdï¼šçŠ¶æ€ä¸­æ¢\n\n* ä¿å­˜æ‰€æœ‰æœŸæœ›çŠ¶æ€\n* ä½¿ç”¨ Raft ç®—æ³•ä¿è¯ä¸€è‡´æ€§\n\næœ¬è´¨å…¬å¼ï¼š\n\n```\nKubernetes çš„å¯é æ€§ â‰ˆ etcd çš„å¯é æ€§\n```\n\n---\n\n#### ï¼ˆ3ï¼‰Schedulerï¼šèµ„æºè°ƒåº¦å™¨\n\nè°ƒåº¦æœ¬è´¨ï¼š\n\n> åœ¨èµ„æºæ± ä¸­å¯»æ‰¾æœ€åˆé€‚çš„èŠ‚ç‚¹\n\né€»è¾‘æ¨¡å‹ï¼š\n\n```\næœªè°ƒåº¦ Pod  \n   â†“\nè¿‡æ»¤å¯ç”¨èŠ‚ç‚¹  \n   â†“\næ‰“åˆ†  \n   â†“\nç»‘å®šèŠ‚ç‚¹\n```\n\n---\n\n#### ï¼ˆ4ï¼‰Controller Managerï¼šç³»ç»Ÿç¨³å®šå™¨\n\nè´Ÿè´£è®©ç³»ç»Ÿï¼š\n\n> ä»â€œå®é™…çŠ¶æ€â€ â†’ â€œæœŸæœ›çŠ¶æ€â€\n\n---\n\n### 2. æ‰§è¡Œå¹³é¢ï¼ˆNodeï¼‰\n\n#### ï¼ˆ1ï¼‰Kubelet\n\næœ¬è´¨ï¼š\n\n> â€œèŠ‚ç‚¹ä¸Šçš„æ‰§è¡Œä»£ç†â€\n\n* æŠŠ Pod æè¿°å˜ä¸ºçœŸå®å®¹å™¨\n* è´Ÿè´£ï¼š\n\n  * ç”Ÿå‘½å‘¨æœŸ\n  * å¥åº·æ£€æŸ¥\n  * å·æŒ‚è½½\n\n---\n\n#### ï¼ˆ2ï¼‰kube-proxy\n\næœ¬è´¨ï¼š\n\n> Service ç½‘ç»œè§„åˆ™æ§åˆ¶å™¨\n\nçœŸæ­£è½¬å‘æµé‡çš„æ˜¯ï¼š\n\n* iptables\n* ipvs\n\nkube-proxy çš„å®šä½ï¼š\n\n> ä¸æ˜¯ä»£ç†ï¼Œè€Œæ˜¯â€œè§„åˆ™ç¼–ç¨‹å™¨â€\n\n---\n\n#### ï¼ˆ3ï¼‰CRI / CNI / CSI\n\n| æ¥å£  | æŠ½è±¡ç›®çš„  |\n| --- | ----- |\n| CRI | è¿è¡Œæ—¶è§£è€¦ |\n| CNI | ç½‘ç»œè§£è€¦  |\n| CSI | å­˜å‚¨è§£è€¦  |\n\nä½“ç° Kubernetes çš„æ ¸å¿ƒè®¾è®¡æ€æƒ³ï¼š\n\n> ä¸€åˆ‡çš†å¯æ’æ‹”\n\n---\n\n## å››ã€å¯¹è±¡æ¨¡å‹ï¼šKubernetes çš„è¯­è¨€\n\n### 1. Pod â€”â€” æœ€å°è¿è¡Œå•å…ƒ\n\n**æœ¬è´¨å®šä¹‰ï¼š**\n\n> Pod = ä¸€ä¸ªé€»è¾‘ä¸»æœº\n\n* å…±äº«ï¼š\n\n  * Network Namespace\n  * UTS Namespace\n  * å­˜å‚¨å·\n\nå®¹å™¨ä¸ Pod çš„å…³ç³»ï¼š\n\n| æ¯”å–»å±‚       | å¯¹åº” |\n| --------- | -- |\n| Pod       | æœºå™¨ |\n| Container | è¿›ç¨‹ |\n\n---\n\n### 2. Service â€”â€” ç¨³å®šå…¥å£\n\nService çš„æœ¬è´¨ï¼š\n\n> ä¸ºåŠ¨æ€ Pod é›†åˆæä¾›ç¨³å®šè®¿é—®ç‚¹\n\nä¸‰å¤§åŠŸèƒ½ï¼š\n\n* è™šæ‹Ÿ IP\n* è´Ÿè½½å‡è¡¡\n* æœåŠ¡å‘ç°\n\n---\n\n### 3. Deployment â€”â€” æ— çŠ¶æ€ç®¡ç†å™¨\n\næœ¬è´¨ï¼š\n\n> ç‰ˆæœ¬åŒ–çš„å‰¯æœ¬æ§åˆ¶å™¨\n\n```\nDeployment\n   â†“\nReplicaSet\n   â†“\nPod\n```\n\n---\n\n### 4. StatefulSet â€”â€” çŠ¶æ€åŒ–ç®¡ç†å™¨\n\nè§£å†³ä¸¤ä¸ªé—®é¢˜ï¼š\n\n| ç»´åº¦   | å«ä¹‰     |\n| ---- | ------ |\n| æ‹“æ‰‘çŠ¶æ€ | ç¼–å·é¡ºåº   |\n| å­˜å‚¨çŠ¶æ€ | ç‹¬ç«‹ PVC |\n\n---\n\n### 5. DaemonSet / Job / CronJob\n\n| å¯¹è±¡        | åœºæ™¯æœ¬è´¨   |\n| --------- | ------ |\n| DaemonSet | èŠ‚ç‚¹å®ˆæŠ¤è¿›ç¨‹ |\n| Job       | ä¸€æ¬¡æ€§ä»»åŠ¡  |\n| CronJob   | å®šæ—¶ä»»åŠ¡   |\n\n---\n\n## äº”ã€ç½‘ç»œæ¨¡å‹\n\nKubernetes ç½‘ç»œçš„ç¬¬ä¸€æ€§åŸç†ï¼š\n\n> ä»»ä½• Pod å¯ä»¥æ—  NAT ç›´è¿ä»»ä½• Pod\n\n---\n\n### æ ¸å¿ƒæŠ½è±¡\n\n* CNI æ’ä»¶è´Ÿè´£å®ç°\n* Service æä¾›ç¨³å®šå…¥å£\n* Ingress/Gateway æä¾›å—åŒ—å‘æµé‡\n\n---\n\n## å…­ã€å­˜å‚¨æ¨¡å‹\n\nKubernetes å­˜å‚¨çš„æ ¸å¿ƒç†å¿µï¼š\n\n> å­˜å‚¨ä¸è®¡ç®—è§£è€¦\n\næŠ½è±¡å±‚çº§ï¼š\n\n```\nPod\n  â†“\nPVCï¼ˆå£°æ˜ï¼‰\n  â†“\nPVï¼ˆèµ„æºï¼‰\n  â†“\nStorageClassï¼ˆç­–ç•¥ï¼‰\n```\n\n---\n\n## ä¸ƒã€å®‰å…¨æ¨¡å‹\n\nKubernetes å®‰å…¨çš„ä¸‰ä¸ªç»´åº¦ï¼š\n\n| ç»´åº¦ | æœºåˆ¶             |\n| -- | -------------- |\n| èº«ä»½ | ServiceAccount |\n| æƒé™ | RBAC           |\n| éš”ç¦» | NetworkPolicy  |\n\n---\n\n## å…«ã€å¯è§‚æµ‹æ€§æ¨¡å‹\n\nç°ä»£è¿ç»´ä¸‰ä»¶å¥—ï¼š\n\n| èƒ½åŠ›      | å®ç°            |\n| ------- | ------------- |\n| Metrics | Prometheus    |\n| Logging | EFK/ELK       |\n| Tracing | OpenTelemetry |\n\n---\n\n## ä¹ã€è¿ç»´æ–¹æ³•è®º\n\n### 1. èµ„æºç®¡ç†åŸåˆ™\n\n* æ˜ç¡® requests\n* åˆç† limits\n* ä¾èµ– QoS\n\n---\n\n### 2. å‘å¸ƒç­–ç•¥\n\n| æ¨¡å¼   | åœºæ™¯   |\n| ---- | ---- |\n| æ»šåŠ¨æ›´æ–° | å¸¸è§„å‘å¸ƒ |\n| è“ç»¿å‘å¸ƒ | å¤§ç‰ˆæœ¬  |\n| é‡‘ä¸é›€  | ç°åº¦   |\n\n---\n\n### 3. é«˜å¯ç”¨è®¾è®¡\n\n* æ§åˆ¶å¹³é¢å¤šå®ä¾‹\n* etcd é›†ç¾¤\n* æ— çŠ¶æ€ä¼˜å…ˆ\n\n---\n\n## åã€æœ€ä½³å®è·µåŸåˆ™\n\n### åº”ç”¨è®¾è®¡åŸåˆ™\n\n* é¢å‘å¤±è´¥è®¾è®¡\n* æ— çŠ¶æ€ä¼˜å…ˆ\n* å¯è§‚æµ‹ä¼˜å…ˆ\n\n---\n\n### è¿ç»´å®è·µåŸåˆ™\n\n* ä¸ä½¿ç”¨ latest\n* å……åˆ†åˆ©ç”¨æ¢é’ˆ\n* æ—¥å¿— stdout åŒ–\n\n---\n\n## åä¸€ã€Kubernetes çš„è¾¹ç•Œ\n\nKubernetes ä¸æ˜¯ä»€ä¹ˆï¼š\n\n* ä¸æ˜¯åº”ç”¨æ¡†æ¶\n* ä¸æ˜¯ä¸­é—´ä»¶\n* ä¸æ˜¯ç›‘æ§ç³»ç»Ÿ\n\nå®ƒæ˜¯ï¼š\n\n> **åˆ†å¸ƒå¼åº”ç”¨çš„è¿è¡Œæ—¶å¹³å°**\n\n---\n\n## åäºŒã€æŠ€æœ¯æ¼”è¿›è¶‹åŠ¿\n\n* Ingress â†’ Gateway API\n* iptables â†’ eBPF\n* æ‰‹å·¥è¿ç»´ â†’ GitOps\n* å•é›†ç¾¤ â†’ å¤šé›†ç¾¤\n\n---\n\n## å…³è”å†…å®¹ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰\n\n- [/æ“ä½œç³»ç»Ÿ/å®¹å™¨åŒ–.md](/æ“ä½œç³»ç»Ÿ/å®¹å™¨åŒ–.md) å®¹å™¨åŒ–æŠ€æœ¯æ˜¯Kubernetesçš„åŸºç¡€ï¼Œæä¾›äº†è½»é‡çº§è™šæ‹ŸåŒ–å’Œåº”ç”¨æ‰“åŒ…çš„èƒ½åŠ›\n- [/è¿ç»´/Docker.md](/è¿ç»´/Docker.md) Dockeræ˜¯ä¸»æµçš„å®¹å™¨æŠ€æœ¯ï¼ŒKubernetesåŸºäºå®¹å™¨æŠ€æœ¯è¿›è¡Œåº”ç”¨ç¼–æ’å’Œç®¡ç†\n- [/è½¯ä»¶å·¥ç¨‹/å¾®æœåŠ¡/å¾®æœåŠ¡.md](/è½¯ä»¶å·¥ç¨‹/å¾®æœåŠ¡/å¾®æœåŠ¡.md) å¾®æœåŠ¡æ¶æ„æ˜¯Kubernetesçš„ä¸»è¦åº”ç”¨åœºæ™¯ä¹‹ä¸€ï¼ŒKubernetesä¸ºå¾®æœåŠ¡æä¾›äº†ç†æƒ³çš„è¿è¡Œç¯å¢ƒ\n- [/è½¯ä»¶å·¥ç¨‹/æ¶æ„/ç³»ç»Ÿè®¾è®¡/äº‘åŸç”Ÿ.md](/è½¯ä»¶å·¥ç¨‹/æ¶æ„/ç³»ç»Ÿè®¾è®¡/äº‘åŸç”Ÿ.md) äº‘åŸç”Ÿæ˜¯Kubernetesçš„æ ¸å¿ƒè®¾è®¡ç†å¿µï¼ŒKubernetesæ˜¯å®ç°äº‘åŸç”Ÿæ¶æ„çš„å…³é”®æŠ€æœ¯\n- [/è½¯ä»¶å·¥ç¨‹/å¾®æœåŠ¡/ServiceMesh/ServiceMesh.md](/è½¯ä»¶å·¥ç¨‹/å¾®æœåŠ¡/ServiceMesh/ServiceMesh.md) Service Meshæ˜¯å¾®æœåŠ¡é€šä¿¡çš„è§£å†³æ–¹æ¡ˆï¼Œä¸Kubernetesç»“åˆæä¾›æ›´å¼ºå¤§çš„æœåŠ¡æ²»ç†èƒ½åŠ›\n- [/ä¸­é—´ä»¶/webä¸­é—´ä»¶/Nginx.md](/ä¸­é—´ä»¶/webä¸­é—´ä»¶/Nginx.md) K8sä¸­çš„Ingress Controllerï¼ˆå¦‚nginx-ingressï¼‰å®ç°äº†ä¸Nginxç±»ä¼¼çš„è´Ÿè½½å‡è¡¡å’Œæµé‡ç®¡ç†åŠŸèƒ½\n- [/ä¸­é—´ä»¶/æ•°æ®åº“/redis/å“¨å…µ.md](/ä¸­é—´ä»¶/æ•°æ®åº“/redis/å“¨å…µ.md) Kubernetesçš„é«˜å¯ç”¨æ¶æ„è®¾è®¡ï¼Œæä¾›äº†å¦ä¸€ç§åˆ†å¸ƒå¼ç³»ç»Ÿé«˜å¯ç”¨çš„å®ç°æ€è·¯\n- [/æ•°æ®æŠ€æœ¯/ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿ.md](/æ•°æ®æŠ€æœ¯/ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿ.md) æ¶‰åŠCronJobå®šæ—¶ä»»åŠ¡æœºåˆ¶ã€Jobä¸CronJobåœ¨Kubernetesä¸­çš„è°ƒåº¦å®ç°\n- [/æ•°æ®æŠ€æœ¯/æ•°æ®è¿ç»´.md](/æ•°æ®æŠ€æœ¯/æ•°æ®è¿ç»´.md) K8sä½œä¸ºäº‘åŸç”Ÿåº”ç”¨çš„ç¼–æ’ç³»ç»Ÿï¼Œå…¶æä¾›çš„èµ„æºè°ƒåº¦ã€å¼¹æ€§ä¼¸ç¼©ã€å¥åº·æ£€æŸ¥ç­‰èƒ½åŠ›ä¸ºæ•°æ®åº”ç”¨çš„è¿ç»´æä¾›äº†æ–°çš„æ¨¡å¼ï¼Œæ˜¯äº‘åŸç”Ÿæ•°æ®è¿ç»´çš„é‡è¦åŸºç¡€è®¾æ–½\n- [/ç¼–ç¨‹è¯­è¨€/JAVA/é«˜çº§/æ³¨è§£.md](/ç¼–ç¨‹è¯­è¨€/JAVA/é«˜çº§/æ³¨è§£.md) Kubernetesèµ„æºå®šä¹‰ä¸­ä¹Ÿä½¿ç”¨æ³¨è§£æ¥å­˜å‚¨å…ƒæ•°æ®ï¼Œä¸Javaæ³¨è§£åœ¨æ¦‚å¿µä¸Šæœ‰ç›¸ä¼¼ä¹‹å¤„\n","metadata":"tags: ['åˆ†å¸ƒå¼ç³»ç»Ÿ', 'è¿ç»´', 'æ¶æ„è®¾è®¡']","hasMoreCommit":true,"totalCommits":28,"commitList":[{"date":"2026-02-12T15:12:41+08:00","author":"MY","message":"docs(SUMMARY): ç§»é™¤SpringBootæ–‡æ¡£å¹¶æ›´æ–°ç›®å½•ç»“æ„","hash":"cb0ebf64c788c03b810e8059b0f6253d1dff72bb"},{"date":"2026-02-12T14:07:03+08:00","author":"MY","message":"doc: æ•´ç†æ ‡ç­¾","hash":"290b3e8ad18f48832ac282290238d020fc030a88"},{"date":"2026-01-20T17:35:00+08:00","author":"MY","message":"doc(k8s): é‡æ„æ–‡æ¡£","hash":"befdfb1270bb67d369d28c700c326cf98e6a1f21"},{"date":"2025-11-16T21:30:56+08:00","author":"MY","message":"docs: ç»Ÿä¸€å¹¶ç²¾ç®€æ–‡æ¡£æ ‡ç­¾","hash":"21362e9d7aeb62e05364cd5e7f3a3c24d7e293c7"},{"date":"2025-07-12T15:49:09+08:00","author":"my","message":"ğŸ“¦K8S","hash":"433152c13bf25b0afb9f2da5a6d4cc3cb2124b36"},{"date":"2024-03-14T14:59:51+08:00","author":"MY","message":"âœk8s","hash":"ae3461309852c8bf76e2db070586ed92dfa72281"},{"date":"2024-03-13T21:31:48+08:00","author":"MY","message":"âœk8s","hash":"42232c8d5a5a7747fac2482872b948ba448ee2ea"},{"date":"2024-03-12T20:03:27+08:00","author":"MY","message":"âœk8s & å®¹å™¨ç½‘ç»œ","hash":"a4f9529e07f942f438aa6875d64a7bfc453afb84"},{"date":"2024-03-11T19:44:53+08:00","author":"MY","message":"âœk8s","hash":"1210ea8a06dc8a66c57206993d7763a5cfcc6984"},{"date":"2024-03-09T15:55:32+08:00","author":"MY","message":"âœk8s","hash":"1908b97a3d7d04ddb1c5d9499ec77b9fcc2e462d"}],"createTime":"2019-11-04T23:11:04+08:00"}