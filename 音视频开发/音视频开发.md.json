{"name":"音视频开发","id":"音视频开发-音视频开发","content":"# 音视频开发\n\n## 流媒体\n\n### 推流\n\n本地客户端产生流 -> rtmp服务器 -> 客户端\n\n## ffmpeg\n\n应用场景：\n\n- Remuxing：统一编解码\n- Transcoding：转码\n- 推流\n\n### 音视频分析\n\n```sh\n# 分析视频格式\n.\\ffprobe.exe D:\\转笔视频\\2017合片\\转笔探讨2017转笔合片.mp4 -show_format\n\n[FORMAT]\nnb_streams=2\nnb_programs=0\nformat_name=mov,mp4,m4a,3gp,3g2,mj2\nformat_long_name=QuickTime / MOV\nstart_time=0.000000\nduration=166.848000\nsize=211236984\nbit_rate=10128355\nprobe_score=100\nTAG:major_brand=mp42\nTAG:minor_version=0\nTAG:compatible_brands=mp42mp41\nTAG:creation_time=2017-01-26T12:13:08.000000Z\n[/FORMAT]\n```\n\n```sh\n# 分析音频内容\n.\\ffprobe.exe D:\\转笔视频\\2017合片\\转笔探讨2017转笔合片.mp4 -show_streams\n\n[STREAM]\nindex=0 //流的索引号\ncodec_name=h264 //流的编码名\ncodec_long_name=H.264 / AVC / MPEG-4 AVC / MPEG-4 part 10 //流的编码详细描述\nprofile=High //流的profile\ncodec_type=video //流的codec类型\ncodec_tag_string=avc1 // 流的codec tag 字符串\ncodec_tag=0x31637661 // 流的codec tag，也是字符串，只不过以16进制方式存储\nwidth=1920 //视频的宽，流内容部分\nheight=800 //视频的高，流内容部分\ncoded_width=1920 // 编码视频的宽，编解码时的部分，对齐的数据，显示时不用\ncoded_height=800 // 编码视频的高，编解码时的部分，对齐的数据，显示时不用\nhas_b_frames=2 // IPB 帧排列时两个P之间包含两个B\nsample_aspect_ratio=1:1 //像素点采样比例\ndisplay_aspect_ratio=12:5 // 显示图像比例\npix_fmt=yuv420p // 像素点格式\nlevel=40 // 与profile一起出现，对应的是参考标准中有对应的参数描述\ncolor_range=unknown //调色必备参数\ncolor_space=unknown //调色必备参数\ncolor_transfer=unknown  //调色必备参数\ncolor_primaries=unknown //调色必备参数\nfield_order=progressive // 隔行扫描逐行扫描标识\nr_frame_rate=24/1  // 实际帧率\navg_frame_rate=24/1 // 平均帧率\ntime_base=1/24 //时间基，通常和帧率有对应关系\nstart_pts=0 // 开始时间戳\nstart_time=0.000000 // 开始时间\nduration_ts=17620 //duration 时间戳\nduration=734.166667 // duration 时间\nbit_rate=7862427 // 码率\nmax_bit_rate=N/A // 最大码率\nbits_per_raw_sample=8 // 原始数据每个采样占位\nnb_frames=17620 // 总帧数\nextradata_size=42 // extradata 大小\nTAG:language=eng // 这个是TAG，主要是展示语种\nTAG:handler_name=VideoHandle // 句柄名\nTAG:vendor_id=FFMP // 生成MP4文件的工具\nTAG:encoder=libx264 // 视频编码器标识\n[/STREAM]\n```\n\n```sh\n# 可以将音视频的所有包都列出来\n.\\ffprobe.exe D:\\转笔视频\\2017合片\\转笔探讨2017转笔合片.mp4 -show_packets\n\n# 分析音视频帧\n.\\ffprobe.exe D:\\转笔视频\\2017合片\\转笔探讨2017转笔合片.mp4 -show_frames\n```\n\n### ffmpeg公共参数\n\n通用：\n\n- -codec、\n- -c\n- -f \n- -ss 定位文件的开始时间\n- -t 来规定输出文件时间长度\n\n视频操作：\n\n- -r:v 设置视频的帧率\n- -vb 设置视频码率\n- -vframes 设置视频输出的帧数\n- -aspect 设置视频的宽高比\n- -vn 关闭视频流处理操作，也就是屏蔽视频流\n- -vf 给视频做简单滤镜处理，简单滤镜处理一般不支持多图层、多输入、多输出的滤镜\n\n音频操作：\n\n- -ar 设置音频采样率\n- -ab 设置音频码率\n- -aframes 设置音频输出的帧数\n- -ac 设置音频的声道数量\n- -an 关闭音频流处理操作，也就是屏蔽音频流\n- -af 给音频做简单滤镜处理，简单滤镜处理一般不支持多图层、多输入、多输出的滤镜\n- -vol 设置音频的音量\n","metadata":"","hasMoreCommit":false,"totalCommits":7,"commitList":[{"date":"2023-11-23T17:12:20+08:00","author":"MY","message":"➕音频技术","hash":"9b239a09fe35f1f3822ab10bb5602abcc75994a2"},{"date":"2023-03-15T21:18:47+08:00","author":"MY","message":"更新 视频技术","hash":"271b6b0e97f47a10137a872868467eceea4cda4d"},{"date":"2023-03-12T15:40:30+08:00","author":"MY","message":"➕视频技术","hash":"b2ace3b7048d5432f592d9340c0c9f0f9ea3d50e"},{"date":"2022-11-06T21:28:55+08:00","author":"MY","message":"✏️音视频开发","hash":"eaf346bf835701c4af08cc940d7fd507d8350fd7"},{"date":"2022-11-04T17:36:55+08:00","author":"cjiping","message":"✏️音视频开发","hash":"6e45e5091722c735a845824c54bf79e4fa0f69b5"},{"date":"2022-11-02T21:48:03+08:00","author":"MY","message":"✏️音视频开发","hash":"144b396cd6e946d064012961de7344458267dad6"},{"date":"2022-11-01T20:34:22+08:00","author":"cjiping","message":"➕音视频开发","hash":"bd878e0fdc471ee7e245cf39bf34e830aa897ad1"}],"createTime":"2022-11-01T20:34:22+08:00"}